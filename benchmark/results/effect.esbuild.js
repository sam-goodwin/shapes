var Li=e=>typeof e=="function",l=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(a){return t(a,r,o,n)}};case 5:return function(r,o,n,s,a){return arguments.length>=5?t(r,o,n,s,a):function(i){return t(i,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var B=e=>e;var nn=e=>()=>e,_s=nn(!0),no=nn(!1);var Es=nn(void 0),qi=Es;function u(e,t,r,o,n,s,a,i,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return a(s(n(o(r(t(e))))));case 8:return i(a(s(n(o(r(t(e)))))));case 9:return c(i(a(s(n(o(r(t(e))))))));default:{let p=arguments[0];for(let f=1;f<arguments.length;f++)p=arguments[f](p);return p}}}var yr="2.0.0-next.58";var Di=Symbol.for(`effect/GlobalValue/globalStoreId/${yr}`);Di in globalThis||(globalThis[Di]=new Map);var Hi=globalThis[Di],P=(e,t)=>(Hi.has(e)||Hi.set(e,t()),Hi.get(e));var Sr=e=>typeof e=="string",Y=e=>typeof e=="number",Ts=e=>typeof e=="boolean",tt=e=>typeof e=="bigint",ao=e=>typeof e=="symbol",Tt=Li,Bi=e=>e===void 0;var Ju=e=>!1;var Yu=e=>typeof e=="object"&&e!==null,io=e=>Yu(e)||Tt(e),b=l(2,(e,t)=>io(e)&&t in e),Rs=l(2,(e,t)=>b(e,"_tag")&&e._tag===t),br=e=>e==null,Qu=e=>e!=null;var Zu=e=>e instanceof Uint8Array,As=e=>e instanceof Date,Xu=e=>b(e,Symbol.iterator),Ui=e=>Yu(e)&&!Array.isArray(e);var ef=e=>b(e,"then")&&"catch"in e&&Tt(e.then)&&Tt(e.catch);var tf=Symbol.for("effect/Gen/GenKind"),rf=class{value;constructor(t){this.value=t}get _F(){return B}get _R(){return t=>t}get _O(){return t=>t}get _E(){return t=>t}[tf]=tf;[Symbol.iterator](){return new Ki(this)}},Ki=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Zy=335903614,Xy=4150755663,eS=1481765933,tS=1284865837,rS=9007199254740992,oS=134217728,co=class{_state;constructor(t,r,o,n){return br(r)&&br(t)?(r=Math.random()*4294967295>>>0,t=0):br(r)&&(r=t,t=0),br(n)&&br(o)?(n=this._state?this._state[3]:Xy,o=this._state?this._state[2]:Zy):br(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),of(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*oS+r)/rS}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;nS(this._state,t,r,eS,tS),of(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,a=t>>>27,i=(-a>>>0&31)>>>0;return(s>>>a|s<<i)>>>0}};function nS(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,a=(r&65535)*(n>>>16)>>>0,i=(r&65535)*(n&65535)>>>0,c=(r>>>16)*(n>>>16)+((a>>>16)+(s>>>16))>>>0;a=a<<16>>>0,i=i+a>>>0,i>>>0<a>>>0&&(c=c+1>>>0),s=s<<16>>>0,i=i+s>>>0,i>>>0<s>>>0&&(c=c+1>>>0),c=c+Math.imul(r,o)>>>0,c=c+Math.imul(t,n)>>>0,e[0]=c,e[1]=i}function of(e,t,r,o,n){let s=t+o>>>0,a=r+n>>>0;a>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=a}var ji=P(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),aS=P(Symbol.for("effect/Hash/pcgr"),()=>new co),O=Symbol.for("effect/Hash"),d=e=>{switch(typeof e){case"number":return po(e);case"bigint":return Or(e.toString(10));case"boolean":return Or(String(e));case"symbol":return Or(String(e));case"string":return Or(e);case"undefined":return Or("undefined");case"function":case"object":return e===null?Or("null"):iS(e)?e[O]():jt(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},jt=e=>(ji.has(e)||ji.set(e,po(aS.integer(Number.MAX_SAFE_INTEGER))),ji.get(e)),_=e=>t=>t*53^e,Is=e=>e&3221225471|e>>>1&1073741824,iS=e=>b(e,O),po=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Is(e)},Or=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return Is(t)},cS=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=u(Or(t[o]),_(d(e[t[o]])));return Is(r)},ks=e=>cS(e,Object.keys(e)),_r=e=>{let t=6151;for(let r=0;r<e.length;r++)t=u(t,_(d(e[r])));return Is(t)};var E=Symbol.for("effect/Equal");function y(){return arguments.length===1?e=>nf(e,arguments[0]):nf(arguments[0],arguments[1])}function nf(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&sf(e)&&sf(t)?d(e)===d(t)&&e[E](t):!1}var sf=e=>b(e,E),Cs=()=>(e,t)=>y(e,t);var Rt=e=>(t,r)=>t===r||e(t,r),pS=(e,t)=>e===t,Wi=()=>pS;var lS=Wi();var zi=l(2,(e,t)=>Rt((r,o)=>e(t(r),t(o)))),af=zi(lS,e=>e.getTime());var cf=e=>Rt((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var M=Symbol.for("nodejs.util.inspect.custom"),F=e=>b(e,"toJSON")&&Tt(e.toJSON)&&e.toJSON.length===0?e.toJSON():Array.isArray(e)?e.map(F):e,q=e=>JSON.stringify(e,null,2);var x=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var uo="Async",vs="Commit",Me="Failure",an="OnFailure",fo="OnSuccess",mo="OnSuccessAndFailure",Fe="Success",ws="Sync",pf="Tag",Er="UpdateRuntimeFlags",ho="While",Ps="WithRuntime",go="Yield",cn="RevertFlags";var Gi=Symbol.for("effect/Effect"),lf=Symbol.for("effect/Stream"),uf=Symbol.for("effect/Sink"),ff=Symbol.for("effect/Channel"),Wt={_R:e=>e,_E:e=>e,_A:e=>e,_V:yr},fS={_R:e=>e,_E:e=>e,_In:e=>e,_L:e=>e,_Z:e=>e},mS={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},zt={[Gi]:Wt,[lf]:Wt,[uf]:fS,[ff]:mS,[E](e){return this===e},[O](){return jt(this)},pipe(){return x(this,arguments)}},pn={[O](){return ks(this)},[E](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let o of t)if(!(o in e&&y(this[o],e[o])))return!1;return!0}},mf={...zt,_op:vs},Vi={...mf,...pn};var hf=Symbol.for("effect/Option"),df={...zt,[hf]:{_A:e=>e},[M](){return this.toJSON()},toString(){return q(this.toJSON())}},dS=Object.assign(Object.create(df),{_tag:"Some",_op:"Some",[E](e){return Ns(e)&&Yi(e)&&y(e.value,this.value)},[O](){return _(d(this._tag))(d(this.value))},toJSON(){return{_id:"Option",_tag:this._tag,value:F(this.value)}}}),gS=Object.assign(Object.create(df),{_tag:"None",_op:"None",[E](e){return Ns(e)&&Ji(e)},[O](){return _(d(this._tag))},toJSON(){return{_id:"Option",_tag:this._tag}}}),Ns=e=>b(e,hf),Ji=e=>e._tag==="None",Yi=e=>e._tag==="Some",Ms=Object.create(gS),Fs=e=>{let t=Object.create(dS);return t.value=e,t};var Qi=Symbol.for("effect/Either"),xf={...zt,[Qi]:{_A:e=>e},[M](){return this.toJSON()},toString(){return q(this.toJSON())}},xS=Object.assign(Object.create(xf),{_tag:"Right",_op:"Right",[E](e){return Zi(e)&&ec(e)&&y(e.right,this.right)},[O](){return _(d(this._tag))(d(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:F(this.right)}}}),yS=Object.assign(Object.create(xf),{_tag:"Left",_op:"Left",[E](e){return Zi(e)&&Xi(e)&&y(e.left,this.left)},[O](){return _(d(this._tag))(d(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:F(this.left)}}}),Zi=e=>b(e,Qi),Xi=e=>e._tag==="Left",ec=e=>e._tag==="Right",yf=e=>{let t=Object.create(yS);return t.left=e,t},Sf=e=>{let t=Object.create(xS);return t.right=e,t};var Ls=e=>(t,r)=>t===r?0:e(t,r);var bf=Ls((e,t)=>e<t?-1:1);var Of=e=>Ls((t,r)=>e(r,t));var ln=l(2,(e,t)=>Ls((r,o)=>e(t(r),t(o))));var bS=e=>Ls((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let a=s(t[n],r[n]);if(a!==0)return a;n++}return 0});var _f=(...e)=>bS(e);var tc=e=>l(2,(t,r)=>e(t,r)===1);var rc=e=>l(2,(t,r)=>t===r||e(t,r)>-1?t:r);var R=()=>Ms,C=Fs,Ef=Ns,z=Ji,$=Yi,se=l(2,(e,{onNone:t,onSome:r})=>z(e)?t():r(e.value));var G=l(2,(e,t)=>z(e)?t():e.value),xo=l(2,(e,t)=>z(e)?t():e);var ft=e=>e==null?R():C(e);var At=G(Es);var ue=l(2,(e,t)=>z(e)?R():C(t(e.value)));var un=l(2,(e,t)=>z(e)?R():t(e.value));var Tf=un(B);var Rf=e=>Rt((t,r)=>t===r||(z(t)?z(r):z(r)?!1:e(t.value,r.value)));var _S=e=>l(2,(t,r)=>z(t)?!1:e(t.value,r)),ES=Cs(),Af=_S(ES);var nc=Symbol.for("effect/BigDecimal"),TS={[nc]:nc,[O](){let e=ic(this);return u(d(e.value),_(po(e.scale)))},[E](e){return sc(e)&&AS(this,e)},toString(){return pc(this)},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},sc=e=>b(e,nc),yo=(e,t)=>{let r=Object.create(TS);return r.value=e,r.scale=t,r},ac=BigInt(0);var If=BigInt(10),RS=yo(ac,0),ic=e=>{if(e.normalized===void 0)if(e.value===ac)e.normalized=RS;else{let t=`${e.value}`,r=0;for(let s=t.length-1;s>=0&&t[s]==="0";s--)r++;r===0&&(e.normalized=e);let o=BigInt(t.substring(0,t.length-r)),n=e.scale-r;e.normalized=yo(o,n)}return e.normalized},kf=(e,t)=>t>e.scale?yo(e.value*If**BigInt(t-e.scale),t):t<e.scale?yo(e.value/If**BigInt(e.scale-t),t):e;var cc=Rt((e,t)=>e.scale>t.scale?kf(t,e.scale).value===e.value:e.scale<t.scale?kf(e,t.scale).value===t.value:e.value===t.value),AS=l(2,(e,t)=>cc(e,t));var pc=e=>{let t=e.value<ac,r=t?`${e.value}`.substring(1):`${e.value}`,o,n;if(e.scale>=r.length)o="0",n="0".repeat(e.scale-r.length)+r;else{let a=r.length-e.scale;if(a>r.length){let i=a-r.length;o=`${r}${"0".repeat(i)}`,n=""}else n=r.slice(a),o=r.slice(0,a)}let s=n===""?o:`${o}.${n}`;return t?`-${s}`:s};var ie=Sf,pe=yf;var ae=Xi,Le=ec;var kS=l(2,(e,{onLeft:t,onRight:r})=>ae(e)?t(e.left):r(e.right));var Cf=kS({onLeft:B,onRight:B});var lc=e=>e.length>0;var vf=(...e)=>e;var uc=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var Te=e=>Array.isArray(e)?e:Array.from(e);var rt=l(2,(e,t)=>[t,...e]);var wf=l(2,(e,t)=>[...e,t]);var wS=e=>e.length===0,fc=wS,qs=lc,qe=lc;var Pf=(e,t)=>e<0||e>=t.length;var PS=l(2,(e,t)=>{let r=Math.floor(t);return Pf(r,e)?R():C(e[r])}),mc=l(2,(e,t)=>{let r=Math.floor(t);if(Pf(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Hs=PS(0),le=mc(0),Ds=e=>qe(e)?C(NS(e)):R(),NS=e=>e[e.length-1];var mt=e=>e.slice(1);var hc=e=>Array.from(e).reverse(),Tr=l(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var dc=l(2,(e,t)=>Nf(e,t,vf)),Nf=l(3,(e,t,r)=>{let o=Te(e),n=Te(t);if(qe(o)&&qe(n)){let s=[r(le(o),le(n))],a=Math.min(o.length,n.length);for(let i=1;i<a;i++)s[i]=r(o[i],n[i]);return s}return[]});var Rr=()=>[],He=e=>[e],Re=l(2,(e,t)=>e.map(t)),fn=l(2,(e,t)=>{if(fc(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r}),gc=fn(B);var It=l(3,(e,t,r)=>Te(e).reduce((o,n,s)=>r(o,n,s),t));var xc=(e,t)=>{let r=[],o=e,n;for(;$(n=t(o));){let[s,a]=n.value;r.push(s),o=a}return r};var Bs=cf;var MS=l(2,(e,t)=>{let r=Te(e);if(qe(r)){let o=[le(r)],n=mt(r);for(let s of n)o.every(a=>!t(s,a))&&o.push(s);return o}return[]}),Mf=MS(Cs());var ht=l(2,(e,t)=>Te(e).join(t));var Lf=Symbol.for("effect/Chunk");function LS(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var qf=[],qS=e=>Rt((t,r)=>t.length===r.length&&kt(t).every((o,n)=>e(o,Gt(r,n)))),HS=qS(y),DS={[Lf]:{_A:e=>e},toString(){return q(this.toJSON())},toJSON(){return{_id:"Chunk",values:kt(this).map(F)}},[M](){return this.toJSON()},[E](e){return Hf(e)&&HS(this,e)},[O](){return _r(kt(this))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return qf[Symbol.iterator]();default:return kt(this)[Symbol.iterator]()}},pipe(){return x(this,arguments)}},ee=e=>{let t=Object.create(DS);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=ot,t.right=ot;break}case"ISingleton":{t.length=1,t.depth=0,t.left=ot,t.right=ot;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=ot,t.right=ot;break}}return t},Hf=e=>b(e,Lf),ot=ee({_tag:"IEmpty"}),De=()=>ot;var ce=e=>ee({_tag:"ISingleton",a:e}),mn=e=>Hf(e)?e:ee({_tag:"IArray",array:Te(e)}),yc=(e,t,r)=>{switch(e.backing._tag){case"IArray":{LS(e.backing.array,0,t,r,e.length);break}case"IConcat":{yc(e.left,t,r),yc(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=Gt(e,o),o+=1,n+=1;break}}};var kt=e=>{switch(e.backing._tag){case"IEmpty":return qf;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return yc(e,t,0),e.backing={_tag:"IArray",array:t},e.left=ot,e.right=ot,e.depth=0,t}}},Vt=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return ee({_tag:"IArray",array:hc(e.backing.array)});case"IConcat":return ee({_tag:"IConcat",left:Vt(e.backing.right),right:Vt(e.backing.left)});case"ISlice":return Ct(hc(kt(e)))}},BS=l(2,(e,t)=>t<0||t>=e.length?R():C(Gt(e,t))),Ct=e=>ee({_tag:"IArray",array:e});var Gt=l(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Gt(e.left,t):Gt(e.right,t-e.left.length);case"ISlice":return Gt(e.backing.chunk,t+e.backing.offset)}}),Df=l(2,(e,t)=>Ve(e,ce(t))),xe=l(2,(e,t)=>Ve(ce(t),e)),Sc=l(2,(e,t)=>{if(t<=0)return ot;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return ee({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?ee({_tag:"IConcat",left:e.left,right:Sc(e.right,t-e.left.length)}):Sc(e.left,t);default:return ee({_tag:"ISlice",chunk:e,offset:0,length:t})}}),So=l(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return ot;switch(e.backing._tag){case"ISlice":return ee({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?So(e.right,t-e.left.length):ee({_tag:"IConcat",left:So(e.left,t),right:e.right});default:return ee({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var Ve=l(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return ee({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=Ve(e.right,t);return ee({_tag:"IConcat",left:e.left,right:o})}else{let o=Ve(e.right.right,t);if(o.depth===e.depth-3){let n=ee({_tag:"IConcat",left:e.right.left,right:o});return ee({_tag:"IConcat",left:e.left,right:n})}else{let n=ee({_tag:"IConcat",left:e.left,right:e.right.left});return ee({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=Ve(e,t.left);return ee({_tag:"IConcat",left:o,right:t.right})}else{let o=Ve(e,t.left.left);if(o.depth===t.depth-3){let n=ee({_tag:"IConcat",left:o,right:t.left.right});return ee({_tag:"IConcat",left:n,right:t.right})}else{let n=ee({_tag:"IConcat",left:t.left.right,right:t.right});return ee({_tag:"IConcat",left:o,right:n})}}});var hn=e=>e.length===0,nt=e=>e.length>0,dn=BS(0),Ar=e=>Gt(e,0),st=Ar;var Bf=e=>Gt(e,e.length-1),bc=l(2,(e,t)=>e.backing._tag==="ISingleton"?ce(t(e.backing.a,0)):Ct(u(kt(e),Re((r,o)=>t(r,o)))));var Us=l(2,(e,t)=>Ct(Tr(kt(e),t)));var US=l(2,(e,t)=>[Sc(e,t),So(e,t)]);var Uf=l(2,(e,t)=>{let r=0;for(let o of kt(e)){if(t(o))break;r++}return US(e,r)});var at=e=>So(e,1);var Kf=e=>Ct(Mf(kt(e)));var jf=Symbol.for("effect/Context/Tag"),KS="effect/STM",jS=Symbol.for(KS),WS={...zt,_tag:"Tag",_op:"Tag",[jS]:Wt,[jf]:{_Service:e=>e,_Identifier:e=>e},toString(){return q(this.toJSON())},toJSON(){return{_id:"Tag",identifier:this.identifier,stack:this.stack}},[M](){return this.toJSON()},of(e){return e},context(e){return Ec(this,e)}},Oc=P("effect/Context/Tag/tagRegistry",()=>new Map),Wf=e=>{if(e&&Oc.has(e))return Oc.get(e);let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;let o=Object.create(WS);return Object.defineProperty(o,"stack",{get(){return r.stack}}),e&&(o.identifier=e,Oc.set(e,o)),o},_c=Symbol.for("effect/Context"),zS={[_c]:{_Services:e=>e},[E](e){if(zf(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!y(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[O](){return po(this.unsafeMap.size)},pipe(){return x(this,arguments)},toString(){return q(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(F)}},[M](){return this.toJSON()}},Yt=e=>{let t=Object.create(zS);return t.unsafeMap=e,t},$S=e=>{let t=new Error(`Service not found${e.identifier?`: ${String(e.identifier)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[2].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},zf=e=>b(e,_c);var GS=Yt(new Map),$f=()=>GS,Ec=(e,t)=>Yt(new Map([[e,t]])),Gf=l(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),Yt(o)}),Tc=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw $S(t);return e.unsafeMap.get(t)}),Vf=Tc,Jf=l(2,(e,t)=>e.unsafeMap.has(t)?Fs(e.unsafeMap.get(t)):Ms),Yf=l(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return Yt(r)});var Be=Wf;var gn=$f,Qf=Ec,Ir=Gf,kr=Vf,Zf=Tc,bo=Jf,Rc=Yf;var Ac=Math.pow(2,5),Xf=Ac-1,em=Ac/2,tm=Ac/4;function JS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Zt(e,t){return t>>>e&Xf}function Xt(e){return 1<<e}function Ks(e,t){return JS(e&t-1)}var js=class{value;previous;constructor(t,r){this.value=t,this.previous=r}};function Cr(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let a=0;a<s;++a)n[a]=o[a]}return n[t]=r,n}function Ic(e,t,r){let o=r.length-1,n=0,s=0,a=r;if(e)n=s=t;else for(a=new Array(o);n<t;)a[s++]=r[n++];for(++n;n<=o;)a[s++]=r[n++];return e&&(a.length=o),a}function rm(e,t,r,o){let n=o.length;if(e){let c=n;for(;c>=t;)o[c--]=o[c];return o[t]=r,o}let s=0,a=0,i=new Array(n+1);for(;s<t;)i[a++]=o[s++];for(i[t]=r;s<n;)i[++a]=o[s++];return i}var vt=class e{_tag="EmptyNode";modify(t,r,o,n,s,a){let i=o(R());return z(i)?new e:(++a.value,new Oo(t,n,s,i))}};function Je(e){return Rs(e,"EmptyNode")}function YS(e){return Je(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function Ws(e,t){return Je(e)?!1:t===e.edit}var Oo=class e{edit;hash;key;value;_tag="LeafNode";constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n}modify(t,r,o,n,s,a){if(y(s,this.key)){let c=o(this.value);return c===this.value?this:z(c)?(--a.value,new vt):Ws(this,t)?(this.value=c,this):new e(t,n,s,c)}let i=o(R());return z(i)?this:(++a.value,om(t,r,this.hash,this,n,new e(t,n,s,i)))}},kc=class e{edit;hash;children;_tag="CollisionNode";constructor(t,r,o){this.edit=t,this.hash=r,this.children=o}modify(t,r,o,n,s,a){if(n===this.hash){let c=Ws(this,t),p=this.updateCollisionList(c,t,this.hash,this.children,o,s,a);return p===this.children?this:p.length>1?new e(t,this.hash,p):p[0]}let i=o(R());return z(i)?this:(++a.value,om(t,r,this.hash,this,n,new Oo(t,n,s,i)))}updateCollisionList(t,r,o,n,s,a,i){let c=n.length;for(let f=0;f<c;++f){let m=n[f];if("key"in m&&y(a,m.key)){let h=m.value,g=s(h);return g===h?n:z(g)?(--i.value,Ic(t,f,n)):Cr(t,f,new Oo(r,o,a,g),n)}}let p=s(R());return z(p)?n:(++i.value,Cr(t,c,new Oo(r,o,a,p),n))}},xn=class e{edit;mask;children;_tag="IndexedNode";constructor(t,r,o){this.edit=t,this.mask=r,this.children=o}modify(t,r,o,n,s,a){let i=this.mask,c=this.children,p=Zt(r,n),f=Xt(p),m=Ks(i,f),h=i&f,g=Ws(this,t);if(!h){let N=new vt().modify(t,r+5,o,n,s,a);return N?c.length>=em?ZS(t,p,N,i,c):new e(t,i|f,rm(g,m,N,c)):this}let S=c[m],I=S.modify(t,r+5,o,n,s,a);if(S===I)return this;let T=i,v;if(Je(I)){if(T&=~f,!T)return new vt;if(c.length<=2&&YS(c[m^1]))return c[m^1];v=Ic(g,m,c)}else v=Cr(g,m,I,c);return g?(this.mask=T,this.children=v,this):new e(t,T,v)}},Cc=class e{edit;size;children;_tag="ArrayNode";constructor(t,r,o){this.edit=t,this.size=r,this.children=o}modify(t,r,o,n,s,a){let i=this.size,c=this.children,p=Zt(r,n),f=c[p],m=(f||new vt).modify(t,r+5,o,n,s,a);if(f===m)return this;let h=Ws(this,t),g;if(Je(f)&&!Je(m))++i,g=Cr(h,p,m,c);else if(!Je(f)&&Je(m)){if(--i,i<=tm)return QS(t,i,p,c);g=Cr(h,p,new vt,c)}else g=Cr(h,p,m,c);return h?(this.size=i,this.children=g,this):new e(t,i,g)}};function QS(e,t,r,o){let n=new Array(t-1),s=0,a=0;for(let i=0,c=o.length;i<c;++i)if(i!==r){let p=o[i];p&&!Je(p)&&(n[s++]=p,a|=1<<i)}return new xn(e,a,n)}function ZS(e,t,r,o,n){let s=[],a=o,i=0;for(let c=0;a;++c)a&1&&(s[c]=n[i++]),a>>>=1;return s[t]=r,new Cc(e,i+1,s)}function XS(e,t,r,o,n,s){if(r===n)return new kc(e,r,[s,o]);let a=Zt(t,r),i=Zt(t,n);if(a===i)return c=>new xn(e,Xt(a)|Xt(i),[c]);{let c=a<i?[o,s]:[s,o];return new xn(e,Xt(a)|Xt(i),c)}}function om(e,t,r,o,n,s){let a,i=t;for(;;){let c=XS(e,i,r,o,n,s);if(typeof c=="function")a=new js(c,a),i=i+5;else{let p=c;for(;a!=null;)p=a.value(p),a=a.previous;return p}}}var nm="effect/HashMap",zs=Symbol.for(nm),tb={[zs]:zs,[Symbol.iterator](){return new $s(this,(e,t)=>[e,t])},[O](){let e=d(nm);for(let t of this)e^=u(d(t[0]),_(d(t[1])));return e},[E](e){if(cm(e)){if(e._size!==this._size)return!1;for(let t of this){let r=u(e,Vs(t[0],d(t[0])));if(z(r))return!1;if(!y(t[1],r.value))return!1}return!0}return!1},toString(){return q(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},vc=(e,t,r,o)=>{let n=Object.create(tb);return n._editable=e,n._edit=t,n._root=r,n._size=o,n},$s=class e{map;f;v;constructor(t,r){this.map=t,this.f=r,this.v=sm(this.map._root,this.f,void 0)}next(){if(z(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Gs(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Gs=e=>e?am(e[0],e[1],e[2],e[3],e[4]):R(),sm=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return $(e.value)?C({value:t(e.key,e.value.value),cont:r}):Gs(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return am(o.length,o,0,t,r)}default:return Gs(r)}},am=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!Je(s))return sm(s,o,[e,t,r,o,n])}return Gs(n)},rb=vc(!1,0,new vt,0),Eo=()=>rb,im=(...e)=>wc(e),wc=e=>{let t=Ys(Eo());for(let r of e)vr(t,r[0],r[1]);return um(t)},cm=e=>b(e,zs),pm=e=>e&&Je(e._root),lm=l(2,(e,t)=>Vs(e,t,d(t))),Vs=l(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return y(t,o.key)?o.value:R();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let a=0,i=s.length;a<i;++a){let c=s[a];if("key"in c&&y(t,c.key))return c.value}}return R()}case"IndexedNode":{let s=Zt(n,r),a=Xt(s);if(o.mask&a){o=o.children[Ks(o.mask,a)],n+=5;break}return R()}case"ArrayNode":{if(o=o.children[Zt(n,r)],o){n+=5;break}return R()}default:return R()}});var Pc=l(2,(e,t)=>$(Vs(e,t,d(t))));var vr=l(3,(e,t,r)=>Nc(e,t,()=>C(r))),ob=l(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:vc(e._editable,e._edit,t,r)),Js=e=>new $s(e,t=>t);var To=e=>e._size,Ys=e=>vc(!0,e._edit+1,e._root,e._size),um=e=>(e._editable=!1,e);var Nc=l(3,(e,t,r)=>fm(e,t,d(t),r)),fm=l(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return u(e,ob(s,n.value))});var Qs=l(2,(e,t)=>Nc(e,t,R));var mm=l(2,(e,t)=>Ro(e,Eo(),(r,o,n)=>vr(r,n,t(o,n))));var Mc=l(2,(e,t)=>Ro(e,void 0,(r,o,n)=>t(o,n))),Ro=l(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return $(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let a=0,i=s.length;a<i;){let c=s[a++];c&&!Je(c)&&(c._tag==="LeafNode"?$(c.value)&&(t=r(t,c.value.value,c.key)):n.push(c.children))}return t});var dm="effect/HashSet",Zs=Symbol.for(dm),nb={[Zs]:Zs,[Symbol.iterator](){return Js(this._keyMap)},[O](){return _(d(this._keyMap))(d(dm))},[E](e){return Fc(e)?To(this._keyMap)===To(e._keyMap)&&y(this._keyMap,e._keyMap):!1},toString(){return q(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},Xs=e=>{let t=Object.create(nb);return t._keyMap=e,t},Fc=e=>b(e,Zs),sb=Xs(Eo()),yn=()=>sb,gm=e=>{let t=ea(yn());for(let r of e)Ao(t,r);return ta(t)},xm=(...e)=>{let t=ea(yn());for(let r of e)Ao(t,r);return ta(t)},ym=l(2,(e,t)=>Pc(e._keyMap,t));var Sm=e=>To(e._keyMap),ea=e=>Xs(Ys(e._keyMap)),ta=e=>(e._keyMap._editable=!1,e),Lc=l(2,(e,t)=>{let r=ea(e);return t(r),ta(r)}),Ao=l(2,(e,t)=>e._keyMap._editable?(vr(t,!0)(e._keyMap),e):Xs(vr(t,!0)(e._keyMap))),qc=l(2,(e,t)=>e._keyMap._editable?(Qs(t)(e._keyMap),e):Xs(Qs(t)(e._keyMap))),bm=l(2,(e,t)=>Lc(e,r=>{for(let o of t)qc(r,o)}));var Om=l(2,(e,t)=>Lc(yn(),r=>{_m(e,o=>Ao(r,o));for(let o of t)Ao(r,o)}));var _m=l(2,(e,t)=>Mc(e._keyMap,(r,o)=>t(o))),Em=l(3,(e,t,r)=>Ro(e._keyMap,t,(o,n,s)=>r(o,s)));var Tm=Fc,me=yn,er=gm,dt=xm,Rm=ym;var wr=Sm;var Pr=Ao,Hc=qc,Dc=bm;var Ae=Om;var Nr=Em;var Am=Symbol.for("effect/MutableRef"),ib={[Am]:Am,toString(){return q(this.toJSON())},toJSON(){return{_id:"MutableRef",current:F(this.current)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},tr=e=>{let t=Object.create(ib);return t.current=e,t};var Ue=e=>e.current;var Im=e=>pb(e,t=>t+1),xt=l(2,(e,t)=>(e.current=t,e)),cb=l(2,(e,t)=>(e.current=t,e.current)),km=l(2,(e,t)=>xt(e,t(Ue(e)))),pb=l(2,(e,t)=>cb(e,t(Ue(e))));var oa="effect/FiberId",rr=Symbol.for(oa),Bc="None",Uc="Runtime",Kc="Composite",jc=class{[rr]=rr;_tag=Bc;[O](){return u(d(oa),_(d(this._tag)))}[E](t){return na(t)&&t._tag===Bc}toString(){return q(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[M](){return this.toJSON()}},Wc=class{id;startTimeMillis;[rr]=rr;_tag=Uc;constructor(t,r){this.id=t,this.startTimeMillis=r}[O](){return u(d(oa),_(d(this._tag)),_(d(this.id)),_(d(this.startTimeMillis)))}[E](t){return na(t)&&t._tag===Uc&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return q(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[M](){return this.toJSON()}},Cm=class{left;right;[rr]=rr;_tag=Kc;constructor(t,r){this.left=t,this.right=r}[O](){return u(d(oa),_(d(this._tag)),_(d(this.left)),_(d(this.right)))}[E](t){return na(t)&&t._tag===Kc&&y(this.left,t.left)&&y(this.right,t.right)}toString(){return q(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:F(this.left),right:F(this.right)}}[M](){return this.toJSON()}},wm=new jc;var na=e=>b(e,rr);var ra=e=>{switch(e._tag){case Bc:return me();case Uc:return dt(e.id);case Kc:return u(ra(e.left),Ae(ra(e.right)))}},vm=P(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>tr(0));var sa=e=>Array.from(ra(e)).map(r=>`#${r}`).join(",");var Pm=()=>{let e=Ue(vm);return u(vm,xt(e+1)),new Wc(e,new Date().getTime())};var wt=wm;var Mm=sa;var Fm=Pm;var or=Eo,Lm=im,bn=wc,qm=pm,On=lm;var Io=vr,zc=Js;var $c=To;var ia=mm;var Gc=Ro;var _n=Symbol.for("effect/List"),ca=e=>Array.from(e),lb=e=>zi(Bs(e),ca),ub=lb(y),fb={[_n]:_n,_tag:"Cons",toString(){return q(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:ca(this).map(F)}},[M](){return this.toJSON()},[E](e){return Dm(e)&&this._tag===e._tag&&ub(this,e)},[O](){return _r(ca(this))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},pipe(){return x(this,arguments)}},pa=(e,t)=>{let r=Object.create(fb);return r.head=e,r.tail=t,r},mb={[_n]:_n,_tag:"Nil",toString(){return q(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[M](){return this.toJSON()},[O](){return _r(ca(this))},[E](e){return Dm(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return x(this,arguments)}},Hm=Object.create(mb),Dm=e=>b(e,_n),yt=e=>e._tag==="Nil",En=e=>e._tag==="Cons";var hb=()=>Hm,Pt=(e,t)=>pa(e,t),nr=hb,Tn=e=>pa(e,Hm);var Bm=l(2,(e,t)=>gb(t,e)),db=l(2,(e,t)=>Pt(t,e)),gb=l(2,(e,t)=>{if(yt(e))return t;if(yt(t))return e;{let r=pa(t.head,e),o=r,n=t.tail;for(;!yt(n);){let s=pa(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var Um=l(3,(e,t,r)=>{let o=t,n=e;for(;!yt(n);)o=r(o,n.head),n=n.tail;return o});var Km=e=>{let t=nr(),r=e;for(;!yt(r);)t=db(t,r.head),r=r.tail;return t};var xk=Object.assign(Object.create(Array.prototype),{[O](){return _r(this)},[E](e){return Array.isArray(e)&&this.length===e.length?this.every((t,r)=>y(t,e[r])):!1}}),ua=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=pn,e}();var xb=Symbol.for("effect/DifferContextPatch");function jm(e){return e}var An={...ua.prototype,[xb]:{_Value:jm,_Patch:jm}},yb=Object.assign(Object.create(An),{_tag:"Empty"}),Sb=Object.create(yb),Vc=()=>Sb,bb=Object.assign(Object.create(An),{_tag:"AndThen"}),Ob=(e,t)=>{let r=Object.create(bb);return r.first=e,r.second=t,r},_b=Object.assign(Object.create(An),{_tag:"AddService"}),Eb=(e,t)=>{let r=Object.create(_b);return r.tag=e,r.service=t,r},Tb=Object.assign(Object.create(An),{_tag:"RemoveService"}),Rb=e=>{let t=Object.create(Tb);return t.tag=e,t},Ab=Object.assign(Object.create(An),{_tag:"UpdateService"}),Ib=(e,t)=>{let r=Object.create(Ab);return r.tag=e,r.update=t,r},Wm=(e,t)=>{let r=new Map(e.unsafeMap),o=Vc();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let a=r.get(n);r.delete(n),y(a,s)||(o=Rn(Ib(n,()=>s))(o))}else r.delete(n),o=Rn(Eb(n,s))(o);for(let[n]of r.entries())o=Rn(Rb(n))(o);return o},Rn=l(2,(e,t)=>Ob(e,t)),zm=l(2,(e,t)=>{let r=!1,o=ce(e),n=new Map(t.unsafeMap);for(;nt(o);){let a=st(o),i=at(o);switch(a._tag){case"Empty":{o=i;break}case"AddService":{n.set(a.tag,a.service),o=i;break}case"AndThen":{o=xe(xe(i,a.second),a.first);break}case"RemoveService":{n.delete(a.tag),o=i;break}case"UpdateService":{n.set(a.tag,a.update(n.get(a.tag))),r=!0,o=i;break}}}if(!r)return Yt(n);let s=new Map;for(let[a]of t.unsafeMap)n.has(a)&&(s.set(a,n.get(a)),n.delete(a));for(let[a,i]of n)s.set(a,i);return Yt(s)});var Cb=Symbol.for("effect/DifferHashSetPatch");function Jc(e){return e}var ma={...ua.prototype,[Cb]:{_Value:Jc,_Key:Jc,_Patch:Jc}},vb=Object.assign(Object.create(ma),{_tag:"Empty"}),wb=Object.create(vb),Yc=()=>wb,Pb=Object.assign(Object.create(ma),{_tag:"AndThen"}),Nb=(e,t)=>{let r=Object.create(Pb);return r.first=e,r.second=t,r},Mb=Object.assign(Object.create(ma),{_tag:"Add"}),Fb=e=>{let t=Object.create(Mb);return t.value=e,t},Lb=Object.assign(Object.create(ma),{_tag:"Remove"}),qb=e=>{let t=Object.create(Lb);return t.value=e,t},$m=(e,t)=>{let[r,o]=Nr([e,Yc()],([n,s],a)=>Rm(a)(n)?[Hc(a)(n),s]:[n,fa(Fb(a))(s)])(t);return Nr(o,(n,s)=>fa(qb(s))(n))(r)},fa=l(2,(e,t)=>Nb(e,t)),Gm=l(2,(e,t)=>{let r=t,o=ce(e);for(;nt(o);){let n=st(o),s=at(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=xe(n.first)(xe(n.second)(s));break}case"Add":{r=Pr(n.value)(r),o=s;break}case"Remove":r=Hc(n.value)(r),o=s}}return r});var Vm=Symbol.for("effect/Differ"),Db={[Vm]:{_P:B,_V:B}},Fr=e=>{let t=Object.create(Db);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},Qc=()=>Fr({empty:Vc(),combine:(e,t)=>Rn(t)(e),diff:(e,t)=>Wm(e,t),patch:(e,t)=>zm(t)(e)});var Zc=()=>Fr({empty:Yc(),combine:(e,t)=>fa(t)(e),diff:(e,t)=>$m(e,t),patch:(e,t)=>Gm(t)(e)});var Xc=()=>Jm((e,t)=>t),Jm=e=>Fr({empty:B,combine:(t,r)=>t===B?r:r===B?t:o=>r(t(o)),diff:(t,r)=>y(t,r)?B:nn(r),patch:(t,r)=>e(r,t(r))});var In=255,Ym=8,ha=e=>e&In,da=e=>e>>Ym&In,Lr=(e,t)=>(e&In)+((t&e&In)<<Ym),tp=Lr(0,0),Qm=e=>Lr(e,e),Zm=e=>Lr(e,0);var Xm=l(2,(e,t)=>Lr(ha(e)&~t,da(e)));var rp=l(2,(e,t)=>e|t);var eh=e=>~e>>>0&In;var Bb=0,qr=1,rh=2,Ub=4,ga=16,Kb=32;var oh=e=>xa(e,Kb);var nh=l(2,(e,t)=>e|t);var Nt=e=>op(e)&&!Wb(e),op=e=>xa(e,qr);var xa=l(2,(e,t)=>(e&t)!==0),jb=(...e)=>e.reduce((t,r)=>t|r,0),sh=jb(Bb);var ya=e=>xa(e,Ub);var Wb=e=>xa(e,ga);var kn=l(2,(e,t)=>Lr(e^t,t)),Cn=l(2,(e,t)=>e&(eh(ha(t))|da(t))|ha(t)&da(t));var np=Fr({empty:tp,diff:(e,t)=>kn(e,t),combine:(e,t)=>rp(t)(e),patch:(e,t)=>Cn(t,e)});var ih=Qm,sp=Zm;var ap=Xm;var cp=(e,t)=>({_tag:"Par",left:e,right:t}),Sa=(e,t)=>({_tag:"Seq",left:e,right:t});var lh=e=>{let t=Tn(e),r=nr();for(;;){let[o,n]=Um(t,[uh(),nr()],([s,a],i)=>{let[c,p]=zb(i);return[fh(s,c),Bm(a,p)]});if(r=$b(r,o),yt(n))return Km(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},zb=e=>{let t=e,r=uh(),o=nr(),n=nr();for(;;)switch(t._tag){case"Empty":{if(yt(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=Pt(t.right,o),t=t.left;break}case"Seq":{let s=t.left,a=t.right;switch(s._tag){case"Empty":{t=a;break}case"Par":{let i=s.left,c=s.right;t=cp(Sa(i,a),Sa(c,a));break}case"Seq":{let i=s.left,c=s.right;t=Sa(i,Sa(c,a));break}case"Single":{t=s,n=Pt(a,n);break}}break}case"Single":{if(r=fh(r,Qb(t.dataSource,t.blockedRequest)),yt(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},$b=(e,t)=>{if(yt(e))return Tn(ip(t));if(Zb(t))return e;let r=nO(e.head),o=Xb(t);return r.length===1&&o.length===1&&y(r[0],o[0])?Pt(oO(e.head,ip(t)),e.tail):Pt(ip(t),e)},Gb=Symbol.for("effect/RequestBlock/Entry"),ph=class{request;result;listeners;ownerId;state;[Gb]=Vb;constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s}},Vb={_R:e=>e};var Jb=Symbol.for("effect/RequestBlock/RequestBlockParallel"),Yb={_R:e=>e},vn=class{map;[Jb]=Yb;constructor(t){this.map=t}},uh=()=>new vn(or()),Qb=(e,t)=>new vn(Lm([e,Array.of(t)])),fh=(e,t)=>new vn(Gc(e.map,t.map,(r,o,n)=>Io(r,n,se(On(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),Zb=e=>qm(e.map),Xb=e=>Array.from(zc(e.map)),ip=e=>rO(ia(e.map,t=>Array.of(t))),eO=Symbol.for("effect/RequestBlock/RequestBlockSequential"),tO={_R:e=>e},ba=class{map;[eO]=tO;constructor(t){this.map=t}},rO=e=>new ba(e),oO=(e,t)=>new ba(Gc(t.map,e.map,(r,o,n)=>Io(r,n,se(On(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var nO=e=>Array.from(zc(e.map)),mh=e=>Array.from(e.map);var ko="Die",Hr="Empty",Dr="Fail",Co="Interrupt",Br="Parallel",Ur="Sequential";var Sh="effect/Cause",bh=Symbol.for(Sh),iO={_E:e=>e},Po={[bh]:iO,[O](){return u(d(Sh),_(d(lO(this))))},[E](e){return cO(e)&&pO(this,e)},pipe(){return x(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:F(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:F(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:F(this.left),right:F(this.right)}}},toString(){return Pn(this)},[M](){return this.toJSON()}},vo=(()=>{let e=Object.create(Po);return e._tag=Hr,e})(),lp=e=>{let t=Object.create(Po);return t._tag=Dr,t.error=e,t},St=e=>{let t=Object.create(Po);return t._tag=ko,t.defect=e,t},Mt=e=>{let t=Object.create(Po);return t._tag=Co,t.fiberId=e,t},Kr=(e,t)=>{let r=Object.create(Po);return r._tag=Br,r.left=e,r.right=t,r},Ke=(e,t)=>{let r=Object.create(Po);return r._tag=Ur,r.left=e,r.right=t,r},cO=e=>b(e,bh);var Oh=e=>e._tag===Hr?!0:wo(e,!0,(t,r)=>{switch(r._tag){case Hr:return C(t);case ko:case Dr:case Co:return C(!1);default:return R()}});var wn=e=>mp(void 0,mO)(e),_h=e=>Vt(wo(e,De(),(t,r)=>r._tag===Dr?C(u(t,xe(r.error))):R())),Eh=e=>Vt(wo(e,De(),(t,r)=>r._tag===ko?C(u(t,xe(r.defect))):R())),Th=e=>wo(e,me(),(t,r)=>r._tag===Co?C(u(t,Pr(r.fiberId))):R()),Rh=e=>fO(e,t=>t._tag===Dr?C(t.error):R()),up=e=>{let t=Rh(e);switch(t._tag){case"None":return ie(e);case"Some":return pe(t.value)}};var fp=e=>Ih(e,{onEmpty:vo,onFail:()=>vo,onDie:t=>St(t),onInterrupt:t=>Mt(t),onSequential:Ke,onParallel:Kr}),Ah=e=>Ih(e,{onEmpty:vo,onFail:t=>St(t),onDie:t=>St(t),onInterrupt:t=>Mt(t),onSequential:(t,r)=>Ke(t,r),onParallel:(t,r)=>Kr(t,r)});var pO=(e,t)=>{let r=ce(e),o=ce(t);for(;nt(r)&&nt(o);){let[n,s]=u(st(r),wo([me(),De()],([c,p],f)=>{let[m,h]=pp(f);return C([u(c,Ae(m)),u(p,Ve(h))])})),[a,i]=u(st(o),wo([me(),De()],([c,p],f)=>{let[m,h]=pp(f);return C([u(c,Ae(m)),u(p,Ve(h))])}));if(!y(n,a))return!1;r=s,o=i}return!0},lO=e=>uO(ce(e),De()),uO=(e,t)=>{for(;;){let[r,o]=u(e,It([me(),De()],([s,a],i)=>{let[c,p]=pp(i);return[u(s,Ae(c)),u(a,Ve(p))]})),n=wr(r)>0?u(t,xe(r)):t;if(hn(o))return Vt(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/effect/issues")},fO=l(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case Ur:case Br:{r.push(o.right),r.push(o.left);break}}break}case"Some":return n}}return R()});var pp=e=>{let t=e,r=[],o=me(),n=De();for(;t!==void 0;)switch(t._tag){case Hr:{if(r.length===0)return[o,n];t=r.pop();break}case Dr:{if(o=Pr(o,t.error),r.length===0)return[o,n];t=r.pop();break}case ko:{if(o=Pr(o,t.defect),r.length===0)return[o,n];t=r.pop();break}case Co:{if(o=Pr(o,t.fiberId),r.length===0)return[o,n];t=r.pop();break}case Ur:{switch(t.left._tag){case Hr:{t=t.right;break}case Ur:{t=Ke(t.left.left,Ke(t.left.right,t.right));break}case Br:{t=Kr(Ke(t.left.left,t.right),Ke(t.left.right,t.right));break}default:{n=xe(n,t.right),t=t.left;break}}break}case Br:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/effect/issues")};var mO={emptyCase:_s,failCase:no,dieCase:no,interruptCase:_s,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var hh="SequentialCase",dh="ParallelCase",Ih=l(2,(e,{onDie:t,onEmpty:r,onFail:o,onInterrupt:n,onParallel:s,onSequential:a})=>mp(e,void 0,{emptyCase:()=>r,failCase:(i,c)=>o(c),dieCase:(i,c)=>t(c),interruptCase:(i,c)=>n(c),sequentialCase:(i,c,p)=>a(c,p),parallelCase:(i,c,p)=>s(c,p)})),wo=l(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let a=r(o,n);switch(o=$(a)?a.value:o,n._tag){case Ur:{s.push(n.right),n=n.left;break}case Br:{s.push(n.right),n=n.left;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),mp=l(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let a=o.pop();switch(a._tag){case Hr:{n.push(ie(r.emptyCase(t)));break}case Dr:{n.push(ie(r.failCase(t,a.error)));break}case ko:{n.push(ie(r.dieCase(t,a.defect)));break}case Co:{n.push(ie(r.interruptCase(t,a.fiberId)));break}case Ur:{o.push(a.right),o.push(a.left),n.push(pe({_tag:hh}));break}case Br:{o.push(a.right),o.push(a.left),n.push(pe({_tag:dh}));break}}}let s=[];for(;n.length>0;){let a=n.pop();switch(a._tag){case"Left":{switch(a.left._tag){case hh:{let i=s.pop(),c=s.pop(),p=r.sequentialCase(t,i,c);s.push(p);break}case dh:{let i=s.pop(),c=s.pop(),p=r.parallelCase(t,i,c);s.push(p);break}}break}case"Right":{s.push(a.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),hO=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},Pn=e=>wn(e)?"All fibers interrupted without errors.":dO(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${hO(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=At(n.parent),s++}return o}).join(`\r
`),Oa=class{message;stack;span;constructor(t,r,o){this.message=t,this.stack=r,this.span=o}toJSON(){let t={message:this.message};return this.stack&&(t.stack=this.stack),this.span&&(t.span=this.span),t}},gh=e=>typeof e=="string"?`Error: ${e}`:b(e,"toString")&&Tt(e.toString)&&e.toString!==Object.prototype.toString?e.toString():`Error: ${JSON.stringify(e)}`,xh=Symbol.for("effect/SpanAnnotation"),yh=e=>{let t=b(e,xh)&&e[xh];return e instanceof Error?new Oa(gh(e),e.stack?.split(`
`).filter(r=>r.match(/at (.*)/)).join(`
`),t):new Oa(gh(e),void 0,t)},dO=e=>mp(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[yh(r)],failCase:(t,r)=>[yh(r)],interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o]});var No="Pending",_a="Done";var gO="effect/Deferred",Ch=Symbol.for(gO),vh={_E:e=>e,_A:e=>e},Ea=e=>({_tag:No,joiners:e}),wh=e=>({_tag:_a,effect:e});var Ph=Symbol.for("effect/Tracer"),yO=e=>({[Ph]:Ph,...e}),Nn=Be(Symbol.for("effect/Tracer")),Ta=Be(Symbol.for("effect/ParentSpan")),SO=P("effect/Tracer/SpanId.ids",()=>tr(0)),dp=class{name;parent;context;links;startTime;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${Im(SO)}`}end=(t,r)=>{this.status={_tag:"Ended",endTime:t,exit:r,startTime:this.status.startTime}};attribute=(t,r)=>{this.attributes.set(t,r)};event=(t,r,o)=>{this.events.push([t,r,o??{}])}},Nh=yO({span:(e,t,r,o,n)=>new dp(e,t,r,o,n),context:e=>e()});var OO="effect/EffectError",_O=Symbol.for(OO),Uh=e=>b(e,_O);var Ca=(e,t)=>{let r=new ye("Blocked");return r.i0=e,r.i1=t,r},Op=e=>{let t=new ye("RunBlocked");return t.i0=e,t},Mn=Symbol.for("effect/Effect"),Ra=class{patch;op;_op=cn;constructor(t,r){this.patch=t,this.op=r}},ye=class{_op;i0=void 0;i1=void 0;i2=void 0;trace=void 0;[Mn]=Wt;constructor(t){this._op=t}[E](t){return this===t}[O](){return jt(this)}pipe(){return x(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,i0:F(this.i0),i1:F(this.i1),i2:F(this.i2)}}toString(){return q(this.toJSON())}[M](){return this.toJSON()}},Aa=class{_op;i0=void 0;i1=void 0;i2=void 0;trace=void 0;[Mn]=Wt;constructor(t){this._op=t,this._tag=t}[E](t){return this===t}[O](){return jt(this)}get cause(){return this.i0}pipe(){return x(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return q(this.toJSON())}[M](){return this.toJSON()}},Ia=class{_op;i0=void 0;i1=void 0;i2=void 0;trace=void 0;[Mn]=Wt;constructor(t){this._op=t,this._tag=t}[E](t){return this===t}[O](){return jt(this)}get value(){return this.i0}pipe(){return x(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:F(this.value)}}toString(){return q(this.toJSON())}[M](){return this.toJSON()}},Fn=e=>b(e,Mn),it=e=>{let t=new ye(Ps);return t.i0=e,t},_p=l(3,(e,t,r)=>Fo(o=>w(e,n=>w(qn(te(()=>o(t(n)))),s=>te(()=>r(n,s)).pipe(Ft({onFailure:a=>{switch(s._tag){case Me:return Ye(Kr(s.i0,a));case Fe:return Ye(a)}},onSuccess:()=>s})))))),sr=l(2,(e,t)=>w(e,()=>H(t))),ar=e=>sr(e,void 0),jr=(e,t=wt)=>te(()=>{let r,o;function n(c){r?r(c):o===void 0&&(o=c)}let s=new ye(uo);s.i0=c=>{r=c,o&&c(o)},s.i1=t;let a,i;return e.length!==1?(i=new AbortController,a=e(n,i.signal)):a=e(n),a||i?Na(s,c=>(i&&i.abort(),a??je)):s}),Ln=(e,t=wt)=>jr(r=>{let o=e(r);if(Le(o))r(o.right);else return o.left},t);var va=l(2,(e,t)=>Mo(e,{onFailure:t,onSuccess:H}));var yp=Symbol.for("effect/SpanAnnotation"),Mh=Symbol.for("effect/OriginalAnnotation");var EO=(e,t)=>$(t)?new Proxy(e,{has(r,o){return o===yp||o===Mh||o in r},get(r,o){return o===yp?t.value:o===Mh?e:r[o]}}):e;var Ep=e=>Kh(()=>St(new vO(e)));var Wr=e=>Mo(e,{onFailure:t=>H(pe(t)),onSuccess:t=>H(ie(t))}),qn=e=>jh(e,{onFailure:V,onSuccess:Ie}),Se=e=>io(e)&&!(yp in e)?it(t=>Ye(lp(EO(e,HO(t))))):Ye(lp(e)),Tp=e=>w(k(e),Se),Ye=e=>{let t=new Aa(Me);return t.i0=e,t},Kh=e=>w(k(e),Ye),Rp=it(e=>H(e.id())),Ap=e=>it(t=>e(t.id())),w=l(2,(e,t)=>{let r=new ye(fo);return r.i0=e,r.i1=t,r});var Ip=e=>{let t=new ye("OnStep");return t.i0=e,t},Hn=e=>w(e,B);var jh=l(2,(e,{onFailure:t,onSuccess:r})=>Ft(e,{onFailure:o=>H(t(o)),onSuccess:o=>H(r(o))})),Ft=l(2,(e,{onFailure:t,onSuccess:r})=>{let o=new ye(mo);return o.i0=e,o.i1=t,o.i2=r,o}),Mo=l(2,(e,{onFailure:t,onSuccess:r})=>Ft(e,{onFailure:o=>{let n=_h(o);return Eh(o).length>0?Ye(Ah(o)):n.length>0?t(Ar(n)):Ye(o)},onSuccess:r})),ct=l(2,(e,t)=>te(()=>{let r=Te(e),o=new Array(r.length),n=0;return sr(Un({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),zr=l(2,(e,t)=>te(()=>{let r=Te(e),o=0;return Un({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})}));var wa=e=>{let t=new ye(Er);return t.i0=ih(qr),t.i1=()=>e,t};var Z=l(2,(e,t)=>w(e,r=>k(()=>t(r)))),Pa=l(2,(e,{onFailure:t,onSuccess:r})=>Mo(e,{onFailure:o=>Tp(()=>t(o)),onSuccess:o=>k(()=>r(o))})),Dn=l(2,(e,t)=>Ft(e,{onFailure:r=>{let o=up(r);switch(o._tag){case"Left":return Tp(()=>t(o.left));case"Right":return Ye(o.right)}},onSuccess:H}));var kp=l(2,(e,t)=>Fo(r=>Ft(r(e),{onFailure:o=>{let n=V(o);return Ft(t(n),{onFailure:s=>V(Ke(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=Ie(o);return jn(t(n),n)}}))),Na=l(2,(e,t)=>kp(e,NO({onFailure:r=>wn(r)?ar(t(Th(r))):je,onSuccess:()=>je})));var H=e=>{let t=new Ia(Fe);return t.i0=e,t},te=e=>w(k(e),B),k=e=>{let t=new ye(ws);return t.i0=e,t},Bn=l(2,(e,t)=>w(e,r=>{let o=typeof t=="function"?t(r):t;return Fn(o)?sr(o,r):ef(o)?jr(n=>{o.then(s=>n(H(r))).catch(s=>n(Se(new PO(s))))}):H(r)})),Cp=e=>it(t=>{let r=t.getFiberRef(ka),o=u(r,G(()=>t.scope()));return e(ir(ka,C(o)))});var Ma=e=>{let t=new ye(Er);return t.i0=sp(qr),t.i1=()=>e,t},Fo=e=>{let t=new ye(Er);return t.i0=sp(qr),t.i1=r=>op(r)?e(wa):e(Ma),t},je=H(void 0),vp=e=>{let t=new ye(Er);return t.i0=e,t.i1=void 0,t};var Un=e=>{let t=new ye(ho);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t};var Kn=e=>{let t=new ye(go);return typeof e?.priority<"u"?od(t,e.priority):t},Fa=l(2,(e,t)=>w(e,r=>Z(t,o=>[r,o])));var La=l(2,(e,t)=>w(e,r=>sr(t,r))),jn=l(2,(e,t)=>w(e,()=>t));var Wn=Ln(()=>{let e=setInterval(()=>{},2147483647);return pe(k(()=>clearInterval(e)))}),Wh=e=>w(Rp,t=>u(e,wp(t))),wp=l(2,(e,t)=>w(e.interruptAsFork(t),()=>e.await)),zh={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return x(this,arguments)}},$h={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return x(this,arguments)}},Gh={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return x(this,arguments)}},Vh={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return x(this,arguments)}},Pp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return x(this,arguments)}},Np={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return x(this,arguments)}},Jh={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return x(this,arguments)}},Yh={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return x(this,arguments)}};var TO="effect/FiberRef",RO=Symbol.for(TO),AO={_A:e=>e},zn=e=>Qh(e,t=>[t,t]);var $r=l(2,(e,t)=>w(zn(e),t)),Sp=l(2,(e,t)=>Qh(e,()=>[void 0,t]));var Qh=l(2,(e,t)=>it(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),H(o)}));var IO="effect/RequestResolver",Zh=Symbol.for(IO),kO={_A:e=>e,_R:e=>e},Fh=class e{runAll;target;[Zh]=kO;constructor(t,r){this.runAll=t,this.target=r,this.runAll=t}[O](){return this.target?d(this.target):jt(this)}[E](t){return this.target?CO(t)&&y(this.target,t.target):this===t}identified(...t){return new e(this.runAll,mn(t))}pipe(){return x(this,arguments)}},CO=e=>b(e,Zh);var ir=l(3,(e,t,r)=>_p(La(zn(t),Sp(t,r)),()=>e,o=>Sp(t,o)));var be=(e,t)=>Lo(e,{differ:Xc(),fork:t?.fork??B,join:t?.join}),Mp=e=>{let t=Zc();return Lo(e,{differ:t,fork:t.empty})},qa=e=>{let t=Qc();return Lo(e,{differ:t,fork:t.empty})},Lo=(e,t)=>({[RO]:AO,initial:e,diff:(r,o)=>t.differ.diff(r,o),combine:(r,o)=>t.differ.combine(r,o),patch:r=>o=>t.differ.patch(r,o),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return x(this,arguments)}}),Xh=e=>Lo(e,{differ:np,fork:np.empty}),Gr=P(Symbol.for("effect/FiberRef/currentContext"),()=>qa(gn())),$n=P(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>be(0)),ed=P(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>be(2048)),td=P(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>be(or())),Fp=P(Symbol.for("effect/FiberRef/currentLogLevel"),()=>be(Pp)),rd=P(Symbol.for("effect/FiberRef/currentLogSpan"),()=>be(nr())),od=l(2,(e,t)=>ir(e,$n,t));var nd=P(Symbol.for("effect/FiberRef/currentConcurrency"),()=>be("unbounded")),sd=P(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>be(!0)),ad=P(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>be(C(Np)));var Gn=P(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>Mp(me()));var ka=P(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>be(R(),{fork:()=>R(),join:(e,t)=>e})),Vn=P(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>be(vo,{fork:()=>vo,join:(e,t)=>e}));var id=Symbol.for("effect/Scope");var Ha=(e,t)=>e.fork(t);var cd=function(){class e extends globalThis.Error{commit(){return Se(this)}toString(){return this.message?`${this.name}: ${this.message}`:this.name}toJSON(){return{...this}}[M](){let r=this.stack;return r?`${this.toString()}
${r.split(`
`).slice(1).join(`
`)}`:this.toString()}}return Object.assign(e.prototype,Vi),e}(),Jn=(e,t)=>{class r extends cd{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},Lh=Symbol.for("effect/Cause/errors/RuntimeException"),vO=Jn({[Lh]:Lh},"RuntimeException");var bp=Symbol.for("effect/Cause/errors/InterruptedException"),Zk=Jn({[bp]:bp},"InterruptedException"),pd=e=>b(e,bp),qh=Symbol.for("effect/Cause/errors/IllegalArgument"),wO=Jn({[qh]:qh},"IllegalArgumentException");var Hh=Symbol.for("effect/Cause/errors/NoSuchElement"),ld=Jn({[Hh]:Hh},"NoSuchElementException");var Dh=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),Xk=Jn({[Dh]:Dh},"InvalidPubSubCapacityException");var Bh=Symbol.for("effect/Cause/errors/UnknownException"),PO=function(){class e extends cd{error;_tag="UnknownException";constructor(r,o){super(o??(b(r,"message")&&Sr(r.message)?r.message:void 0)),this.error=r}}return Object.assign(e.prototype,{[Bh]:Bh,name:"UnknownException"}),e}();var Lp=(e,t)=>MO(e,t?.parallel?Kr:Ke);var V=e=>{let t=new Aa(Me);return t.i0=e,t};var ud=e=>V(Mt(e)),xp=l(2,(e,t)=>{switch(e._tag){case Me:return V(e.i0);case Fe:return Ie(t(e.i0))}});var NO=l(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case Me:return t(e.i0);case Fe:return r(e.i0)}});var Ie=e=>{let t=new Ia(Fe);return t.i0=e,t},cr=Ie(void 0);var fd=l(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case Me:switch(t._tag){case Fe:return V(e.i0);case Me:return V(r(e.i0,t.i0))}case Fe:switch(t._tag){case Fe:return Ie(o(e.i0,t.i0));case Me:return V(t.i0)}}}),MO=(e,t)=>{let r=mn(e);return nt(r)?u(at(r),It(u(st(r),xp(ce)),(o,n)=>u(o,fd(n,{onSuccess:(s,a)=>u(s,xe(a)),onFailure:t}))),xp(Vt),xp(o=>Array.from(o)),C):R()},md=e=>({[Ch]:vh,state:tr(Ea([])),blockingOn:e,pipe(){return x(this,arguments)}});var hd=e=>Ln(t=>{let r=Ue(e.state);switch(r._tag){case _a:return ie(r.effect);case No:return u(e.state,xt(Ea([t,...r.joiners]))),pe(FO(e,t))}},e.blockingOn);var Da=(e,t)=>{let r=Ue(e.state);if(r._tag===No){u(e.state,xt(wh(t)));for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},FO=(e,t)=>k(()=>{let r=Ue(e.state);r._tag===No&&u(e.state,xt(Ea(r.joiners.filter(o=>o!==t))))}),LO=zn(Gr),dd=()=>LO;var Vr=e=>w(dd(),e),qO=l(2,(e,t)=>ir(Gr,t)(e));var qp=l(2,(e,t)=>Vr(r=>qO(e,t(r)))),HO=e=>{let t=e.getFiberRef(Gr).unsafeMap.get(Ta);return t!==void 0&&t._tag==="Span"?C(t):R()};var Hp=Symbol.for("effect/Duration"),DO=BigInt(1e3),Dp=BigInt(1e9),gd=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,Lt=e=>{if(Ua(e))return e;if(Y(e))return qo(e);if(tt(e))return Yn(e);if(Array.isArray(e)){if(e.length===2&&Y(e[0])&&Y(e[1]))return Yn(BigInt(e[0])*Dp+BigInt(e[1]))}else{gd.lastIndex=0;let t=gd.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Yn(BigInt(o));case"micros":return Bp(BigInt(o));case"millis":return qo(s);case"seconds":return Up(s);case"minutes":return Kp(s);case"hours":return jp(s);case"days":return Wp(s);case"weeks":return zp(s)}}}throw new Error("Invalid duration input")},xd={_tag:"Millis",millis:0},BO={_tag:"Infinity"},UO={[Hp]:Hp,[O](){return ks(this.value)},[E](e){return Ua(e)&&jO(this,e)},toString(){return`Duration(${WO(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:Sd(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},qt=e=>{let t=Object.create(UO);return Y(e)?isNaN(e)||e<0?t.value=xd:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=BO:e<BigInt(0)?t.value=xd:t.value={_tag:"Nanos",nanos:e},t},Ua=e=>b(e,Hp),yd=qt(0);var Yn=e=>qt(e),Bp=e=>qt(e*DO),qo=e=>qt(e),Up=e=>qt(e*1e3),Kp=e=>qt(e*6e4),jp=e=>qt(e*36e5),Wp=e=>qt(e*864e5),zp=e=>qt(e*6048e5),Ba=e=>{let t=Lt(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var KO=e=>{let t=Lt(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},Sd=e=>{let t=Lt(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/Dp),Number(t.value.nanos%Dp)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},bd=l(2,(e,t)=>{let r=Lt(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),Od=l(3,(e,t,r)=>{let o=Lt(e),n=Lt(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Ba(o),Ba(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),a=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,a)}return r.onMillis(o.value.millis,n.value.millis)});var $p=(e,t)=>Od(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var _d=l(2,(e,t)=>Od(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),jO=l(2,(e,t)=>$p(Lt(e),Lt(t))),WO=e=>{let t=Lt(e),r=[];if(t.value._tag==="Infinity")return"Infinity";let o=KO(t);o%1000000n&&r.push(`${o%1000000n}ns`);let n=o/1000000n;n%1000n!==0n&&r.push(`${n%1000n}ms`);let s=n/1000n;s%60n!==0n&&r.push(`${s%60n}s`);let a=s/60n;a%60n!==0n&&r.push(`${a%60n}m`);let i=a/60n;i%24n!==0n&&r.push(`${i%24n}h`);let c=i/24n;return c!==0n&&r.push(`${c}d`),r.reverse().join(" ")};var We=bf;var Ed=Symbol.for("effect/MutableHashMap"),VO={[Ed]:Ed,[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()},toString(){return q(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},JO=e=>{let t=Object.create(VO);return t.backingMap=tr(e),t},Td=()=>JO(or());var pr=l(2,(e,t)=>On(e.backingMap.current,t)),Ho=l(2,(e,t)=>$(pr(e,t)));var Do=l(3,(e,t,r)=>(km(e.backingMap,Io(t,r)),e));var Rd=typeof process>"u"?!1:!!process?.isBun,Ad=Rd?e=>clearInterval(e):e=>clearTimeout(e),ja=Rd?(e,t)=>{let r=setInterval(()=>{e(),clearInterval(r)},t);return r}:(e,t)=>setTimeout(e,t);var QO="effect/Clock",Vp=Symbol.for(QO),Qn=Be(Vp),ZO=2**31-1,kd={unsafeSchedule(e,t){let r=Ba(t);if(r>ZO)return no;let o=!1,n=ja(()=>{o=!0,e()},r);return()=>(Ad(n),!o)}},Cd=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6));return()=>t+BigInt(Math.round(performance.now()*1e6))}(),XO=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return Cd;let t=Cd()-e.bigint();return()=>t+e.bigint()}(),Jp=class{[Vp]=Vp;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return XO()}currentTimeMillis=k(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=k(()=>this.unsafeCurrentTimeNanos());scheduler(){return H(kd)}sleep(t){return Ln(r=>{let o=kd.unsafeSchedule(()=>r(je),t);return pe(ar(k(o)))})}},vd=()=>new Jp;var Yp="And",Qp="Or",Zp="InvalidData",Xp="MissingData",el="SourceUnavailable",tl="Unsupported";var t_="effect/ConfigError",Pd=Symbol.for(t_),Bo={[Pd]:Pd},rl=(e,t)=>{let r=Object.create(Bo);return r._tag=Yp,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},ol=(e,t)=>{let r=Object.create(Bo);return r._tag=Qp,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},r_=(e,t,r={pathDelim:"."})=>{let o=Object.create(Bo);return o._tag=Zp,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${u(this.path,ht(r.pathDelim))}: "${this.message}")`}}),o},Ht=(e,t,r={pathDelim:"."})=>{let o=Object.create(Bo);return o._tag=Xp,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${u(this.path,ht(r.pathDelim))}: "${this.message}")`}}),o},o_=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(Bo);return n._tag=el,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${u(this.path,ht(o.pathDelim))}: "${this.message}")`}}),n},n_=(e,t,r={pathDelim:"."})=>{let o=Object.create(Bo);return o._tag=tl,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${u(this.path,ht(r.pathDelim))}: "${this.message}")`}}),o};var lr=l(2,(e,t)=>{switch(e._tag){case Yp:return rl(lr(e.left,t),lr(e.right,t));case Qp:return ol(lr(e.left,t),lr(e.right,t));case Zp:return r_([...t,...e.path],e.message);case Xp:return Ht([...t,...e.path],e.message);case el:return o_([...t,...e.path],e.message,e.cause);case tl:return n_([...t,...e.path],e.message)}});var Md={_tag:"Empty"};var Wa=l(2,(e,t)=>{let r=Tn(t),o=e;for(;En(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=Pt(n.first,Pt(n.second,r.tail));break}case"MapName":{o=Re(o,n.f),r=r.tail;break}case"Nested":{o=rt(o,n.name),r=r.tail;break}case"Unnested":{if(u(Hs(o),Af(n.name)))o=mt(o),r=r.tail;else return pe(Ht(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return ie(o)});var Fd="Constant",Ld="Fail",qd="Fallback",Hd="Described",Dd="Lazy",Bd="MapOrFail",Ud="Nested",Kd="Primitive",jd="Sequence",Wd="HashMap",zd="ZipWith";var za=(e,t)=>[...e,...t],i_="effect/ConfigProvider",nl=Symbol.for(i_),Gd=Be(nl),c_="effect/ConfigProviderFlat",$d=Symbol.for(c_),p_=e=>({[nl]:nl,pipe(){return x(this,arguments)},...e}),l_=e=>({[$d]:$d,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),u_=e=>p_({load:t=>w(Qe(e,Rr(),t,!1),r=>se(Hs(r),{onNone:()=>Se(Ht(Rr(),`Expected a single value having structure: ${t}`)),onSome:H})),flattened:e}),Vd=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=c=>u(c,ht(t)),n=c=>c.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return u_(l_({load:(c,p,f=!0)=>{let m=o(c),h=s(),g=m in h?C(h[m]):R();return u(g,Dn(()=>Ht(c,`Expected ${m} to exist in the process context`)),w(S=>g_(S,c,p,r,f)))},enumerateChildren:c=>k(()=>{let p=s(),f=Object.keys(p),h=Array.from(f).map(g=>n(g.toUpperCase())).filter(g=>{for(let S=0;S<c.length;S++){let I=u(c,mc(S)),T=g[S];if(T===void 0||I!==T)return!1}return!0}).flatMap(g=>g.slice(c.length,c.length+1));return er(h)}),patch:Md}))};var f_=(e,t,r,o)=>{let n=xc(r.length,c=>c>=o.length?R():C([e(c),c+1])),s=xc(o.length,c=>c>=r.length?R():C([t(c),c+1])),a=za(r,n),i=za(o,s);return[a,i]},m_=(e,t)=>{let r=t;if(r._tag==="Nested"){let o=e.slice();for(;r._tag==="Nested";)o.push(r.name),r=r.config;return o}return e},Qe=(e,t,r,o)=>{let n=r;switch(n._tag){case Fd:return H(He(n.value));case Hd:return te(()=>Qe(e,t,n.config,o));case Ld:return Se(Ht(t,n.message));case qd:return u(te(()=>Qe(e,t,n.first,o)),va(s=>n.condition(s)?u(Qe(e,t,n.second,o),va(a=>Se(ol(s,a)))):Se(s)));case Dd:return te(()=>Qe(e,t,n.config(),o));case Bd:return te(()=>u(Qe(e,t,n.original,o),w(ct(s=>u(n.mapOrFail(s),Dn(lr(m_(t,n.original))))))));case Ud:return te(()=>Qe(e,za(t,He(n.name)),n.config,o));case Kd:return u(Wa(t,e.patch),w(s=>u(e.load(s,n,o),w(a=>{if(a.length===0){let i=u(Ds(s),G(()=>"<n/a>"));return Se(Ht([],`Expected ${n.description} with name ${i}`))}return H(a)}))));case jd:return u(Wa(t,e.patch),w(s=>u(e.enumerateChildren(s),w(S_),w(a=>a.length===0?te(()=>Z(Qe(e,s,n.config,!0),He)):u(ct(a,i=>Qe(e,wf(t,`[${i}]`),n.config,!0)),Z(i=>{let c=gc(i);return c.length===0?He(Rr()):He(c)}))))));case Wd:return te(()=>u(Wa(t,e.patch),w(s=>u(e.enumerateChildren(s),w(a=>u(a,ct(i=>Qe(e,za(s,He(i)),n.valueConfig,o)),Z(i=>{if(i.length===0)return He(or());let c=i.map(p=>Array.from(p));return u(x_(c),Re(p=>bn(dc(Te(a),p))))})))))));case zd:return te(()=>u(Qe(e,t,n.left,o),Wr,w(s=>u(Qe(e,t,n.right,o),Wr,w(a=>{if(ae(s)&&ae(a))return Se(rl(s.left,a.left));if(ae(s)&&Le(a))return Se(s.left);if(Le(s)&&ae(a))return Se(a.left);if(Le(s)&&Le(a)){let i=u(t,ht(".")),c=h_(t,i),[p,f]=f_(c,c,u(s.right,Re(ie)),u(a.right,Re(ie)));return u(p,dc(f),ct(([m,h])=>u(Fa(m,h),Z(([g,S])=>n.zip(g,S)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},h_=(e,t)=>r=>pe(Ht(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var d_=(e,t)=>e.split(new RegExp(`\\s*${y_(t)}\\s*`)),g_=(e,t,r,o,n)=>n?u(d_(e,o),ct(s=>r.parse(s.trim())),Dn(lr(t))):u(r.parse(e),Pa({onFailure:lr(t),onSuccess:He})),x_=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),y_=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),S_=e=>u(ct(e,O_),Pa({onFailure:()=>Rr(),onSuccess:Tr(We)}),Wr,Z(Cf));var b_=/^(\[(\d+)\])$/,O_=e=>{let t=e.match(b_);if(t!==null){let r=t[2];return u(r!==void 0&&r.length>0?C(r):R(),un(__))}return R()};var __=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?R():C(t)};var sl=Symbol.for("effect/Console"),$a=Be(sl),Jd={[sl]:sl,assert(e,...t){return k(()=>{console.assert(e,...t)})},clear:k(()=>{console.clear()}),count(e){return k(()=>{console.count(e)})},countReset(e){return k(()=>{console.countReset(e)})},debug(...e){return k(()=>{console.debug(...e)})},dir(e,t){return k(()=>{console.dir(e,t)})},dirxml(...e){return k(()=>{console.dirxml(...e)})},error(...e){return k(()=>{console.error(...e)})},group(e){return e?.collapsed?k(()=>console.groupCollapsed(e?.label)):k(()=>console.group(e?.label))},groupEnd:k(()=>{console.groupEnd()}),info(...e){return k(()=>{console.info(...e)})},log(...e){return k(()=>{console.log(...e)})},table(e,t){return k(()=>{console.table(e,t)})},time(e){return k(()=>console.time(e))},timeEnd(e){return k(()=>console.timeEnd(e))},timeLog(e,...t){return k(()=>{console.timeLog(e,...t)})},trace(...e){return k(()=>{console.trace(...e)})},warn(...e){return k(()=>{console.warn(...e)})},unsafe:console};var R_="effect/Random",al=Symbol.for(R_),Yd=Be(al),il=class{seed;[al]=al;PRNG;constructor(t){this.seed=t,this.PRNG=new co(t)}get next(){return k(()=>this.PRNG.number())}get nextBoolean(){return Z(this.next,t=>t>.5)}get nextInt(){return k(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return Z(this.next,o=>(r-t)*o+t)}nextIntBetween(t,r){return k(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return A_(t,r=>this.nextIntBetween(0,r))}},A_=(e,t)=>te(()=>u(k(()=>Array.from(e)),w(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return u(o,zr(n=>u(t(n),Z(s=>I_(r,n-1,s)))),sr(mn(r)))}))),I_=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},Qd=e=>new il(e);var w_=u(gn(),Ir(Qn,vd()),Ir($a,Jd),Ir(Yd,Qd(Math.random()*4294967296>>>0)),Ir(Gd,Vd()),Ir(Nn,Nh)),Uo=P(Symbol.for("effect/DefaultServices/currentServices"),()=>qa(w_));var cl=Symbol.for("effect/FiberRefs"),Ko=class{locals;[cl]=cl;constructor(t){this.locals=t}pipe(){return x(this,arguments)}},N_=(e,t,r,o=!1)=>{let n=e,s=t,a=r,i=o,c;for(;c===void 0;)if(qe(s)&&qe(a)){let p=le(s)[0],f=mt(s),m=le(a)[0],h=le(a)[1],g=mt(a);p.startTimeMillis<m.startTimeMillis?(a=g,i=!0):p.startTimeMillis>m.startTimeMillis?s=f:p.id<m.id?(a=g,i=!0):p.id>m.id?s=f:c=[h,i]}else c=[n.initial,!0];return c},pl=l(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let a=le(s)[1];if(!y(le(s)[0],t)){if(!o.has(n)){if(y(a,n.initial))continue;o.set(n,[[t,n.join(n.initial,a)]]);continue}let i=o.get(n),[c,p]=N_(n,i,s);if(p){let f=n.diff(c,a),m=le(i)[1],h=n.join(m,n.patch(f)(m));if(!y(m,h)){let g,S=le(i)[0];y(S,t)?g=rt([S,h])(mt(i)):g=rt([t,h])(i),o.set(n,g)}}}}return new Ko(new Map(o))}),ll=l(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=le(n)[1],a=o.patch(o.fork)(s);y(s,a)?r.set(o,n):r.set(o,rt([t,a])(n))}return new Ko(r)});var Zn=l(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Ko(r)}),Xn=l(2,(e,t)=>e.locals.has(t)?C(le(e.locals.get(t))[1]):R()),jo=l(2,(e,t)=>u(Xn(e,t),G(()=>t.initial))),Wo=l(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):Rr(),s;if(fc(n))s=He([t,o]);else{let[i,c]=le(n);if(y(i,t)){if(y(c,o))return e;s=rt([t,o])(mt(n))}else s=rt([t,o])(n)}let a=new Map(e.locals);return new Ko(a.set(r,s))});var Zd=jo;var F_=zh,L_=$h,q_=Gh,H_=Vh,D_=Pp,B_=Np,U_=Jh,K_=Yh;var j_=u(We,ln(e=>e.ordinal));var Xd=tc(j_);var eg=e=>{switch(e){case"All":return F_;case"Debug":return B_;case"Error":return q_;case"Fatal":return L_;case"Info":return D_;case"Trace":return U_;case"None":return K_;case"Warning":return H_}};var tg=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var rg=tg;var og="Empty",ng="Add",sg="Remove",ag="Update",ig="AndThen",cg={_tag:og},pg=(e,t)=>{let r=new Map(e.locals),o=cg;for(let[n,s]of t.locals.entries()){let a=le(s)[1],i=r.get(n);if(i!==void 0){let c=le(i)[1];y(c,a)||(o=Ga({_tag:ag,fiberRef:n,patch:n.diff(c,a)})(o))}else o=Ga({_tag:ng,fiberRef:n,value:a})(o);r.delete(n)}for(let[n]of r.entries())o=Ga({_tag:sg,fiberRef:n})(o);return o},Ga=l(2,(e,t)=>({_tag:ig,first:e,second:t})),lg=l(3,(e,t,r)=>{let o=r,n=He(e);for(;qe(n);){let s=le(n),a=mt(n);switch(s._tag){case og:{n=a;break}case ng:{o=Wo(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=a;break}case sg:{o=Zn(o,s.fiberRef),n=a;break}case ag:{let i=jo(o,s.fiberRef);o=Wo(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(i)}),n=a;break}case ig:{n=rt(s.first)(rt(s.second)(a));break}}}return o});var ug="effect/MetricLabel",fl=Symbol.for(ug),ml=class{key;value;[fl]=fl;constructor(t,r){this.key=t,this.value=r}[O](){return u(d(ug),_(d(this.key)),_(d(this.value)))}[E](t){return V_(t)&&this.key===t.key&&this.value===t.value}pipe(){return x(this,arguments)}},fg=(e,t)=>new ml(e,t),V_=e=>b(e,fl);var hl=Gi;var Y_="Sequential",Q_="Parallel",Z_="ParallelN",mg={_tag:Y_},hg={_tag:Q_},dg=e=>({_tag:Z_,parallelism:e});var Va=mg,Ja=hg,Ya=dg;var gg=pg;var xg=lg;var Qa="effect/FiberStatus",ur=Symbol.for(Qa),dl="Done",yg="Running",Sg="Suspended",gl=class{[ur]=ur;_tag=dl;[O](){return u(d(Qa),_(d(this._tag)))}[E](t){return Za(t)&&t._tag===dl}},xl=class{runtimeFlags;[ur]=ur;_tag=yg;constructor(t){this.runtimeFlags=t}[O](){return u(d(Qa),_(d(this._tag)),_(d(this.runtimeFlags)))}[E](t){return Za(t)&&t._tag===yg&&this.runtimeFlags===t.runtimeFlags}},yl=class{runtimeFlags;blockingOn;[ur]=ur;_tag=Sg;constructor(t,r){this.runtimeFlags=t,this.blockingOn=r}[O](){return u(d(Qa),_(d(this._tag)),_(d(this.runtimeFlags)),_(d(this.blockingOn)))}[E](t){return Za(t)&&t._tag===Sg&&this.runtimeFlags===t.runtimeFlags&&y(this.blockingOn,t.blockingOn)}},bg=new gl,Og=e=>new xl(e),_g=(e,t)=>new yl(e,t),Za=e=>b(e,ur),Eg=e=>e._tag===dl;var Tg=bg,Sl=Og,Rg=_g;var Ag=Eg;var bl=class{buckets=[];scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let a=0;a<n;a++)s.push(this.buckets[a]);s.push([r,[t]]);for(let a=n;a<this.buckets.length;a++)s.push(this.buckets[a]);this.buckets=s}}},Ol=class{maxNextTickBeforeTimer;running=!1;tasks=new bl;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?ja(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(ed)?t.getFiberRef($n):!1}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},nE=P(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new Ol(2048));var _l=P(Symbol.for("effect/FiberRef/currentScheduler"),()=>be(nE));var Xa=P(Symbol.for("effect/FiberRef/currentRequestMap"),()=>be(new Map));var El=(e,t,r,o)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return $r(nd,n=>n==="unbounded"?r():n>1?o(n):t());default:return e>1?o(e):t()}};var ei="InterruptSignal",ti="Stateful",ri="Resume",oi="YieldNow",ni=e=>({_tag:ei,cause:e}),zo=e=>({_tag:ti,onFiber:e}),Jr=e=>({_tag:ri,effect:e}),Ig=()=>({_tag:oi});var iE="effect/FiberScope",si=Symbol.for(iE),Tl=class{[si]=si;fiberId=wt;roots=new Set;add(t,r){this.roots.add(r),r.addObserver(()=>{this.roots.delete(r)})}},Rl=class{fiberId;parent;[si]=si;constructor(t,r){this.fiberId=t,this.parent=r}add(t,r){this.parent.tell(zo(o=>{o.addChild(r),r.addObserver(()=>{o.removeChild(r)})}))}},Cg=e=>new Rl(e.id(),e),Al=P(Symbol.for("effect/FiberScope/Global"),()=>new Tl);var lE="effect/Fiber",Il=Symbol.for(lE),kl={_E:e=>e,_A:e=>e},uE={[Il]:kl,pipe(){return x(this,arguments)}},fE="effect/Fiber",vg=Symbol.for(fE);var wg=e=>e.await;var Pg=e=>La(Hn(e.await),e.inheritAll);var rv={...uE,id:()=>wt,await:Wn,children:H([]),inheritAll:Wn,poll:H(R()),interruptAsFork:()=>Wn};var fr="effect/FiberCurrent";var hE="effect/Logger",Ng=Symbol.for(hE),Mg={_Message:e=>e,_Output:e=>e},ii=e=>({[Ng]:Mg,log:e,pipe(){return x(this,arguments)}});var sv={[Ng]:Mg,log:qi,pipe(){return x(this,arguments)}};var Fg=ii(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:a})=>{let i=r.getTime(),p=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${sa(o)}`].join(" "),f=ai(s);if(f.length>0&&(p=p+" message=",p=Cl(f,p)),t!=null&&t._tag!=="Empty"&&(p=p+" cause=",p=Cl(Pn(t),p)),En(a)){p=p+" ";let m=!0;for(let h of a)m?m=!1:p=p+" ",p=p+u(h,rg(i))}if(u(e,$c)>0){p=p+" ";let m=!0;for(let[h,g]of e)m?m=!1:p=p+" ",p=p+xE(h),p=p+"=",p=Cl(ai(g),p)}return p}),ai=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},dE=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,gE=/^[^\s"=]+$/,Cl=(e,t)=>t+(e.match(gE)?e:dE(e));var xE=e=>e.replace(/[\s="]/g,"_");var Lg="effect/MetricBoundaries",vl=Symbol.for(Lg),wl=class{values;[vl]=vl;constructor(t){this.values=t}[O](){return u(d(Lg),_(d(this.values)))}[E](t){return SE(t)&&y(this.values,t.values)}pipe(){return x(this,arguments)}},SE=e=>b(e,vl),bE=e=>{let t=u(e,Ve(ce(Number.POSITIVE_INFINITY)),Kf);return new wl(t)};var qg=e=>u(uc(e.count-1,t=>e.start*Math.pow(e.factor,t)),Ct,bE);var _E="effect/MetricKeyType",es=Symbol.for(_E),Ug="effect/MetricKeyType/Counter",Pl=Symbol.for(Ug),Kg="effect/MetricKeyType/Frequency",Nl=Symbol.for(Kg),jg="effect/MetricKeyType/Gauge",Ml=Symbol.for(jg),Wg="effect/MetricKeyType/Histogram",Fl=Symbol.for(Wg),zg="effect/MetricKeyType/Summary",Ll=Symbol.for(zg),ts={_In:e=>e,_Out:e=>e},ql=class{incremental;bigint;[es]=ts;[Pl]=Pl;constructor(t,r){this.incremental=t,this.bigint=r}[O](){return d(Ug)}[E](t){return Dl(t)}pipe(){return x(this,arguments)}},Hg=class{[es]=ts;[Nl]=Nl;[O](){return d(Kg)}[E](t){return Bl(t)}pipe(){return x(this,arguments)}},Dg=class{bigint;[es]=ts;[Ml]=Ml;constructor(t){this.bigint=t}[O](){return d(jg)}[E](t){return Ul(t)}pipe(){return x(this,arguments)}},Hl=class{boundaries;[es]=ts;[Fl]=Fl;constructor(t){this.boundaries=t}[O](){return u(d(Wg),_(d(this.boundaries)))}[E](t){return Kl(t)&&y(this.boundaries,t.boundaries)}pipe(){return x(this,arguments)}},Bg=class{maxAge;maxSize;error;quantiles;[es]=ts;[Ll]=Ll;constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n}[O](){return u(d(zg),_(d(this.maxAge)),_(d(this.maxSize)),_(d(this.error)),_(d(this.quantiles)))}[E](t){return jl(t)&&y(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&y(this.quantiles,t.quantiles)}pipe(){return x(this,arguments)}},$g=e=>new ql(e?.incremental??!1,e?.bigint??!1);var Gg=e=>new Hl(e);var Dl=e=>b(e,Pl),Bl=e=>b(e,Nl),Ul=e=>b(e,Ml),Kl=e=>b(e,Fl),jl=e=>b(e,Ll);var EE="effect/MetricKey",Jg=Symbol.for(EE),TE={_Type:e=>e},rs=class{name;keyType;description;tags;[Jg]=TE;constructor(t,r,o,n=me()){this.name=t,this.keyType=r,this.description=o,this.tags=n}[O](){return u(d(this.name),_(d(this.keyType)),_(d(this.description)),_(d(this.tags)))}[E](t){return RE(t)&&this.name===t.name&&y(this.keyType,t.keyType)&&y(this.description,t.description)&&y(this.tags,t.tags)}pipe(){return x(this,arguments)}},RE=e=>b(e,Jg),Yg=(e,t)=>new rs(e,$g(t),ft(t?.description));var Qg=(e,t,r)=>new rs(e,Gg(t),ft(r));var Zg=l(2,(e,t)=>wr(t)===0?e:new rs(e.name,e.keyType,e.description,u(e.tags,Ae(t))));var IE="effect/MetricState",os=Symbol.for(IE),Xg="effect/MetricState/Counter",Wl=Symbol.for(Xg),ex="effect/MetricState/Frequency",zl=Symbol.for(ex),tx="effect/MetricState/Gauge",$l=Symbol.for(tx),rx="effect/MetricState/Histogram",Gl=Symbol.for(rx),ox="effect/MetricState/Summary",Vl=Symbol.for(ox),ns={_A:e=>e},Jl=class{count;[os]=ns;[Wl]=Wl;constructor(t){this.count=t}[O](){return u(d(Xg),_(d(this.count)))}[E](t){return kE(t)&&this.count===t.count}pipe(){return x(this,arguments)}},Yl=class{occurrences;[os]=ns;[zl]=zl;constructor(t){this.occurrences=t}[O](){return u(d(ex),_(d(this.occurrences)))}[E](t){return CE(t)&&y(this.occurrences,t.occurrences)}pipe(){return x(this,arguments)}},Ql=class{value;[os]=ns;[$l]=$l;constructor(t){this.value=t}[O](){return u(d(tx),_(d(this.value)))}[E](t){return vE(t)&&this.value===t.value}pipe(){return x(this,arguments)}},Zl=class{buckets;count;min;max;sum;[os]=ns;[Gl]=Gl;constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s}[O](){return u(d(rx),_(d(this.buckets)),_(d(this.count)),_(d(this.min)),_(d(this.max)),_(d(this.sum)))}[E](t){return wE(t)&&y(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return x(this,arguments)}},Xl=class{error;quantiles;count;min;max;sum;[os]=ns;[Vl]=Vl;constructor(t,r,o,n,s,a){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=a}[O](){return u(d(ox),_(d(this.error)),_(d(this.quantiles)),_(d(this.count)),_(d(this.min)),_(d(this.max)),_(d(this.sum)))}[E](t){return PE(t)&&this.error===t.error&&y(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return x(this,arguments)}},nx=e=>new Jl(e),sx=e=>new Yl(e),ax=e=>new Ql(e),ix=e=>new Zl(e.buckets,e.count,e.min,e.max,e.sum),cx=e=>new Xl(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var kE=e=>b(e,Wl),CE=e=>b(e,zl),vE=e=>b(e,$l),wE=e=>b(e,Gl),PE=e=>b(e,Vl);var ME="effect/MetricHook",FE=Symbol.for(ME),LE={_In:e=>e,_Out:e=>e},ss=e=>({[FE]:LE,pipe(){return x(this,arguments)},...e});var px=BigInt(0),ux=e=>{let t=e.keyType.bigint?px:0,r=e.keyType.incremental?e.keyType.bigint?o=>o>=px:o=>o>=0:o=>!0;return ss({get:()=>nx(t),update:o=>{r(o)&&(t=t+o)}})},fx=e=>{let t=0,r=new Map,o=s=>{t=t+1;let a=r.get(s)??0;r.set(s,a+1)},n=()=>bn(r.entries());return ss({get:()=>sx(n()),update:o})},mx=(e,t)=>{let r=t;return ss({get:()=>ax(r),update:o=>{r=o}})},hx=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,a=0,i=Number.MAX_VALUE,c=Number.MIN_VALUE;u(t,Us(We),bc((m,h)=>{n[h]=m}));let p=m=>{let h=0,g=r;for(;h!==g;){let S=Math.floor(h+(g-h)/2),I=n[S];m<=I?g=S:h=S,g===h+1&&(m<=n[h]?g=h:h=g)}o[h]=o[h]+1,s=s+1,a=a+m,m<i&&(i=m),m>c&&(c=m)},f=()=>{let m=Array(r),h=0;for(let g=0;g<r;g++){let S=n[g],I=o[g];h=h+I,m[g]=[S,h]}return Ct(m)};return ss({get:()=>ix({buckets:f(),count:s,min:i,max:c,sum:a}),update:p})},dx=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=u(n,Us(We)),a=Array(o),i=0,c=0,p=0,f=Number.MAX_VALUE,m=Number.MIN_VALUE,h=S=>{let I=[],T=0;for(;T!==o-1;){let v=a[T];if(v!=null){let[N,L]=v,W=qo(S-N);_d(W,yd)&&W<=r&&I.push(L)}T=T+1}return qE(t,s,u(Ct(I),Us(We)))},g=(S,I)=>{if(o>0){i=i+1;let T=i%o;a[T]=[I,S]}c=c+1,p=p+S,S<f&&(f=S),S>m&&(m=S)};return ss({get:()=>cx({error:t,quantiles:h(Date.now()),count:c,min:f,max:m,sum:p}),update:([S,I])=>g(S,I)})},qE=(e,t,r)=>{let o=r.length;if(hn(t))return De();let n=Ar(t),s=u(t,So(1)),a=u(s,It(ce(lx(e,o,R(),0,n,r)),(i,c)=>{let p=Ar(i);return u(i,Df(lx(e,o,p.value,p.consumed,c,p.rest)))}));return u(a,bc(i=>[i.quantile,i.value]))},lx=(e,t,r,o,n,s)=>{let a=e,i=t,c=r,p=o,f=n,m=s,h=e,g=t,S=r,I=o,T=n,v=s;for(;;){if(hn(m))return{quantile:f,value:R(),consumed:p,rest:De()};if(f===1)return{quantile:f,value:C(Bf(m)),consumed:p+m.length,rest:De()};let N=u(m,Uf(ne=>ne>Ar(m))),L=f*i,W=a/2*L,D=p+N[0].length,oe=Math.abs(D-L);if(D<L-W){h=a,g=i,S=dn(m),I=D,T=f,v=N[1],a=h,i=g,c=S,p=I,f=T,m=v;continue}if(D>L+W)return{quantile:f,value:c,consumed:p,rest:m};switch(c._tag){case"None":{h=a,g=i,S=dn(m),I=D,T=f,v=N[1],a=h,i=g,c=S,p=I,f=T,m=v;continue}case"Some":{let ne=Math.abs(L-c.value);if(oe<ne){h=a,g=i,S=dn(m),I=D,T=f,v=N[1],a=h,i=g,c=S,p=I,f=T,m=v;continue}return{quantile:f,value:C(c.value),consumed:p,rest:m}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var DE="effect/MetricPair",BE=Symbol.for(DE),UE={_Type:e=>e};var gx=(e,t)=>({[BE]:UE,metricKey:e,metricState:t,pipe(){return x(this,arguments)}});var jE="effect/MetricRegistry",xx=Symbol.for(jE),eu=class{[xx]=xx;map=Td();snapshot(){let t=[];for(let[r,o]of this.map)t.push(gx(r,o.get()));return er(t)}get(t){let r=u(this.map,pr(t),At);if(r==null){if(Dl(t.keyType))return this.getCounter(t);if(Ul(t.keyType))return this.getGauge(t);if(Bl(t.keyType))return this.getFrequency(t);if(Kl(t.keyType))return this.getHistogram(t);if(jl(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return r}getCounter(t){let r=u(this.map,pr(t),At);if(r==null){let o=ux(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getFrequency(t){let r=u(this.map,pr(t),At);if(r==null){let o=fx(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getGauge(t){let r=u(this.map,pr(t),At);if(r==null){let o=mx(t,t.keyType.bigint?BigInt(0):0);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getHistogram(t){let r=u(this.map,pr(t),At);if(r==null){let o=hx(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getSummary(t){let r=u(this.map,pr(t),At);if(r==null){let o=dx(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}},yx=()=>new eu;var zE="effect/Metric",$E=Symbol.for(zE),GE={_Type:e=>e,_In:e=>e,_Out:e=>e},VE=P(Symbol.for("effect/Metric/globalMetricRegistry"),()=>yx()),Sx=function(e,t,r){return Object.assign(n=>Bn(n,s=>k(()=>t(s,me()))),{[$E]:GE,keyType:e,unsafeUpdate:t,unsafeValue:r,register(){return this.unsafeValue(me()),this},pipe(){return x(this,arguments)}})};var as=(e,t)=>bx(Yg(e,t));var bx=e=>{let t=r=>{let o=u(e,Zg(r));return VE.get(o)};return Sx(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var Ox=(e,t,r)=>bx(Qg(e,t,r));var _x=l(3,(e,t,r)=>JE(e,dt(fg(t,r))));var JE=l(2,(e,t)=>{let r=Tm(t)?t:er(t);return Sx(e.keyType,(o,n)=>e.unsafeUpdate(o,u(r,Ae(n))),o=>e.unsafeValue(u(r,Ae(o))))});var QE="effect/Request",ZE=Symbol.for(QE),XE={_E:e=>e,_A:e=>e},Mv={...pn,[ZE]:XE};var Ex=l(2,(e,t)=>$r(Xa,r=>k(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,Da(o.result,t))}})));var mr={Forward:0,Backward:1},ci=class e{self;stack;direction;count=0;constructor(t,r,o){this.self=t,this.stack=r,this.direction=o}clone(){return new e(this.self,this.stack.slice(),this.direction)}reversed(){return new e(this.self,this.stack.slice(),this.direction===mr.Forward?mr.Backward:mr.Forward)}next(){let t=this.entry;switch(this.count++,this.direction===mr.Forward?this.moveNext():this.movePrev(),t._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:t.value}}}get key(){return this.stack.length>0?C(this.stack[this.stack.length-1].key):R()}get value(){return this.stack.length>0?C(this.stack[this.stack.length-1].value):R()}get entry(){return ue(Ds(this.stack),t=>[t.key,t.value])}get index(){let t=0,r=this.stack;if(r.length===0){let o=this.self._root;return o!=null?o.count:0}else r[r.length-1].left!=null&&(t=r[r.length-1].left.count);for(let o=r.length-2;o>=0;--o)r[o+1]===r[o].right&&(++t,r[o].left!=null&&(t+=r[o].left.count));return t}moveNext(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r.right!=null)for(r=r.right;r!=null;)t.push(r),r=r.left;else for(t.pop();t.length>0&&t[t.length-1].right===r;)r=t[t.length-1],t.pop()}get hasNext(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].right!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].left===t[r])return!0;return!1}movePrev(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r!=null&&r.left!=null)for(r=r.left;r!=null;)t.push(r),r=r.right;else for(t.pop();t.length>0&&t[t.length-1].left===r;)r=t[t.length-1],t.pop()}get hasPrev(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].left!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].right===t[r])return!0;return!1}};var A={Red:0,Black:1},ze=class{color;key;value;left;right;count;constructor(t,r,o,n,s,a){this.color=t,this.key=r,this.value=o,this.left=n,this.right=s,this.count=a}};function pt(e){return new ze(e.color,e.key,e.value,e.left,e.right,e.count)}function tu(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}function Dt(e,t){return new ze(t,e.key,e.value,e.left,e.right,e.count)}function J(e){e.count=1+(e.left?.count??0)+(e.right?.count??0)}var Tx="effect/RedBlackTree",ru=Symbol.for(Tx),tT={_Key:e=>e,_Value:e=>e},rT={[ru]:tT,[O](){let e=d(Tx);for(let t of this)e^=u(d(t[0]),_(d(t[1])));return e},[E](e){if(Rx(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((r,o)=>{let n=t[o];return y(r[0],n[0])&&y(r[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;t!=null;)e.push(t),t=t.left;return new ci(this,e,mr.Forward)},toString(){return q(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},is=(e,t)=>{let r=Object.create(rT);return r._ord=e,r._root=t,r},Rx=e=>b(e,ru);var Ax=l(2,(e,t)=>{let r=e._ord,o=e._root;for(;o!==void 0;){let n=r(t,o.key);if(y(t,o.key))return C(o.value);n<=0?o=o.left:o=o.right}return R()});var ou=l(2,(e,t)=>$(Ax(e,t))),Ix=l(3,(e,t,r)=>{let o=e._ord,n=e._root,s=[],a=[];for(;n!=null;){let i=o(t,n.key);s.push(n),a.push(i),i<=0?n=n.left:n=n.right}s.push(new ze(A.Red,t,r,void 0,void 0,1));for(let i=s.length-2;i>=0;--i){let c=s[i];a[i]<=0?s[i]=new ze(c.color,c.key,c.value,s[i+1],c.right,c.count+1):s[i]=new ze(c.color,c.key,c.value,c.left,s[i+1],c.count+1)}for(let i=s.length-1;i>1;--i){let c=s[i-1],p=s[i];if(c.color===A.Black||p.color===A.Black)break;let f=s[i-2];if(f.left===c)if(c.left===p){let m=f.right;if(m&&m.color===A.Red)c.color=A.Black,f.right=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(f.color=A.Red,f.left=c.right,c.color=A.Black,c.right=f,s[i-2]=c,s[i-1]=p,J(f),J(c),i>=3){let h=s[i-3];h.left===f?h.left=c:h.right=c}break}}else{let m=f.right;if(m&&m.color===A.Red)c.color=A.Black,f.right=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(c.right=p.left,f.color=A.Red,f.left=p.right,p.color=A.Black,p.left=c,p.right=f,s[i-2]=p,s[i-1]=c,J(f),J(c),J(p),i>=3){let h=s[i-3];h.left===f?h.left=p:h.right=p}break}}else if(c.right===p){let m=f.left;if(m&&m.color===A.Red)c.color=A.Black,f.left=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(f.color=A.Red,f.right=c.left,c.color=A.Black,c.left=f,s[i-2]=c,s[i-1]=p,J(f),J(c),i>=3){let h=s[i-3];h.right===f?h.right=c:h.left=c}break}}else{let m=f.left;if(m&&m.color===A.Red)c.color=A.Black,f.left=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(c.left=p.right,f.color=A.Red,f.right=p.left,p.color=A.Black,p.right=c,p.left=f,s[i-2]=p,s[i-1]=c,J(f),J(c),J(p),i>=3){let h=s[i-3];h.right===f?h.right=p:h.left=p}break}}}return s[0].color=A.Black,is(e._ord,s[0])}),kx=e=>Cx(e,mr.Forward);var Cx=(e,t)=>{let r=e[Symbol.iterator](),o=0;return{[Symbol.iterator]:()=>Cx(e,t),next:()=>{o++;let n=r.key;switch(t===mr.Forward?r.moveNext():r.movePrev(),n._tag){case"None":return{done:!0,value:o};case"Some":return{done:!1,value:n.value}}}}};var vx=l(2,(e,t)=>{if(!ou(e,t))return e;let r=e._ord,o=r,n=e._root,s=[];for(;n!==void 0;){let c=o(t,n.key);s.push(n),y(t,n.key)?n=void 0:c<=0?n=n.left:n=n.right}if(s.length===0)return e;let a=new Array(s.length),i=s[s.length-1];a[a.length-1]=new ze(i.color,i.key,i.value,i.left,i.right,i.count);for(let c=s.length-2;c>=0;--c)i=s[c],i.left===s[c+1]?a[c]=new ze(i.color,i.key,i.value,a[c+1],i.right,i.count):a[c]=new ze(i.color,i.key,i.value,i.left,a[c+1],i.count);if(i=a[a.length-1],i.left!==void 0&&i.right!==void 0){let c=a.length;for(i=i.left;i.right!=null;)a.push(i),i=i.right;let p=a[c-1];a.push(new ze(i.color,p.key,p.value,i.left,i.right,i.count)),a[c-1].key=i.key,a[c-1].value=i.value;for(let f=a.length-2;f>=c;--f)i=a[f],a[f]=new ze(i.color,i.key,i.value,i.left,a[f+1],i.count);a[c-1].left=a[c]}if(i=a[a.length-1],i.color===A.Red){let c=a[a.length-2];c.left===i?c.left=void 0:c.right===i&&(c.right=void 0),a.pop();for(let p=0;p<a.length;++p)a[p].count--;return is(r,a[0])}else if(i.left!==void 0||i.right!==void 0){i.left!==void 0?tu(i,i.left):i.right!==void 0&&tu(i,i.right),i.color=A.Black;for(let c=0;c<a.length-1;++c)a[c].count--;return is(r,a[0])}else{if(a.length===1)return is(r,void 0);{for(let p=0;p<a.length;++p)a[p].count--;let c=a[a.length-2];oT(a),c.left===i?c.left=void 0:c.right=void 0}}return is(r,a[0])});var oT=e=>{let t,r,o,n;for(let s=e.length-1;s>=0;--s){if(t=e[s],s===0){t.color=A.Black;return}if(r=e[s-1],r.left===t){if(o=r.right,o!==void 0&&o.right!==void 0&&o.right.color===A.Red){if(o=r.right=pt(o),n=o.right=pt(o.right),r.right=o.left,o.left=r,o.right=n,o.color=r.color,t.color=A.Black,r.color=A.Black,n.color=A.Black,J(r),J(o),s>1){let a=e[s-2];a.left===r?a.left=o:a.right=o}e[s-1]=o;return}else if(o!==void 0&&o.left!==void 0&&o.left.color===A.Red){if(o=r.right=pt(o),n=o.left=pt(o.left),r.right=n.left,o.left=n.right,n.left=r,n.right=o,n.color=r.color,r.color=A.Black,o.color=A.Black,t.color=A.Black,J(r),J(o),J(n),s>1){let a=e[s-2];a.left===r?a.left=n:a.right=n}e[s-1]=n;return}if(o!==void 0&&o.color===A.Black)if(r.color===A.Red){r.color=A.Black,r.right=Dt(o,A.Red);return}else{r.right=Dt(o,A.Red);continue}else if(o!==void 0){if(o=pt(o),r.right=o.left,o.left=r,o.color=r.color,r.color=A.Red,J(r),J(o),s>1){let a=e[s-2];a.left===r?a.left=o:a.right=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}else{if(o=r.left,o!==void 0&&o.left!==void 0&&o.left.color===A.Red){if(o=r.left=pt(o),n=o.left=pt(o.left),r.left=o.right,o.right=r,o.left=n,o.color=r.color,t.color=A.Black,r.color=A.Black,n.color=A.Black,J(r),J(o),s>1){let a=e[s-2];a.right===r?a.right=o:a.left=o}e[s-1]=o;return}else if(o!==void 0&&o.right!==void 0&&o.right.color===A.Red){if(o=r.left=pt(o),n=o.right=pt(o.right),r.left=n.right,o.right=n.left,n.right=r,n.left=o,n.color=r.color,r.color=A.Black,o.color=A.Black,t.color=A.Black,J(r),J(o),J(n),s>1){let a=e[s-2];a.right===r?a.right=n:a.left=n}e[s-1]=n;return}if(o!==void 0&&o.color===A.Black)if(r.color===A.Red){r.color=A.Black,r.left=Dt(o,A.Red);return}else{r.left=Dt(o,A.Red);continue}else if(o!==void 0){if(o=pt(o),r.left=o.right,o.right=r,o.color=r.color,r.color=A.Red,J(r),J(o),s>1){let a=e[s-2];a.right===r?a.right=o:a.left=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}}};var wx=ou,Px=Ix,Nx=kx;var Mx=vx;var nu=Symbol.for("effect/SortedSet"),aT={[nu]:{_A:e=>e},[O](){return u(d(this.keyTree),_(d(nu)))},[E](e){return iT(e)&&y(this.keyTree,e.keyTree)},[Symbol.iterator](){return Nx(this.keyTree)},toString(){return q(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},Fx=e=>{let t=Object.create(aT);return t.keyTree=e,t},iT=e=>b(e,nu);var Lx=l(2,(e,t)=>wx(e.keyTree,t)?e:Fx(Px(e.keyTree,t,!0)));var qx=l(2,(e,t)=>Fx(Mx(e.keyTree,t)));var pT="effect/Supervisor",Vo=Symbol.for(pT),cs={_T:e=>e},$o=class e{underlying;value0;[Vo]=cs;constructor(t,r){this.underlying=t,this.value0=r}get value(){return this.value0}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}},Go=class e{left;right;_tag="Zip";[Vo]=cs;constructor(t,r){this.left=t,this.right=r}get value(){return Fa(this.left.value,this.right.value)}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new e(this,t)}},au=e=>b(e,Vo)&&Rs(e,"Zip"),Hx=class{[Vo]=cs;fibers=new Set;get value(){return k(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}onRun(t,r){return t()}},su=class{effect;[Vo]=cs;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}onRun(t,r){return t()}},Dx=class{ref;[Vo]=cs;constructor(t){this.ref=t}get value(){return k(()=>Ue(this.ref))}onStart(t,r,o,n){u(this.ref,xt(u(Ue(this.ref),Lx(n))))}onEnd(t,r){u(this.ref,xt(u(Ue(this.ref),qx(r))))}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};var lT=e=>new su(e),ps=P("effect/Supervisor/none",()=>lT(je));var Ux=Fr;var Kx="Empty",jx="AddSupervisor",Wx="RemoveSupervisor",zx="AndThen",Jo={_tag:Kx},pi=(e,t)=>({_tag:zx,first:e,second:t}),fT=(e,t)=>mT(t,ce(e)),mT=(e,t)=>{let r=e,o=t;for(;nt(o);){let n=st(o);switch(n._tag){case Kx:{o=at(o);break}case jx:{r=r.zip(n.supervisor),o=at(o);break}case Wx:{r=iu(r,n.supervisor),o=at(o);break}case zx:{o=xe(n.first)(xe(n.second)(at(o)));break}}}return r},iu=(e,t)=>y(e,t)?ps:au(e)?iu(e.left,t).zip(iu(e.right,t)):e,li=e=>y(e,ps)?me():au(e)?u(li(e.left),Ae(li(e.right))):dt(e),hT=(e,t)=>{if(y(e,t))return Jo;let r=li(e),o=li(t),n=u(o,Dc(r),Nr(Jo,(a,i)=>pi(a,{_tag:jx,supervisor:i}))),s=u(r,Dc(o),Nr(Jo,(a,i)=>pi(a,{_tag:Wx,supervisor:i})));return pi(n,s)},$x=Ux({empty:Jo,patch:fT,combine:pi,diff:hT});var _T=as("effect_fiber_started"),Gx=as("effect_fiber_active"),ET=as("effect_fiber_successes"),TT=as("effect_fiber_failures"),RT=_x(Ox("effect_fiber_lifetimes",qg({start:1,factor:1.3,count:100})),"time_unit","milliseconds"),ls="Continue",AT="Done",Vx="Yield",IT={_E:e=>e,_A:e=>e},us=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},ui={[fo]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>Ie(Ie(r)),[mo]:(e,t,r)=>t.i2(r),[cn]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Nt(e._runtimeFlags)&&e.isInterrupted()?V(e.getInterruptedCause()):Ie(r)),[ho]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):je)},kT={[ei]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),Nt(t)?V(o.cause):r),[ri]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[ti]:(e,t,r,o)=>(o.onFiber(e,Sl(t)),r),[oi]:(e,t,r,o)=>w(Kn(),()=>r)},CT=e=>zr(lh(e),t=>Qr(mh(t),([r,o])=>{let n=new Map;for(let s of o)for(let a of s)n.set(a.request,a);return ir(BT(r.runAll(o),o.flat()),Xa,n)},!1,!1)),cu=class{[Il]=kl;[vg]=IT;pipe(){return x(this,arguments)}_fiberRefs;_fiberId;_runtimeFlags;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_supervisor;_scheduler;_tracer;currentOpCount=0;isYielding=!1;constructor(t,r,o){if(this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(Zx),this._scheduler=this.getFiberRef(_l),ya(o)){let n=this.getFiberRef(Gn);_T.unsafeUpdate(1,n),Gx.unsafeUpdate(1,n)}this._tracer=kr(this.getFiberRef(Uo),Nn)}id(){return this._fiberId}resume(t){this.tell(Jr(t))}get status(){return this.ask((t,r)=>r)}get runtimeFlags(){return this.ask((t,r)=>Ag(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return Cg(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Vn)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return te(()=>{let r=md(this._fiberId);return this.tell(zo((o,n)=>{Da(r,k(()=>t(o,n)))})),hd(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return jr(t=>{let r=o=>t(H(o));return this.tell(zo((o,n)=>{o._exitValue!==null?r(this._exitValue):o.addObserver(r)})),k(()=>this.tell(zo((o,n)=>{o.removeObserver(r)})))},this.id())}get inheritAll(){return it((t,r)=>{let o=t.id(),n=t.getFiberRefs(),s=r.runtimeFlags,a=this.getFiberRefs(),i=pl(n,o,a);t.setFiberRefs(i);let c=t.getFiberRef(Qx),p=u(kn(s,c),ap(qr),ap(ga));return vp(p)})}get poll(){return k(()=>ft(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return k(()=>this.tell(ni(Mt(t))))}unsafeInterruptAsFork(t){this.tell(ni(Mt(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(r=>r!==t)}getFiberRefs(){return this.setFiberRef(Qx,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=Zn(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Wo(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),this.refreshRefCache()}refreshRefCache(){this._tracer=kr(this.getFiberRef(Uo),Nn),this._supervisor=this.getFiberRef(Zx),this._scheduler=this.getFiberRef(_l)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=ls,o=globalThis[fr];globalThis[fr]=this;try{for(;r===ls;)r=this._queue.length===0?AT:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[fr]=o}this._queue.length>0&&!this._running?(this._running=!0,r===Vx?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this._scheduler.scheduleTask(this.run,this.getFiberRef($n))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=kT[n._tag](this,t,o,n)}return o}isInterrupted(){return!Oh(this.getFiberRef(Vn))}addInterruptedCause(t){let r=this.getFiberRef(Vn);this.setFiberRef(Vn,Ke(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(ni(Mt(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Un({while:()=>!r,body:()=>{let n=t.next();return n.done?k(()=>{r=!0}):ar(n.value.await)},step:()=>{}})}return null}reportExitValue(t){if(ya(this._runtimeFlags)){let r=this.getFiberRef(Gn);switch(Gx.unsafeUpdate(-1,r),t._tag){case Fe:{ET.unsafeUpdate(1,r);break}case Me:{TT.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(ad);!wn(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,ya(this._runtimeFlags)){let r=this.getFiberRef(Gn),o=this.id().startTimeMillis,n=new Date().getTime();RT.unsafeUpdate(n-o,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(MT)}log(t,r,o){let n=$(o)?o.value:this.getFiberRef(Fp),s=this.getFiberRef(vT);if(Xd(s,n))return;let a=this.getFiberRef(rd),i=this.getFiberRef(td),c=this.getLoggers(),p=this.getFiberRefs();if(wr(c)>0){let f=kr(this.getFiberRef(Uo),Qn),m=new Date(f.unsafeCurrentTimeMillis());for(let h of c)h.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:p,spans:a,annotations:i,date:m})}}evaluateMessageWhileSuspended(t){switch(t._tag){case oi:return Vx;case ei:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(V(t.cause)),this._asyncInterruptor=null),ls;case ri:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),ls;case ti:return t.onFiber(this,this._exitValue!==null?Tg:Rg(this._runtimeFlags,this._asyncBlockingOn)),ls;default:return us(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=Nt(this._runtimeFlags)&&this.isInterrupted()?V(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=u(this._runtimeFlags,nh(ga));let s=this.interruptAllChildren();s!==null?r=w(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Jr(n)),r=null)}catch(o){if(Fn(o))o._op===go?oh(this._runtimeFlags)?(this.tell(Ig()),this.tell(Jr(cr)),r=null):r=cr:o._op===uo&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Jr(t));else{this._running=!0;let r=globalThis[fr];globalThis[fr]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[fr]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Jr(t))}patchRuntimeFlags(t,r){let o=Cn(t,r);return globalThis[fr]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Jr(s)))};Nt(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(Ye(St(s)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this._runtimeFlags})}popStack(){let t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==an)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==fo&&t._op!==ho)return t;t=this.popStack()}}[pf](t){return Z(zn(Gr),r=>Zf(r,t))}Left(t){return Se(t.left)}None(t){return Se(new ld)}Right(t){return Ie(t.right)}Some(t){return Ie(t.value)}[ws](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._op in ui||us(o),ui[o._op](this,o,r);throw Ie(r)}[Fe](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._op in ui||us(o),ui[o._op](this,o,r.i0);throw r}[Me](t){let r=t.i0,o=this.getNextFailCont();if(o!==void 0)switch(o._op){case an:case mo:return Nt(this._runtimeFlags)&&this.isInterrupted()?V(fp(r)):o.i1(r);case"OnStep":return Nt(this._runtimeFlags)&&this.isInterrupted()?V(fp(r)):Ie(V(r));case cn:return this.patchRuntimeFlags(this._runtimeFlags,o.patch),Nt(this._runtimeFlags)&&this.isInterrupted()?V(Ke(r,this.getInterruptedCause())):V(r);default:us(o)}else throw V(r)}[Ps](t){return t.i0(this,Sl(this._runtimeFlags))}Blocked(t){let r=this.getFiberRefs(),o=this._runtimeFlags;if(this._steps.length>0){let n=[],s=this._steps[this._steps.length-1],a=this.popStack();for(;a&&a._op!=="OnStep";)n.push(a),a=this.popStack();this.setFiberRefs(s.refs),this._runtimeFlags=s.flags;let i=gg(s.refs,r),c=kn(s.flags,o);return Ie(Ca(t.i0,it(p=>{for(;n.length>0;)p.pushStack(n.pop());return p.setFiberRefs(xg(p.id(),p.getFiberRefs())(i)),p._runtimeFlags=Cn(c)(p._runtimeFlags),t.i1})))}return Fo(n=>w(uu(Op(t.i0)),()=>n(t.i1)))}RunBlocked(t){return CT(t.i0)}[Er](t){let r=t.i0,o=this._runtimeFlags,n=Cn(o,r);if(Nt(n)&&this.isInterrupted())return V(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=kn(n,o);return this.pushStack(new Ra(s,t)),t.i1(o)}else return cr}[fo](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[an](t){return this.pushStack(t),t.i0}[mo](t){return this.pushStack(t),t.i0}[uo](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[go](t){throw this.isYielding=!1,t}[ho](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):cr}[vs](t){return t.commit()}runLoop(t){let r=t;for(this.currentOpCount=0;;){if(this._runtimeFlags&rh&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),!this.isYielding){this.currentOpCount+=1;let o=this._scheduler.shouldYield(this);if(o!==!1){this.isYielding=!0,this.currentOpCount=0;let n=r;r=w(Kn({priority:o}),()=>n)}}try{(!("_op"in r)||!(r._op in this))&&us(r),r=this._tracer.context(()=>yr!==r[hl]._V?Ep(`Cannot execute an Effect versioned ${r[hl]._V} with a Runtime of version ${yr}`):this[r._op](r),this)}catch(o){if(Fn(o)){if(o._op===go||o._op===uo)throw o;if(o._op===Fe||o._op===Me)return o;r=V(St(o))}else Uh(o)?r=V(o.cause):pd(o)?r=V(Ke(St(o),Mt(wt))):r=V(St(o))}}}run=()=>{this.drainQueueOnCurrentThread()}},vT=P("effect/FiberRef/currentMinimumLogLevel",()=>be(eg("Info"))),wT=e=>{let t=Zd(e,Uo);return kr(t,$a).unsafe},PT=P(Symbol.for("effect/Logger/defaultLogger"),()=>ii(e=>{let t=Fg.log(e);wT(e.context).log(t)}));var NT=P(Symbol.for("effect/Logger/tracerLogger"),()=>ii(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let a=un(Xn(r,Gr),bo(Ta)),i=ue(Xn(r,Uo),p=>kr(p,Qn));if(a._tag==="None"||a.value._tag==="ExternalSpan"||i._tag==="None")return;let c=Object.fromEntries(ia(e,p=>ai(p)));c["effect.fiberId"]=Mm(o),c["effect.logLevel"]=n.label,t!==null&&t._tag!=="Empty"&&(c["effect.cause"]=Pn(t)),a.value.event(String(s),i.value.unsafeCurrentTimeNanos(),c)}));var MT=P(Symbol.for("effect/FiberRef/currentLoggers"),()=>Mp(dt(PT,NT)));var Xx=l(e=>Xu(e[0]),(e,t,r)=>it(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(sd);return r?.discard?El(r.concurrency,()=>Yr(Va)(s=>n?Qr(e,(a,i)=>s(t(a,i)),!0,!1,1):zr(e,(a,i)=>s(t(a,i)))),()=>Yr(Ja)(s=>Qr(e,(a,i)=>s(t(a,i)),n,!1)),s=>Yr(Ya(s))(a=>Qr(e,(i,c)=>a(t(i,c)),n,!1,s))):El(r?.concurrency,()=>Yr(Va)(s=>n?Jx(e,1,(a,i)=>s(t(a,i)),!0):ct(e,(a,i)=>s(t(a,i)))),()=>Yr(Ja)(s=>FT(e,(a,i)=>s(t(a,i)),n)),s=>Yr(Ya(s))(a=>Jx(e,s,(i,c)=>a(t(i,c)),n)))})),FT=(e,t,r)=>te(()=>{let o=Te(e),n=new Array(o.length);return jn(Qr(o,(a,i)=>w(t(a,i),c=>k(()=>n[i]=c)),r,!1),H(n))}),Qr=(e,t,r,o,n)=>Fo(s=>Cp(a=>it(i=>{let c=Array.from(e).reverse(),p=c.length;if(p===0)return je;let f=0,m=!1,h=n?Math.min(c.length,n):c.length,g=new Set,S=new Array,I=()=>g.forEach(j=>{j._scheduler.scheduleTask(()=>{j.unsafeInterruptAsFork(i.id())},0)}),T=new Array,v=new Array,N=new Array,L=()=>{let j=S.filter(({exit:re})=>re._tag==="Failure").sort((re,Ce)=>re.index<Ce.index?-1:re.index===Ce.index?0:1).map(({exit:re})=>re);return j.length===0&&j.push(cr),j},W=j=>{let re=Ma(a(j)),Ce=qT(re,i,i._runtimeFlags,Al);return i._scheduler.scheduleTask(()=>{Ce.resume(re)},0),Ce},D=()=>{o||(p-=c.length,c=[]),m=!0,I()},oe=r?Ip:qn,ne=W(jr(j=>{let re=(Ee,Et)=>{Ee._op==="Blocked"?N.push(Ee):(S.push({index:Et,exit:Ee}),Ee._op==="Failure"&&!m&&D())},Ce=()=>{if(c.length>0){let Ee=c.pop(),Et=f++,tn=()=>{let Kt=c.pop();return Et=f++,w(Kn(),()=>w(oe(s(t(Kt,Et))),rn))},rn=Kt=>c.length>0&&(re(Kt,Et),c.length>0)?tn():H(Kt),Yy=w(oe(s(t(Ee,Et))),rn),xr=W(Yy);T.push(xr),g.add(xr),m&&xr._scheduler.scheduleTask(()=>{xr.unsafeInterruptAsFork(i.id())},0),xr.addObserver(Kt=>{let Fi;if(Kt._op==="Failure"?Fi=Kt:Fi=Kt.i0,v.push(xr),g.delete(xr),re(Fi,Et),S.length===p)j(H(G(Lp(L(),{parallel:!0}),()=>cr)));else if(N.length+S.length===p){let Qy=N.map(on=>on.i0).reduce(cp);j(H(Ca(Qy,Qr([G(Lp(L(),{parallel:!0}),()=>cr),...N.map(on=>on.i1)],on=>on,r,!0,n))))}else Ce()})}};for(let Ee=0;Ee<h;Ee++)Ce()}));return ar(Bn(Hn(Na(s(Pg(ne)),()=>(D(),wg(ne)))),()=>ct(v,j=>j.inheritAll)))}))),Jx=(e,t,r,o)=>te(()=>{let n=Te(e),s=new Array(n.length);return jn(Qr(n,(i,c)=>Z(r(i,c),p=>s[c]=p),o,!1,t),H(s))});var uu=e=>HT(e,Al);var LT=(e,t,r,o=null)=>{let n=ey(e,t,r,o);return n.resume(e),n},qT=(e,t,r,o=null)=>ey(e,t,r,o),ey=(e,t,r,o=null)=>{let n=Fm(),s=t.getFiberRefs(),a=ll(s,n),i=new cu(n,a,r),c=jo(a,Gr),p=i._supervisor;return p.onStart(c,e,C(t),i),i.addObserver(m=>p.onEnd(m,i)),(o!==null?o:u(t.getFiberRef(ka),G(()=>t.scope()))).add(r,i),i},HT=(e,t)=>it((r,o)=>H(LT(e,r,o.runtimeFlags,t)));var pu=e=>Vr(t=>se(bo(t,fs),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return w(Ha(r,Ja),o=>fu(e,o))}}})),Yx=e=>t=>Vr(r=>se(bo(r,fs),{onNone:()=>t,onSome:o=>o.strategy._tag==="ParallelN"&&o.strategy.parallelism===e?t:w(Ha(o,Ya(e)),n=>fu(t,n))})),Yr=e=>t=>Vr(r=>se(bo(r,fs),{onNone:()=>t(B),onSome:o=>{let n=e._tag==="Parallel"?pu:e._tag==="Sequential"?lu:Yx(e.parallelism);switch(o.strategy._tag){case"Parallel":return n(t(pu));case"Sequential":return n(t(lu));case"ParallelN":return n(t(Yx(o.strategy.parallelism)))}}}));var lu=e=>Vr(t=>se(bo(t,fs),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return w(Ha(r,Va),o=>fu(e,o))}}}));var fs=Be(id);var fu=l(2,(e,t)=>qp(e,Rc(Qf(fs,t))));var DT=e=>Lo(e,{differ:$x,fork:Jo});var Qx=Xh(sh),Zx=DT(ps);var BT=(e,t)=>Ap(r=>w(w(uu(wa(e)),o=>jr(n=>{let s=t.map(c=>c.listeners.count),a=()=>{s.every(c=>c===0)&&(i.forEach(c=>c()),n(Wh(o)))};o.addObserver(c=>{i.forEach(p=>p()),n(c)});let i=t.map((c,p)=>{let f=m=>{s[p]=m,a()};return c.listeners.addObserver(f),()=>c.listeners.removeObserver(f)});return a(),k(()=>{i.forEach(c=>c())})})),()=>te(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return zr(o,n=>Ex(n.request,ud(r)))})));var mu=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return mu(e,t.from)}},Zr=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Yo=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var hs=Symbol.for("@effect/schema/annotation/Type"),du=Symbol.for("@effect/schema/annotation/Message"),hr=Symbol.for("@effect/schema/annotation/Identifier"),de=Symbol.for("@effect/schema/annotation/Title"),Ze=Symbol.for("@effect/schema/annotation/Description"),oy=Symbol.for("@effect/schema/annotation/Examples"),ny=Symbol.for("@effect/schema/annotation/Default"),hi=Symbol.for("@effect/schema/annotation/JSONSchema"),sy=Symbol.for("@effect/schema/annotation/Documentation"),Qo=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?C(t.annotations[e]):R(),ay=Qo(du),iy=Qo(de),cy=Qo(hr),py=Qo(Ze);var di=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var gi=(e,t={})=>({_tag:"Literal",literal:e,annotations:t}),Xr=e=>e._tag==="Literal";var gu=(e,t={})=>({_tag:"UniqueSymbol",symbol:e,annotations:t}),KT=e=>e._tag==="UniqueSymbol",jT={_tag:"UndefinedKeyword",annotations:{[de]:"undefined"}};var WT={_tag:"VoidKeyword",annotations:{[de]:"void"}};var ds={_tag:"NeverKeyword",annotations:{[de]:"never"}};var ly={_tag:"UnknownKeyword",annotations:{[de]:"unknown"}},zT=e=>e._tag==="UnknownKeyword",xu={_tag:"AnyKeyword",annotations:{[de]:"any"}},$T=e=>e._tag==="AnyKeyword",uy={_tag:"StringKeyword",annotations:{[de]:"string",[Ze]:"a string"}},eo=e=>e._tag==="StringKeyword",fy={_tag:"NumberKeyword",annotations:{[de]:"number",[Ze]:"a number"}},mi=e=>e._tag==="NumberKeyword",GT={_tag:"BooleanKeyword",annotations:{[de]:"boolean",[Ze]:"a boolean"}},ty=e=>e._tag==="BooleanKeyword",VT={_tag:"BigIntKeyword",annotations:{[de]:"bigint",[Ze]:"a bigint"}},ry=e=>e._tag==="BigIntKeyword",JT={_tag:"SymbolKeyword",annotations:{[de]:"symbol",[Ze]:"a symbol"}},hu=e=>e._tag==="SymbolKeyword",YT={_tag:"ObjectKeyword",annotations:{[de]:"object",[Ze]:"an object"}};var xi=(e,t)=>({type:e,isOptional:t}),yi=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var Oe=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),my=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return my(e.from);default:return!1}},hy=(e,t,r)=>{if(my(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},Zo=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let a=e[s].name;if(Object.prototype.hasOwnProperty.call(o,a))throw new Error(`Duplicate property signature ${String(a)}`);o[a]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let a=Ty(t[s].parameter);if(eo(a)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(hu(a)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:ZT(e),indexSignatures:t,annotations:r}};var QT=e=>e.length>1,dr=(e,t={})=>{let r=rR(e);return QT(r)?{_tag:"Union",types:tR(r),annotations:t}:qe(r)?r[0]:ds};var Si=(e,t={})=>({_tag:"Lazy",f:Yo(e),annotations:t});var bi=(e,t,r={})=>gy(e)?yu(e.from,bi(e.to,t,r),e.transformation,e.annotations):{_tag:"Refinement",from:e,filter:t,annotations:r},dy=e=>e._tag==="Refinement",yu=(e,t,r,o={})=>({_tag:"Transform",from:e,to:t,transformation:r,annotations:o}),gy=e=>e._tag==="Transform";var Su=(e,t)=>({_tag:"FinalPropertySignatureTransformation",decode:e,encode:t});var bu=(e,t,r)=>({from:e,to:t,propertySignatureTransformation:r}),xy=e=>{let t={};for(let r of e){let o=r.from;if(t[o])throw new Error(`Duplicate property signature transformation ${String(o)}`);t[o]=!0}return{_tag:"TypeLiteralTransformation",propertySignatureTransformations:e}};var yy=(e,t)=>({...e,annotations:{...e.annotations,...t}});var Sy=e=>e.map(t=>Oe(t.name,he(t.type),t.isOptional,t.isReadonly,t.annotations)),by=e=>e.map(t=>hy(t.parameter,he(t.type),t.isReadonly)),he=e=>{switch(e._tag){case"Declaration":return di(e.typeParameters.map(he),he(e.type),e.decode,e.annotations);case"Tuple":return yi(e.elements.map(t=>xi(he(t.type),t.isOptional)),ue(e.rest,Re(he)),e.isReadonly,e.annotations);case"TypeLiteral":return Zo(Sy(e.propertySignatures),by(e.indexSignatures),e.annotations);case"Union":return dr(e.types.map(he),e.annotations);case"Lazy":return Si(()=>he(e.f()),e.annotations);case"Refinement":return bi(he(e.from),e.filter,e.annotations);case"Transform":return he(e.to)}return e},$e=e=>{switch(e._tag){case"Declaration":return di(e.typeParameters.map($e),$e(e.type),e.decode,e.annotations);case"Tuple":return yi(e.elements.map(t=>xi($e(t.type),t.isOptional)),ue(e.rest,Re($e)),e.isReadonly);case"TypeLiteral":return Zo(e.propertySignatures.map(t=>Oe(t.name,$e(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>hy(t.parameter,$e(t.type),t.isReadonly)));case"Union":return dr(e.types.map($e));case"Lazy":return Si(()=>$e(e.f()));case"Refinement":case"Transform":return $e(e.from)}return e},Oy=e=>{switch(e._tag){case"Declaration":return Oy(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},ZT=Tr(u(We,ln(e=>Oy(e.type)))),_y=_f(We,We,We),XT=rc(_y),Ey=[0,0,0],eR=e=>e.reduce(XT,Ey),ms=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=$(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=ms(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return eR(e.types.map(ms));case"Refinement":{let[t,r,o]=ms(e.from);return[t+1,r,o]}case"Transform":return ms(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return Ey}},tR=Tr(Of(ln(_y,ms))),rR=e=>{let t=u(e,fn(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some($T))return[xu];if(t.some(zT))return[ly];let r;return(r=t.findIndex(eo))!==-1&&(t=t.filter((o,n)=>n===r||!eo(o)&&!(Xr(o)&&typeof o.literal=="string"))),(r=t.findIndex(mi))!==-1&&(t=t.filter((o,n)=>n===r||!mi(o)&&!(Xr(o)&&typeof o.literal=="number"))),(r=t.findIndex(ty))!==-1&&(t=t.filter((o,n)=>n===r||!ty(o)&&!(Xr(o)&&typeof o.literal=="boolean"))),(r=t.findIndex(ry))!==-1&&(t=t.filter((o,n)=>n===r||!ry(o)&&!(Xr(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(hu))!==-1&&(t=t.filter((o,n)=>n===r||!hu(o)&&!KT(o))),t},Ty=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Ty(e.from)}};var Ou=Symbol.for("@effect/schema/TypeId/GreaterThan"),_i=Symbol.for("@effect/schema/TypeId/GreaterThanOrEqualTo"),_u=Symbol.for("@effect/schema/TypeId/LessThan"),Eu=Symbol.for("@effect/schema/TypeId/LessThanOrEqualTo"),Tu=Symbol.for("@effect/schema/TypeId/Int"),Ru=Symbol.for("@effect/schema/TypeId/Between"),Au=Symbol.for("@effect/schema/TypeId/GreaterThanBigint"),Iu=Symbol.for("@effect/schema/TypeId/GreaterThanOrEqualToBigint"),ku=Symbol.for("@effect/schema/TypeId/LessThanBigint"),Cu=Symbol.for("@effect/schema/TypeId/LessThanOrEqualToBigint"),vu=Symbol.for("@effect/schema/TypeId/BetweenBigint"),wu=Symbol.for("@effect/schema/TypeId/MinLength"),Pu=Symbol.for("@effect/schema/TypeId/MaxLength"),Nu=Symbol.for("@effect/schema/TypeId/Length"),Mu=Symbol.for("@effect/schema/TypeId/MinItems"),Fu=Symbol.for("@effect/schema/TypeId/MaxItems"),Lu=Symbol.for("@effect/schema/TypeId/ItemsCount");var bt=Symbol.for("@effect/schema/ArbitraryHookId"),to=Symbol.for("@effect/schema/PrettyHookId"),ro=Symbol.for("@effect/schema/EquivalenceHookId");var Ei=Xx;var gs=te;var Ge=je;var Iy=Z;var oo=Wr;var Xe=w;var Ot=(e,t=[])=>({value:e,forest:t}),vy=e=>oR(Ot("error(s) found",e.map(Ti))),oR=e=>e.value+wy(`
`,e.forest),wy=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let a=s===o-1;r+=e+(a?"\u2514":"\u251C")+"\u2500 "+n.value,r+=wy(e+(o>1&&!a?"\u2502  ":"   "),n.forest)}return r},ys=e=>{if(Sr(e))return JSON.stringify(e);if(Y(e)||e==null||Ts(e)||ao(e)||As(e))return String(e);if(tt(e))return String(e)+"n";if(!Array.isArray(e)&&b(e,"toString")&&Tt(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();try{return JSON.stringify(e)}catch{return String(e)}},nR=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},sR=e=>e.head+e.spans.map(t=>nR(t)+t.literal).join(""),lt=e=>cy(e).pipe(xo(()=>iy(e)),xo(()=>py(e))),xs=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return G(lt(e),()=>e._tag);case"Literal":return G(lt(e),()=>ys(e.literal));case"UniqueSymbol":return G(lt(e),()=>ys(e.symbol));case"Union":return[...new Set(e.types.map(xs))].join(" or ");case"TemplateLiteral":return G(lt(e),()=>sR(e));case"Tuple":return G(lt(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return G(lt(e),()=>"<anonymous type literal schema>");case"Enums":return G(lt(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return G(lt(e),()=>"<anonymous lazy schema>");case"Declaration":return G(lt(e),()=>"<anonymous declaration schema>");case"Refinement":return G(lt(e),()=>"<anonymous refinement schema>");case"Transform":return G(lt(e),()=>`${xs(e.from)} <-> ${xs(e.to)}`)}},Cy=(e,t)=>e.length===1&&e[0].forest.length!==0&&t[0]._tag!=="UnionMember",aR=e=>ay(e.expected).pipe(ue(t=>t(e.actual)),xo(()=>e.message),G(()=>`Expected ${xs(e.expected)}, actual ${ys(e.actual)}`)),Ti=e=>{switch(e._tag){case"Type":return Ot(aR(e));case"Forbidden":return Ot("is forbidden");case"Index":{let t=e.errors.map(Ti);return Cy(t,e.errors)?Ot(`[${e.index}]${t[0].value}`,t[0].forest):Ot(`[${e.index}]`,t)}case"Unexpected":return Ot("is unexpected"+($(e.ast)?`, expected ${xs(e.ast.value)}`:""));case"Key":{let t=e.errors.map(Ti);return Cy(t,e.errors)?Ot(`[${ys(e.key)}]${t[0].value}`,t[0].forest):Ot(`[${ys(e.key)}]`,t)}case"Missing":return Ot("is missing");case"UnionMember":return Ot("union member",e.errors.map(Ti))}};var qu=class{errors;_tag="ParseError";constructor(t){this.errors=t}toString(){return vy(this.errors)}toJSON(){return{_id:"ParseError",message:this.toString()}}[M](){return this.toJSON()}},Ri=e=>new qu(e),we=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:ft(r)}),Py={_tag:"Forbidden"},Bt=(e,t)=>({_tag:"Index",index:e,errors:t}),Ut=(e,t)=>({_tag:"Key",key:e,errors:t}),Ai={_tag:"Missing"},Hu=e=>({_tag:"Unexpected",ast:e}),Du=e=>({_tag:"UnionMember",errors:e}),ke=ie;var U=e=>{let t=e;return"_tag"in t?t._tag==="ParseError"?pe(t):pe(Ri([t])):pe(Ri(t))},_t=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},Ss=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):Xe(e,t)},Ii=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?ie(t(r.right)):Iy(e,t)};var cR=(e,t)=>ge(e,t);var My=(e,t)=>{let r=ge(e,t);return(o,n)=>r(o,{...n,isEffectAllowed:!0})};var Bu=e=>cR(e.ast,!0);var Uu=e=>My(e.ast,!0);var Ku=e=>My(e.ast,!1),bs={},pR=P(Symbol.for("@effect/schema/Parser/decodeMemoMap"),()=>new WeakMap),lR=P(Symbol.for("@effect/schema/Parser/encodeMemoMap"),()=>new WeakMap),ge=(e,t)=>{let r=t?pR:lR,o=r.get(e);if(o)return o;let n=uR(e,t);return r.set(e,n),n},uR=(e,t)=>{switch(e._tag){case"Refinement":if(t){let r=ge(e.from,!0);return(o,n)=>ki(Ss(r(o,n),s=>se(e.filter(s,n??bs,e),{onNone:()=>ke(s),onSome:U})),n)}else{let r=ge(he(e),!0),o=ge(Fy(e.from),!1);return(n,s)=>ki(Ss(r(n,s),a=>o(a,s)),s)}case"Transform":{let r=dR(e.transformation,t),o=t?ge(e.from,!0):ge(e.to,!1),n=t?ge(e.to,!0):ge(e.from,!1);return(s,a)=>ki(Ss(o(s,a),i=>Ss(r(i,a??bs,e),c=>n(c,a))),a)}case"Declaration":{let r=e.decode(t,...e.typeParameters);return(o,n)=>ki(r(o,n??bs,e),n)}case"Literal":return Pe(e,r=>r===e.literal);case"UniqueSymbol":return Pe(e,r=>r===e.symbol);case"UndefinedKeyword":return Pe(e,Bi);case"VoidKeyword":return Pe(e,Bi);case"NeverKeyword":return Pe(e,Ju);case"UnknownKeyword":case"AnyKeyword":return ke;case"StringKeyword":return Pe(e,Sr);case"NumberKeyword":return Pe(e,Y);case"BooleanKeyword":return Pe(e,Ts);case"BigIntKeyword":return Pe(e,tt);case"SymbolKeyword":return Pe(e,ao);case"ObjectKeyword":return Pe(e,io);case"Enums":return Pe(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=mR(e);return Pe(e,o=>Sr(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>ge(s.type,t)),o=ue(e.rest,Re(s=>ge(s,t))),n=e.elements.filter(s=>!s.isOptional).length;return $(e.rest)&&(n+=e.rest.value.length-1),(s,a)=>{if(!Array.isArray(s))return U(we(e,s));let i=a?.errors==="all",c=[],p=0,f=s.length;for(let I=f;I<=n-1;I++){let T=Bt(I,[Ai]);if(i){c.push([p++,T]);continue}else return U(T)}if(z(e.rest))for(let I=e.elements.length;I<=f-1;I++){let T=Bt(I,[Hu(R())]);if(i){c.push([p++,T]);continue}else return U(et(_e(c),T))}let m=[],h=0,g;for(;h<r.length;h++)if(f<h+1){if(e.elements[h].isOptional)continue}else{let I=r[h],T=I(s[h],a),v=_t(T);if(v){if(ae(v)){let N=Bt(h,v.left.errors);if(i){c.push([p++,N]);continue}else return U(et(_e(c),N))}m.push([p++,v.right])}else{let N=p++,L=h;g||(g=[]),g.push(({es:W,output:D})=>Xe(oo(T),oe=>{if(ae(oe)){let ne=Bt(L,oe.left.errors);return i?(W.push([N,ne]),Ge):U(et(_e(W),ne))}return D.push([N,oe.right]),Ge}))}}if($(o)){let[I,...T]=o.value;for(;h<f-T.length;h++){let v=I(s[h],a),N=_t(v);if(N)if(ae(N)){let L=Bt(h,N.left.errors);if(i){c.push([p++,L]);continue}else return U(et(_e(c),L))}else m.push([p++,N.right]);else{let L=p++,W=h;g||(g=[]),g.push(({es:D,output:oe})=>Xe(oo(v),ne=>{if(ae(ne)){let j=Bt(W,ne.left.errors);return i?(D.push([L,j]),Ge):U(et(_e(D),j))}else return oe.push([L,ne.right]),Ge}))}}for(let v=0;v<T.length;v++)if(h+=v,!(f<h+1)){let N=T[v](s[h],a),L=_t(N);if(L){if(ae(L)){let W=Bt(h,L.left.errors);if(i){c.push([p++,W]);continue}else return U(et(_e(c),W))}m.push([p++,L.right])}else{let W=p++,D=h;g||(g=[]),g.push(({es:oe,output:ne})=>Xe(oo(N),j=>{if(ae(j)){let re=Bt(D,j.left.errors);return i?(oe.push([W,re]),Ge):U(et(_e(oe),re))}return ne.push([W,j.right]),Ge}))}}}let S=({es:I,output:T})=>qs(I)?U(_e(I)):ke(_e(T));if(g&&g.length>0){let I=g;return gs(()=>{let T={es:Array.from(c),output:Array.from(m)};return Xe(Ei(I,v=>v(T),{concurrency:"unbounded",discard:!0}),()=>S(T))})}return S({output:m,es:c})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Pe(e,Qu);let r=[],o={};for(let i of e.propertySignatures)r.push(ge(i.type,t)),o[i.name]=null;let n=e.indexSignatures.map(i=>[ge(i.parameter,t),ge(i.type,t)]),s=dr(e.indexSignatures.map(i=>i.parameter).concat(Zr(o).map(i=>ao(i)?gu(i):gi(i)))),a=ge(s,t);return(i,c)=>{if(!Ui(i))return U(we(e,i));let p=c?.errors==="all",f=[],m=0;if(c?.onExcessProperty==="error")for(let T of Zr(i)){let v=_t(a(T,c));if(v&&ae(v)){let N=Ut(T,[Hu(C(s))]);if(p){f.push([m++,N]);continue}else return U(et(_e(f),N))}}let g={},S;for(let T=0;T<r.length;T++){let v=e.propertySignatures[T],N=r[T],L=v.name;if(Object.prototype.hasOwnProperty.call(i,L)){let W=N(i[L],c),D=_t(W);if(D){if(ae(D)){let oe=Ut(L,D.left.errors);if(p){f.push([m++,oe]);continue}else return U(et(_e(f),oe))}g[L]=D.right}else{let oe=m++,ne=L;S||(S=[]),S.push(({es:j,output:re})=>Xe(oo(W),Ce=>{if(ae(Ce)){let Ee=Ut(ne,Ce.left.errors);return p?(j.push([oe,Ee]),Ge):U(et(_e(j),Ee))}return re[ne]=Ce.right,Ge}))}}else if(!v.isOptional){let W=Ut(L,[Ai]);if(p){f.push([m++,W]);continue}else return U(W)}}for(let T=0;T<n.length;T++){let v=n[T],N=v[0],L=v[1],W=mu(i,e.indexSignatures[T].parameter);for(let D of W){let oe=_t(N(D,c));if(oe&&Le(oe)){let ne=L(i[D],c),j=_t(ne);if(j)if(ae(j)){let re=Ut(D,j.left.errors);if(p){f.push([m++,re]);continue}else return U(et(_e(f),re))}else Object.prototype.hasOwnProperty.call(o,D)||(g[D]=j.right);else{let re=m++,Ce=D;S||(S=[]),S.push(({es:Ee,output:Et})=>Xe(oo(ne),tn=>{if(ae(tn)){let rn=Ut(Ce,tn.left.errors);return p?(Ee.push([re,rn]),Ge):U(et(_e(Ee),rn))}else return Object.prototype.hasOwnProperty.call(o,D)||(Et[D]=tn.right),Ge}))}}}}let I=({es:T,output:v})=>qs(T)?U(_e(T)):ke(v);if(S&&S.length>0){let T=S;return gs(()=>{let v={es:Array.from(f),output:Object.assign({},g)};return Xe(Ei(T,N=>N(v),{concurrency:"unbounded",discard:!0}),()=>I(v))})}return I({es:f,output:g})}}case"Union":{let r=fR(e.types,t),o=Zr(r.keys),n=o.length,s=new Map;for(let a=0;a<e.types.length;a++)s.set(e.types[a],ge(e.types[a],t));return(a,i)=>{let c=[],p=0,f=[];if(n>0)if(Ui(a))for(let g=0;g<n;g++){let S=o[g],I=r.keys[S].buckets;if(Object.prototype.hasOwnProperty.call(a,S)){let T=String(a[S]);Object.prototype.hasOwnProperty.call(I,T)?f=f.concat(I[T]):c.push([p++,Ut(S,[we(r.keys[S].ast,a[S])])])}else c.push([p++,Ut(S,[Ai])])}else c.push([p++,we(e,a)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let m;for(let g=0;g<f.length;g++){let S=s.get(f[g])(a,i),I=!m||m.length===0?_t(S):void 0;if(I){if(Le(I))return ke(I.right);c.push([p++,Du(I.left.errors)])}else{let T=p++;m||(m=[]),m.push(v=>gs(()=>"finalResult"in v?Ge:Xe(oo(S),N=>(Le(N)?v.finalResult=ke(N.right):v.es.push([T,Du(N.left.errors)]),Ge))))}}let h=g=>qs(g)?U(_e(g)):U(we(ds,a));if(m&&m.length>0){let g=m;return gs(()=>{let S={es:Array.from(c)};return Xe(Ei(g,I=>I(S),{concurrency:1,discard:!0}),()=>"finalResult"in S?S.finalResult:h(S.es))})}return h(c)}}case"Lazy":{let r=Yo(()=>ge(e.f(),t));return(o,n)=>r()(o,n)}}},Pe=(e,t)=>r=>t(r)?ke(r):U(we(e,r)),Ci=(e,t)=>{switch(e._tag){case"Declaration":return Ci(e.type,t);case"TypeLiteral":{let r=[];for(let o=0;o<e.propertySignatures.length;o++){let n=e.propertySignatures[o],s=t?$e(n.type):he(n.type);Xr(s)&&!n.isOptional&&r.push([n.name,s])}return r}case"Refinement":return Ci(e.from,t);case"Transform":return Ci(t?e.from:e.to,t)}return[]},fR=(e,t)=>{let r={},o=[];for(let n=0;n<e.length;n++){let s=e[n],a=Ci(s,t);if(a.length>0)for(let i=0;i<a.length;i++){let[c,p]=a[i],f=String(p.literal);r[c]=r[c]||{buckets:{},ast:ds};let m=r[c].buckets;if(Object.prototype.hasOwnProperty.call(m,f)){if(i<a.length-1)continue;m[f].push(s),r[c].ast=dr([r[c].ast,p])}else{m[f]=[s],r[c].ast=dr([r[c].ast,p]);break}}else o.push(s)}return{keys:r,otherwise:o}},Fy=e=>dy(e)?Fy(e.from):e,ki=(e,t)=>{let r=_t(e);return r||(t?.isEffectAllowed===!0?e:U(Py))},et=(e,t)=>(e.push(t),e),mR=e=>{let t=`^${e.head}`;for(let r of e.spans)eo(r.type)?t+=".*":mi(r.type)&&(t+="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function _e(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var hR=(e,t)=>{switch(e._tag){case"FinalPropertySignatureTransformation":return t?e.decode:e.encode}},dR=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return ke;case"TypeLiteralTransformation":return r=>{let o=ie(r);for(let n of e.propertySignatureTransformations){let[s,a]=t?[n.from,n.to]:[n.to,n.from],i=hR(n.propertySignatureTransformation,t);o=Ii(o,p=>{let f=i(Object.prototype.hasOwnProperty.call(p,s)?C(p[s]):R());return delete p[s],$(f)&&(p[a]=f.value),p})}return o}}};var gR=bt,qy=e=>ut(e.ast,{});var Wu=1,xR=(e,t,r,o)=>(o.isLazy?e.oneof({depthSize:Wu},e.constant([]),e.array(e.tuple(t,r),{minLength:1,maxLength:2})):e.array(e.tuple(t,r))).map(n=>{let s={};for(let[a,i]of n)s[a]=i;return s}),ju=Qo(gR),ut=(e,t)=>{switch(e._tag){case"Declaration":return u(ju(e),se({onNone:()=>ut(e.type,t),onSome:r=>r(...e.typeParameters.map(o=>ut(o,t)))}));case"Literal":return r=>r.constant(e.literal);case"UniqueSymbol":return r=>r.constant(e.symbol);case"UndefinedKeyword":return r=>r.constant(void 0);case"VoidKeyword":return r=>r.constant(void 0);case"NeverKeyword":return()=>{throw new Error("cannot build an Arbitrary for `never`")};case"UnknownKeyword":case"AnyKeyword":return r=>r.anything();case"StringKeyword":return r=>{if(t.constraints)switch(t.constraints._tag){case"StringConstraints":return r.string(t.constraints.constraints)}return r.string()};case"NumberKeyword":return r=>{if(t.constraints)switch(t.constraints._tag){case"NumberConstraints":return r.float(t.constraints.constraints);case"IntegerConstraints":return r.integer(t.constraints.constraints)}return r.float()};case"BooleanKeyword":return r=>r.boolean();case"BigIntKeyword":return r=>{if(t.constraints)switch(t.constraints._tag){case"BigIntConstraints":return r.bigInt(t.constraints.constraints)}return r.bigInt()};case"SymbolKeyword":return r=>r.string().map(o=>Symbol.for(o));case"ObjectKeyword":return r=>r.oneof(r.object(),r.array(r.anything()));case"TemplateLiteral":return r=>{let o=r.string({maxLength:5}),n=r.float({noDefaultInfinity:!0}).filter(a=>!Number.isNaN(a)),s=[r.constant(e.head)];for(let a of e.spans)eo(a.type)?s.push(o):s.push(n),s.push(r.constant(a.literal));return r.tuple(...s).map(a=>a.join(""))};case"Tuple":{let r=[],o=!1;for(let s of e.elements)r.push(ut(s.type,t)),s.isOptional&&(o=!0);let n=ue(e.rest,Re(s=>ut(s,t)));return s=>{let a=s.tuple(...r.map(i=>i(s)));if(o){let i=s.tuple(...e.elements.map(c=>c.isOptional?s.boolean():s.constant(!0)));a=a.chain(c=>i.map(p=>{for(let[f,m]of p.reverse().entries())m||c.splice(p.length-f,1);return c}))}if($(n)){let[i,...c]=n.value,p=i(s),f=t.constraints;a=a.chain(m=>{let h=s.array(p);return t.isLazy?h=s.oneof({depthSize:Wu},s.constant([]),s.array(p,{minLength:1,maxLength:2})):f&&f._tag==="ArrayConstraints"&&(h=s.array(p,f.constraints)),h.map(g=>[...m,...g])});for(let m=0;m<c.length;m++)a=a.chain(h=>c[m](s).map(g=>[...h,g]))}return a}}case"TypeLiteral":{let r=e.propertySignatures.map(n=>ut(n.type,t)),o=e.indexSignatures.map(n=>[ut(n.parameter,t),ut(n.type,t)]);return n=>{let s={},a=[];for(let c=0;c<r.length;c++){let p=e.propertySignatures[c],f=p.name;p.isOptional||a.push(f),s[f]=r[c](n)}let i=n.record(s,{requiredKeys:a});for(let c=0;c<o.length;c++){let p=o[c][0](n),f=o[c][1](n);i=i.chain(m=>xR(n,p,f,t).map(h=>({...h,...m})))}return i}}case"Union":{let r=e.types.map(o=>ut(o,t));return o=>o.oneof({depthSize:Wu},...r.map(n=>n(o)))}case"Enums":{if(e.enums.length===0)throw new Error("cannot build an Arbitrary for an empty enum");return r=>r.oneof(...e.enums.map(([o,n])=>r.constant(n)))}case"Refinement":{let r=SR(t.constraints,yR(e)),o=ut(e.from,r?{...t,constraints:r}:t);return u(ju(e),se({onNone:()=>n=>o(n).filter(s=>z(e.filter(s,bs,e))),onSome:n=>n(o)}))}case"Lazy":return u(ju(e),se({onNone:()=>{let r=Yo(()=>ut(e.f(),{...t,isLazy:!0}));return o=>o.constant(null).chain(()=>r()(o))},onSome:r=>r()}));case"Transform":throw new Error("cannot build an Arbitrary for transformations")}},vi=e=>(Y(e.min)&&(e.min=Math.fround(e.min)),Y(e.max)&&(e.max=Math.fround(e.max)),{_tag:"NumberConstraints",constraints:e}),wi=e=>({_tag:"StringConstraints",constraints:e}),zu=e=>({_tag:"IntegerConstraints",constraints:e}),Pi=e=>({_tag:"ArrayConstraints",constraints:e}),Ni=e=>({_tag:"BigIntConstraints",constraints:e}),yR=e=>{let t=e.annotations[hs],r=e.annotations[hi];switch(t){case Ou:case _i:return vi({min:r.exclusiveMinimum??r.minimum});case _u:case Eu:return vi({max:r.exclusiveMaximum??r.maximum});case Tu:return zu({});case Ru:{let o=r.minimum,n=r.maximum,s={};return Y(o)&&(s.min=o),Y(n)&&(s.max=n),vi(s)}case Au:case Iu:{let o=e.annotations[t];return Ni({min:o.min})}case ku:case Cu:{let o=e.annotations[t];return Ni({max:o.max})}case vu:{let o=e.annotations[t],n=o.min,s=o.max,a={};return tt(n)&&(a.min=n),tt(s)&&(a.max=s),Ni(a)}case wu:return wi({minLength:r.minLength});case Pu:return wi({maxLength:r.maxLength});case Nu:return wi({minLength:r.minLength,maxLength:r.maxLength});case Mu:return Pi({minLength:r.minItems});case Fu:return Pi({maxLength:r.maxItems});case Lu:return Pi({minLength:r.minItems,maxLength:r.maxItems})}},SR=(e,t)=>{if(e===void 0)return t;if(t===void 0)return e;switch(e._tag){case"ArrayConstraints":{switch(t._tag){case"ArrayConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.minLength,t.constraints.minLength);Y(o)&&(r.minLength=o);let n=en(e.constraints.maxLength,t.constraints.maxLength);return Y(n)&&(r.maxLength=n),Pi(r)}}break}case"NumberConstraints":{switch(t._tag){case"NumberConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.min,t.constraints.min);Y(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return Y(n)&&(r.max=n),vi(r)}case"IntegerConstraints":{let r={...t.constraints},o=Xo(e.constraints.min,t.constraints.min);Y(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return Y(n)&&(r.max=n),zu(r)}}break}case"BigIntConstraints":{switch(t._tag){case"BigIntConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.min,t.constraints.min);tt(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return tt(n)&&(r.max=n),Ni(r)}}break}case"StringConstraints":{switch(t._tag){case"StringConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.minLength,t.constraints.minLength);Y(o)&&(r.minLength=o);let n=en(e.constraints.maxLength,t.constraints.maxLength);return Y(n)&&(r.maxLength=n),wi(r)}}break}case"IntegerConstraints":{switch(t._tag){case"NumberConstraints":case"IntegerConstraints":{let r={...e.constraints},o=Xo(e.constraints.min,t.constraints.min);Y(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return Y(n)&&(r.max=n),zu(r)}}break}}};function Xo(e,t){return e===void 0?t:t===void 0?e:e<=t?t:e}function en(e,t){return e===void 0?t:t===void 0||e<=t?e:t}var $u=Symbol.for("@effect/schema/Schema");var OR={From:e=>e,To:e=>e},Hy=class{ast;[$u]=OR;constructor(t){this.ast=t}pipe(){return x(this,arguments)}};var Ky=$u;var jy={From:e=>e,To:e=>e},Gu=class{ast;[Ky]=jy;constructor(t){this.ast=t}pipe(){return x(this,arguments)}},Ne=e=>new Gu(e),IR=e=>Ne(gi(e)),Dy=(...e)=>zy(...e.map(t=>IR(t)));var Os=(e,t,r,o)=>Ne(di(e.map(n=>n.ast),t.ast,(n,...s)=>r(n,...s.map(Ne)),o));var kR=Ne(xu),Wy=Ne(uy),Vu=Ne(fy);var zy=(...e)=>Ne(dr(e.map(t=>t.ast)));var CR=(...e)=>Ne(yi(e.map(t=>xi(t.ast,!1)),R(),!0));var By=class e{config;[Ky]=jy;FromIsOptional;ToIsOptional;constructor(t){this.config=t}withDefault(t){return new e({_tag:"Default",ast:this.config.ast,value:t,annotations:this.config.annotations})}toOption(){return new e({_tag:"Option",ast:this.config.ast,annotations:this.config.annotations})}};var gr=e=>{let t=Zr(e),r=[],o=[],n=[],s=[];for(let a=0;a<t.length;a++){let i=t[a],c=e[i];if("config"in c){let p=c.config,f=p.ast,m=he(f),h=p.annotations;switch(p._tag){case"PropertySignature":r.push(Oe(i,f,!1,!0,h)),o.push(Oe(i,f,!1,!0)),n.push(Oe(i,m,!1,!0,h));break;case"Optional":r.push(Oe(i,f,!0,!0,h)),o.push(Oe(i,f,!0,!0)),n.push(Oe(i,m,!0,!0,h));break;case"Default":o.push(Oe(i,f,!0,!0)),n.push(Oe(i,m,!1,!0,h)),s.push(bu(i,i,Su(xo(()=>C(p.value())),B)));break;case"Option":o.push(Oe(i,f,!0,!0)),n.push(Oe(i,UR(Ne(m)).ast,!1,!0,h)),s.push(bu(i,i,Su(C,Tf)));break}}else r.push(Oe(i,c.ast,!1,!0)),o.push(Oe(i,c.ast,!1,!0)),n.push(Oe(i,he(c.ast),!1,!0))}return qe(s)?Ne(yu(Zo(o,[]),Zo(n,[]),xy(s))):Ne(Zo(r,[]))};var vR=(e,t)=>Ne(Si(()=>e().ast,t));function wR(e,t){return r=>Ne(bi(r.ast,(o,n,s)=>e(o)?R():C(Ri([we(s,o)])),PR(t)))}var PR=e=>{if(!e)return{};let t={},r=Object.getOwnPropertySymbols(e);for(let n of r)t[n]=e[n];if(e.typeId!==void 0){let n=e.typeId;typeof n=="object"?(t[hs]=n.id,t[n.id]=n.params):t[hs]=n}let o=(n,s)=>{e[n]!==void 0&&(t[s]=e[n])};return o("message",du),o("identifier",hr),o("title",de),o("description",Ze),o("examples",oy),o("default",ny),o("documentation",sy),o("jsonSchema",hi),o("arbitrary",bt),o("pretty",to),o("equivalence",ro),t},Mi=e=>t=>Ne(yy(t.ast,e));var NR=_i,MR=(e,t)=>r=>r.pipe(wR(o=>o>=e,{typeId:NR,description:e===0?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t}));var FR=e=>MR(0,e);var Uy=Vu.pipe(FR());var N0=Os([],gr({}),()=>(e,t,r)=>Ua(e)?ke(e):U(we(r,e)),{[hr]:"Duration",[to]:()=>bd({onMillis:e=>`Duration.millis(${e})`,onNanos:e=>`Duration.nanos(${e})`}),[bt]:()=>e=>e.oneof(e.bigUint().map(t=>Yn(t)),e.bigUint().map(t=>Bp(t)),e.maxSafeNat().map(t=>qo(t)),e.maxSafeNat().map(t=>Up(t)),e.maxSafeNat().map(t=>Kp(t)),e.maxSafeNat().map(t=>jp(t)),e.maxSafeNat().map(t=>Wp(t)),e.maxSafeNat().map(t=>zp(t))),[ro]:()=>$p});var M0=CR(Uy.pipe(Mi({[de]:"seconds",[Ze]:"seconds"})),Uy.pipe(Mi({[de]:"nanos",[Ze]:"nanos"}))).pipe(Mi({[de]:"a high resolution time tuple",[Ze]:"a high resolution time tuple"}));var F0=Os([],gr({}),()=>(e,t,r)=>Zu(e)?ke(e):U(we(r,e)),{[hr]:"Uint8Array",[to]:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,[bt]:()=>e=>e.uint8Array(),[ro]:()=>Bs(Wi())});var LR=()=>e=>e.date({noInvalidDate:!1}),qR=()=>e=>`new Date(${JSON.stringify(e)})`,L0=Os([],gr({}),()=>(e,t,r)=>As(e)?ke(e):U(we(r,e)),{[hr]:"Date",[to]:qR,[bt]:LR,[ro]:()=>af});var $y=e=>zy(gr({_tag:Dy("None")}),gr({_tag:Dy("Some"),value:e})),HR=e=>e._tag==="None"?R():C(e.value),DR=e=>{let t=vR(()=>kR).pipe(Mi({[bt]:()=>e})),r=qy($y(t));return o=>r(o).map(HR)},BR=e=>se({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),UR=e=>Os([e],$y(e),(t,r)=>{let o=t?Uu(r):Ku(r);return(n,s,a)=>Ef(n)?z(n)?ke(R()):Ii(o(n.value,s),C):U(we(a,n))},{[hr]:"Option",[to]:BR,[bt]:DR,[ro]:Rf});var KR=()=>e=>`BigDecimal(${pc(ic(e))})`,jR=()=>e=>e.tuple(e.bigInt(),e.integer()).map(([t,r])=>yo(t,r)),q0=Os([],gr({}),()=>(e,t,r)=>sc(e)?ke(e):U(we(r,e)),{[hr]:"BigDecimal",[to]:KR,[bt]:jR,[ro]:()=>cc});var zR=gr({name:Wy,age:Vu}),Jy=Bu(zR),$R={name:"Alice",age:30},Gy=Jy($R);Le(Gy)&&console.log(Gy.right);var Vy=Jy(null);ae(Vy)&&console.log(Vy.left);
