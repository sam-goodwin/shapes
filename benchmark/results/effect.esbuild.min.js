var qi=e=>typeof e=="function",l=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(a){return t(a,r,o,n)}};case 5:return function(r,o,n,s,a){return arguments.length>=5?t(r,o,n,s,a):function(i){return t(i,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var B=e=>e;var nn=e=>()=>e,Es=nn(!0),no=nn(!1);var Ts=nn(void 0),Hi=Ts;function u(e,t,r,o,n,s,a,i,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return a(s(n(o(r(t(e))))));case 8:return i(a(s(n(o(r(t(e)))))));case 9:return c(i(a(s(n(o(r(t(e))))))));default:{let p=arguments[0];for(let f=1;f<arguments.length;f++)p=arguments[f](p);return p}}}var xr="2.0.0-next.58";var Bi=Symbol.for(`effect/GlobalValue/globalStoreId/${xr}`);Bi in globalThis||(globalThis[Bi]=new Map);var Di=globalThis[Bi],P=(e,t)=>(Di.has(e)||Di.set(e,t()),Di.get(e));var yr=e=>typeof e=="string",Y=e=>typeof e=="number",Rs=e=>typeof e=="boolean",et=e=>typeof e=="bigint",ao=e=>typeof e=="symbol",Tt=qi,Ui=e=>e===void 0;var Vu=e=>!1;var Ju=e=>typeof e=="object"&&e!==null,io=e=>Ju(e)||Tt(e),b=l(2,(e,t)=>io(e)&&t in e),As=l(2,(e,t)=>b(e,"_tag")&&e._tag===t),Sr=e=>e==null,Yu=e=>e!=null;var Qu=e=>e instanceof Uint8Array,Is=e=>e instanceof Date,Zu=e=>b(e,Symbol.iterator),Ki=e=>Ju(e)&&!Array.isArray(e);var Xu=e=>b(e,"then")&&"catch"in e&&Tt(e.then)&&Tt(e.catch);var ef=Symbol.for("effect/Gen/GenKind"),tf=class{value;constructor(t){this.value=t}get _F(){return B}get _R(){return t=>t}get _O(){return t=>t}get _E(){return t=>t}[ef]=ef;[Symbol.iterator](){return new ji(this)}},ji=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Vy=335903614,Jy=4150755663,Yy=1481765933,Qy=1284865837,Zy=9007199254740992,Xy=134217728,co=class{_state;constructor(t,r,o,n){return Sr(r)&&Sr(t)?(r=Math.random()*4294967295>>>0,t=0):Sr(r)&&(r=t,t=0),Sr(n)&&Sr(o)?(n=this._state?this._state[3]:Jy,o=this._state?this._state[2]:Vy):Sr(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),rf(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*Xy+r)/Zy}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;eS(this._state,t,r,Yy,Qy),rf(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,a=t>>>27,i=(-a>>>0&31)>>>0;return(s>>>a|s<<i)>>>0}};function eS(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,a=(r&65535)*(n>>>16)>>>0,i=(r&65535)*(n&65535)>>>0,c=(r>>>16)*(n>>>16)+((a>>>16)+(s>>>16))>>>0;a=a<<16>>>0,i=i+a>>>0,i>>>0<a>>>0&&(c=c+1>>>0),s=s<<16>>>0,i=i+s>>>0,i>>>0<s>>>0&&(c=c+1>>>0),c=c+Math.imul(r,o)>>>0,c=c+Math.imul(t,n)>>>0,e[0]=c,e[1]=i}function rf(e,t,r,o,n){let s=t+o>>>0,a=r+n>>>0;a>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=a}var Wi=P(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),rS=P(Symbol.for("effect/Hash/pcgr"),()=>new co),O=Symbol.for("effect/Hash"),d=e=>{switch(typeof e){case"number":return po(e);case"bigint":return br(e.toString(10));case"boolean":return br(String(e));case"symbol":return br(String(e));case"string":return br(e);case"undefined":return br("undefined");case"function":case"object":return e===null?br("null"):oS(e)?e[O]():jt(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},jt=e=>(Wi.has(e)||Wi.set(e,po(rS.integer(Number.MAX_SAFE_INTEGER))),Wi.get(e)),_=e=>t=>t*53^e,ks=e=>e&3221225471|e>>>1&1073741824,oS=e=>b(e,O),po=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return ks(e)},br=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return ks(t)},nS=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=u(br(t[o]),_(d(e[t[o]])));return ks(r)},Cs=e=>nS(e,Object.keys(e)),Or=e=>{let t=6151;for(let r=0;r<e.length;r++)t=u(t,_(d(e[r])));return ks(t)};var E=Symbol.for("effect/Equal");function y(){return arguments.length===1?e=>of(e,arguments[0]):of(arguments[0],arguments[1])}function of(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&nf(e)&&nf(t)?d(e)===d(t)&&e[E](t):!1}var nf=e=>b(e,E),vs=()=>(e,t)=>y(e,t);var Rt=e=>(t,r)=>t===r||e(t,r),sS=(e,t)=>e===t,zi=()=>sS;var aS=zi();var $i=l(2,(e,t)=>Rt((r,o)=>e(t(r),t(o)))),sf=$i(aS,e=>e.getTime());var af=e=>Rt((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var M=Symbol.for("nodejs.util.inspect.custom"),F=e=>b(e,"toJSON")&&Tt(e.toJSON)&&e.toJSON.length===0?e.toJSON():Array.isArray(e)?e.map(F):e,q=e=>JSON.stringify(e,null,2);var x=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var uo="Async",ws="Commit",Me="Failure",an="OnFailure",fo="OnSuccess",mo="OnSuccessAndFailure",Fe="Success",Ps="Sync",cf="Tag",_r="UpdateRuntimeFlags",ho="While",Ns="WithRuntime",go="Yield",cn="RevertFlags";var Vi=Symbol.for("effect/Effect"),pf=Symbol.for("effect/Stream"),lf=Symbol.for("effect/Sink"),uf=Symbol.for("effect/Channel"),Wt={_R:e=>e,_E:e=>e,_A:e=>e,_V:xr},cS={_R:e=>e,_E:e=>e,_In:e=>e,_L:e=>e,_Z:e=>e},pS={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},zt={[Vi]:Wt,[pf]:Wt,[lf]:cS,[uf]:pS,[E](e){return this===e},[O](){return jt(this)},pipe(){return x(this,arguments)}},pn={[O](){return Cs(this)},[E](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let o of t)if(!(o in e&&y(this[o],e[o])))return!1;return!0}},ff={...zt,_op:ws},Ji={...ff,...pn};var mf=Symbol.for("effect/Option"),hf={...zt,[mf]:{_A:e=>e},[M](){return this.toJSON()},toString(){return q(this.toJSON())}},uS=Object.assign(Object.create(hf),{_tag:"Some",_op:"Some",[E](e){return Ms(e)&&Qi(e)&&y(e.value,this.value)},[O](){return _(d(this._tag))(d(this.value))},toJSON(){return{_id:"Option",_tag:this._tag,value:F(this.value)}}}),fS=Object.assign(Object.create(hf),{_tag:"None",_op:"None",[E](e){return Ms(e)&&Yi(e)},[O](){return _(d(this._tag))},toJSON(){return{_id:"Option",_tag:this._tag}}}),Ms=e=>b(e,mf),Yi=e=>e._tag==="None",Qi=e=>e._tag==="Some",Fs=Object.create(fS),Ls=e=>{let t=Object.create(uS);return t.value=e,t};var Zi=Symbol.for("effect/Either"),gf={...zt,[Zi]:{_A:e=>e},[M](){return this.toJSON()},toString(){return q(this.toJSON())}},mS=Object.assign(Object.create(gf),{_tag:"Right",_op:"Right",[E](e){return Xi(e)&&tc(e)&&y(e.right,this.right)},[O](){return _(d(this._tag))(d(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:F(this.right)}}}),hS=Object.assign(Object.create(gf),{_tag:"Left",_op:"Left",[E](e){return Xi(e)&&ec(e)&&y(e.left,this.left)},[O](){return _(d(this._tag))(d(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:F(this.left)}}}),Xi=e=>b(e,Zi),ec=e=>e._tag==="Left",tc=e=>e._tag==="Right",xf=e=>{let t=Object.create(hS);return t.left=e,t},yf=e=>{let t=Object.create(mS);return t.right=e,t};var qs=e=>(t,r)=>t===r?0:e(t,r);var Sf=qs((e,t)=>e<t?-1:1);var bf=e=>qs((t,r)=>e(r,t));var ln=l(2,(e,t)=>qs((r,o)=>e(t(r),t(o))));var gS=e=>qs((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let a=s(t[n],r[n]);if(a!==0)return a;n++}return 0});var Of=(...e)=>gS(e);var rc=e=>l(2,(t,r)=>e(t,r)===1);var oc=e=>l(2,(t,r)=>t===r||e(t,r)>-1?t:r);var R=()=>Fs,C=Ls,_f=Ms,z=Yi,$=Qi,se=l(2,(e,{onNone:t,onSome:r})=>z(e)?t():r(e.value));var G=l(2,(e,t)=>z(e)?t():e.value),xo=l(2,(e,t)=>z(e)?t():e);var ft=e=>e==null?R():C(e);var At=G(Ts);var ue=l(2,(e,t)=>z(e)?R():C(t(e.value)));var un=l(2,(e,t)=>z(e)?R():t(e.value));var Ef=un(B);var Tf=e=>Rt((t,r)=>t===r||(z(t)?z(r):z(r)?!1:e(t.value,r.value)));var yS=e=>l(2,(t,r)=>z(t)?!1:e(t.value,r)),SS=vs(),Rf=yS(SS);var sc=Symbol.for("effect/BigDecimal"),bS={[sc]:sc,[O](){let e=cc(this);return u(d(e.value),_(po(e.scale)))},[E](e){return ac(e)&&_S(this,e)},toString(){return lc(this)},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},ac=e=>b(e,sc),yo=(e,t)=>{let r=Object.create(bS);return r.value=e,r.scale=t,r},ic=BigInt(0);var Af=BigInt(10),OS=yo(ic,0),cc=e=>{if(e.normalized===void 0)if(e.value===ic)e.normalized=OS;else{let t=`${e.value}`,r=0;for(let s=t.length-1;s>=0&&t[s]==="0";s--)r++;r===0&&(e.normalized=e);let o=BigInt(t.substring(0,t.length-r)),n=e.scale-r;e.normalized=yo(o,n)}return e.normalized},If=(e,t)=>t>e.scale?yo(e.value*Af**BigInt(t-e.scale),t):t<e.scale?yo(e.value/Af**BigInt(e.scale-t),t):e;var pc=Rt((e,t)=>e.scale>t.scale?If(t,e.scale).value===e.value:e.scale<t.scale?If(e,t.scale).value===t.value:e.value===t.value),_S=l(2,(e,t)=>pc(e,t));var lc=e=>{let t=e.value<ic,r=t?`${e.value}`.substring(1):`${e.value}`,o,n;if(e.scale>=r.length)o="0",n="0".repeat(e.scale-r.length)+r;else{let a=r.length-e.scale;if(a>r.length){let i=a-r.length;o=`${r}${"0".repeat(i)}`,n=""}else n=r.slice(a),o=r.slice(0,a)}let s=n===""?o:`${o}.${n}`;return t?`-${s}`:s};var ae=yf,ce=xf;var pe=ec,tt=tc;var TS=l(2,(e,{onLeft:t,onRight:r})=>pe(e)?t(e.left):r(e.right));var kf=TS({onLeft:B,onRight:B});var uc=e=>e.length>0;var Cf=(...e)=>e;var fc=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var Te=e=>Array.isArray(e)?e:Array.from(e);var rt=l(2,(e,t)=>[t,...e]);var vf=l(2,(e,t)=>[...e,t]);var IS=e=>e.length===0,mc=IS,Hs=uc,Le=uc;var wf=(e,t)=>e<0||e>=t.length;var kS=l(2,(e,t)=>{let r=Math.floor(t);return wf(r,e)?R():C(e[r])}),hc=l(2,(e,t)=>{let r=Math.floor(t);if(wf(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Ds=kS(0),le=hc(0),Bs=e=>Le(e)?C(CS(e)):R(),CS=e=>e[e.length-1];var mt=e=>e.slice(1);var dc=e=>Array.from(e).reverse(),Tr=l(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var gc=l(2,(e,t)=>Pf(e,t,Cf)),Pf=l(3,(e,t,r)=>{let o=Te(e),n=Te(t);if(Le(o)&&Le(n)){let s=[r(le(o),le(n))],a=Math.min(o.length,n.length);for(let i=1;i<a;i++)s[i]=r(o[i],n[i]);return s}return[]});var Rr=()=>[],qe=e=>[e],Re=l(2,(e,t)=>e.map(t)),fn=l(2,(e,t)=>{if(mc(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r}),xc=fn(B);var It=l(3,(e,t,r)=>Te(e).reduce((o,n,s)=>r(o,n,s),t));var yc=(e,t)=>{let r=[],o=e,n;for(;$(n=t(o));){let[s,a]=n.value;r.push(s),o=a}return r};var Us=af;var vS=l(2,(e,t)=>{let r=Te(e);if(Le(r)){let o=[le(r)],n=mt(r);for(let s of n)o.every(a=>!t(s,a))&&o.push(s);return o}return[]}),Nf=vS(vs());var ht=l(2,(e,t)=>Te(e).join(t));var Ff=Symbol.for("effect/Chunk");function PS(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var Lf=[],NS=e=>Rt((t,r)=>t.length===r.length&&kt(t).every((o,n)=>e(o,$t(r,n)))),MS=NS(y),FS={[Ff]:{_A:e=>e},toString(){return q(this.toJSON())},toJSON(){return{_id:"Chunk",values:kt(this).map(F)}},[M](){return this.toJSON()},[E](e){return qf(e)&&MS(this,e)},[O](){return Or(kt(this))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Lf[Symbol.iterator]();default:return kt(this)[Symbol.iterator]()}},pipe(){return x(this,arguments)}},ee=e=>{let t=Object.create(FS);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=ot,t.right=ot;break}case"ISingleton":{t.length=1,t.depth=0,t.left=ot,t.right=ot;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=ot,t.right=ot;break}}return t},qf=e=>b(e,Ff),ot=ee({_tag:"IEmpty"}),He=()=>ot;var ie=e=>ee({_tag:"ISingleton",a:e}),mn=e=>qf(e)?e:ee({_tag:"IArray",array:Te(e)}),Sc=(e,t,r)=>{switch(e.backing._tag){case"IArray":{PS(e.backing.array,0,t,r,e.length);break}case"IConcat":{Sc(e.left,t,r),Sc(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=$t(e,o),o+=1,n+=1;break}}};var kt=e=>{switch(e.backing._tag){case"IEmpty":return Lf;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return Sc(e,t,0),e.backing={_tag:"IArray",array:t},e.left=ot,e.right=ot,e.depth=0,t}}},Gt=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return ee({_tag:"IArray",array:dc(e.backing.array)});case"IConcat":return ee({_tag:"IConcat",left:Gt(e.backing.right),right:Gt(e.backing.left)});case"ISlice":return Ct(dc(kt(e)))}},LS=l(2,(e,t)=>t<0||t>=e.length?R():C($t(e,t))),Ct=e=>ee({_tag:"IArray",array:e});var $t=l(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?$t(e.left,t):$t(e.right,t-e.left.length);case"ISlice":return $t(e.backing.chunk,t+e.backing.offset)}}),Hf=l(2,(e,t)=>Ge(e,ie(t))),ge=l(2,(e,t)=>Ge(ie(t),e)),bc=l(2,(e,t)=>{if(t<=0)return ot;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return ee({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?ee({_tag:"IConcat",left:e.left,right:bc(e.right,t-e.left.length)}):bc(e.left,t);default:return ee({_tag:"ISlice",chunk:e,offset:0,length:t})}}),So=l(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return ot;switch(e.backing._tag){case"ISlice":return ee({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?So(e.right,t-e.left.length):ee({_tag:"IConcat",left:So(e.left,t),right:e.right});default:return ee({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var Ge=l(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return ee({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=Ge(e.right,t);return ee({_tag:"IConcat",left:e.left,right:o})}else{let o=Ge(e.right.right,t);if(o.depth===e.depth-3){let n=ee({_tag:"IConcat",left:e.right.left,right:o});return ee({_tag:"IConcat",left:e.left,right:n})}else{let n=ee({_tag:"IConcat",left:e.left,right:e.right.left});return ee({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=Ge(e,t.left);return ee({_tag:"IConcat",left:o,right:t.right})}else{let o=Ge(e,t.left.left);if(o.depth===t.depth-3){let n=ee({_tag:"IConcat",left:o,right:t.left.right});return ee({_tag:"IConcat",left:n,right:t.right})}else{let n=ee({_tag:"IConcat",left:t.left.right,right:t.right});return ee({_tag:"IConcat",left:o,right:n})}}});var hn=e=>e.length===0,nt=e=>e.length>0,dn=LS(0),Ar=e=>$t(e,0),st=Ar;var Df=e=>$t(e,e.length-1),Oc=l(2,(e,t)=>e.backing._tag==="ISingleton"?ie(t(e.backing.a,0)):Ct(u(kt(e),Re((r,o)=>t(r,o)))));var Ks=l(2,(e,t)=>Ct(Tr(kt(e),t)));var qS=l(2,(e,t)=>[bc(e,t),So(e,t)]);var Bf=l(2,(e,t)=>{let r=0;for(let o of kt(e)){if(t(o))break;r++}return qS(e,r)});var at=e=>So(e,1);var Uf=e=>Ct(Nf(kt(e)));var Kf=Symbol.for("effect/Context/Tag"),HS="effect/STM",DS=Symbol.for(HS),BS={...zt,_tag:"Tag",_op:"Tag",[DS]:Wt,[Kf]:{_Service:e=>e,_Identifier:e=>e},toString(){return q(this.toJSON())},toJSON(){return{_id:"Tag",identifier:this.identifier,stack:this.stack}},[M](){return this.toJSON()},of(e){return e},context(e){return Tc(this,e)}},_c=P("effect/Context/Tag/tagRegistry",()=>new Map),jf=e=>{if(e&&_c.has(e))return _c.get(e);let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;let o=Object.create(BS);return Object.defineProperty(o,"stack",{get(){return r.stack}}),e&&(o.identifier=e,_c.set(e,o)),o},Ec=Symbol.for("effect/Context"),US={[Ec]:{_Services:e=>e},[E](e){if(Wf(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!y(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[O](){return po(this.unsafeMap.size)},pipe(){return x(this,arguments)},toString(){return q(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(F)}},[M](){return this.toJSON()}},Jt=e=>{let t=Object.create(US);return t.unsafeMap=e,t},KS=e=>{let t=new Error(`Service not found${e.identifier?`: ${String(e.identifier)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[2].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},Wf=e=>b(e,Ec);var jS=Jt(new Map),zf=()=>jS,Tc=(e,t)=>Jt(new Map([[e,t]])),$f=l(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),Jt(o)}),Rc=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw KS(t);return e.unsafeMap.get(t)}),Gf=Rc,Vf=l(2,(e,t)=>e.unsafeMap.has(t)?Ls(e.unsafeMap.get(t)):Fs),Jf=l(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return Jt(r)});var De=jf;var gn=zf,Yf=Tc,Ir=$f,kr=Gf,Qf=Rc,bo=Vf,Ac=Jf;var Ic=Math.pow(2,5),Zf=Ic-1,Xf=Ic/2,em=Ic/4;function zS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Qt(e,t){return t>>>e&Zf}function Zt(e){return 1<<e}function js(e,t){return zS(e&t-1)}var Ws=class{value;previous;constructor(t,r){this.value=t,this.previous=r}};function Cr(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let a=0;a<s;++a)n[a]=o[a]}return n[t]=r,n}function kc(e,t,r){let o=r.length-1,n=0,s=0,a=r;if(e)n=s=t;else for(a=new Array(o);n<t;)a[s++]=r[n++];for(++n;n<=o;)a[s++]=r[n++];return e&&(a.length=o),a}function tm(e,t,r,o){let n=o.length;if(e){let c=n;for(;c>=t;)o[c--]=o[c];return o[t]=r,o}let s=0,a=0,i=new Array(n+1);for(;s<t;)i[a++]=o[s++];for(i[t]=r;s<n;)i[++a]=o[s++];return i}var vt=class e{_tag="EmptyNode";modify(t,r,o,n,s,a){let i=o(R());return z(i)?new e:(++a.value,new Oo(t,n,s,i))}};function Ve(e){return As(e,"EmptyNode")}function $S(e){return Ve(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function zs(e,t){return Ve(e)?!1:t===e.edit}var Oo=class e{edit;hash;key;value;_tag="LeafNode";constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n}modify(t,r,o,n,s,a){if(y(s,this.key)){let c=o(this.value);return c===this.value?this:z(c)?(--a.value,new vt):zs(this,t)?(this.value=c,this):new e(t,n,s,c)}let i=o(R());return z(i)?this:(++a.value,rm(t,r,this.hash,this,n,new e(t,n,s,i)))}},Cc=class e{edit;hash;children;_tag="CollisionNode";constructor(t,r,o){this.edit=t,this.hash=r,this.children=o}modify(t,r,o,n,s,a){if(n===this.hash){let c=zs(this,t),p=this.updateCollisionList(c,t,this.hash,this.children,o,s,a);return p===this.children?this:p.length>1?new e(t,this.hash,p):p[0]}let i=o(R());return z(i)?this:(++a.value,rm(t,r,this.hash,this,n,new Oo(t,n,s,i)))}updateCollisionList(t,r,o,n,s,a,i){let c=n.length;for(let f=0;f<c;++f){let m=n[f];if("key"in m&&y(a,m.key)){let h=m.value,g=s(h);return g===h?n:z(g)?(--i.value,kc(t,f,n)):Cr(t,f,new Oo(r,o,a,g),n)}}let p=s(R());return z(p)?n:(++i.value,Cr(t,c,new Oo(r,o,a,p),n))}},xn=class e{edit;mask;children;_tag="IndexedNode";constructor(t,r,o){this.edit=t,this.mask=r,this.children=o}modify(t,r,o,n,s,a){let i=this.mask,c=this.children,p=Qt(r,n),f=Zt(p),m=js(i,f),h=i&f,g=zs(this,t);if(!h){let N=new vt().modify(t,r+5,o,n,s,a);return N?c.length>=Xf?VS(t,p,N,i,c):new e(t,i|f,tm(g,m,N,c)):this}let S=c[m],I=S.modify(t,r+5,o,n,s,a);if(S===I)return this;let T=i,v;if(Ve(I)){if(T&=~f,!T)return new vt;if(c.length<=2&&$S(c[m^1]))return c[m^1];v=kc(g,m,c)}else v=Cr(g,m,I,c);return g?(this.mask=T,this.children=v,this):new e(t,T,v)}},vc=class e{edit;size;children;_tag="ArrayNode";constructor(t,r,o){this.edit=t,this.size=r,this.children=o}modify(t,r,o,n,s,a){let i=this.size,c=this.children,p=Qt(r,n),f=c[p],m=(f||new vt).modify(t,r+5,o,n,s,a);if(f===m)return this;let h=zs(this,t),g;if(Ve(f)&&!Ve(m))++i,g=Cr(h,p,m,c);else if(!Ve(f)&&Ve(m)){if(--i,i<=em)return GS(t,i,p,c);g=Cr(h,p,new vt,c)}else g=Cr(h,p,m,c);return h?(this.size=i,this.children=g,this):new e(t,i,g)}};function GS(e,t,r,o){let n=new Array(t-1),s=0,a=0;for(let i=0,c=o.length;i<c;++i)if(i!==r){let p=o[i];p&&!Ve(p)&&(n[s++]=p,a|=1<<i)}return new xn(e,a,n)}function VS(e,t,r,o,n){let s=[],a=o,i=0;for(let c=0;a;++c)a&1&&(s[c]=n[i++]),a>>>=1;return s[t]=r,new vc(e,i+1,s)}function JS(e,t,r,o,n,s){if(r===n)return new Cc(e,r,[s,o]);let a=Qt(t,r),i=Qt(t,n);if(a===i)return c=>new xn(e,Zt(a)|Zt(i),[c]);{let c=a<i?[o,s]:[s,o];return new xn(e,Zt(a)|Zt(i),c)}}function rm(e,t,r,o,n,s){let a,i=t;for(;;){let c=JS(e,i,r,o,n,s);if(typeof c=="function")a=new Ws(c,a),i=i+5;else{let p=c;for(;a!=null;)p=a.value(p),a=a.previous;return p}}}var om="effect/HashMap",$s=Symbol.for(om),QS={[$s]:$s,[Symbol.iterator](){return new Gs(this,(e,t)=>[e,t])},[O](){let e=d(om);for(let t of this)e^=u(d(t[0]),_(d(t[1])));return e},[E](e){if(im(e)){if(e._size!==this._size)return!1;for(let t of this){let r=u(e,Js(t[0],d(t[0])));if(z(r))return!1;if(!y(t[1],r.value))return!1}return!0}return!1},toString(){return q(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},wc=(e,t,r,o)=>{let n=Object.create(QS);return n._editable=e,n._edit=t,n._root=r,n._size=o,n},Gs=class e{map;f;v;constructor(t,r){this.map=t,this.f=r,this.v=nm(this.map._root,this.f,void 0)}next(){if(z(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Vs(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Vs=e=>e?sm(e[0],e[1],e[2],e[3],e[4]):R(),nm=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return $(e.value)?C({value:t(e.key,e.value.value),cont:r}):Vs(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return sm(o.length,o,0,t,r)}default:return Vs(r)}},sm=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!Ve(s))return nm(s,o,[e,t,r,o,n])}return Vs(n)},ZS=wc(!1,0,new vt,0),Eo=()=>ZS,am=(...e)=>Pc(e),Pc=e=>{let t=Qs(Eo());for(let r of e)vr(t,r[0],r[1]);return lm(t)},im=e=>b(e,$s),cm=e=>e&&Ve(e._root),pm=l(2,(e,t)=>Js(e,t,d(t))),Js=l(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return y(t,o.key)?o.value:R();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let a=0,i=s.length;a<i;++a){let c=s[a];if("key"in c&&y(t,c.key))return c.value}}return R()}case"IndexedNode":{let s=Qt(n,r),a=Zt(s);if(o.mask&a){o=o.children[js(o.mask,a)],n+=5;break}return R()}case"ArrayNode":{if(o=o.children[Qt(n,r)],o){n+=5;break}return R()}default:return R()}});var Nc=l(2,(e,t)=>$(Js(e,t,d(t))));var vr=l(3,(e,t,r)=>Mc(e,t,()=>C(r))),XS=l(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:wc(e._editable,e._edit,t,r)),Ys=e=>new Gs(e,t=>t);var To=e=>e._size,Qs=e=>wc(!0,e._edit+1,e._root,e._size),lm=e=>(e._editable=!1,e);var Mc=l(3,(e,t,r)=>um(e,t,d(t),r)),um=l(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return u(e,XS(s,n.value))});var Zs=l(2,(e,t)=>Mc(e,t,R));var fm=l(2,(e,t)=>Ro(e,Eo(),(r,o,n)=>vr(r,n,t(o,n))));var Fc=l(2,(e,t)=>Ro(e,void 0,(r,o,n)=>t(o,n))),Ro=l(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return $(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let a=0,i=s.length;a<i;){let c=s[a++];c&&!Ve(c)&&(c._tag==="LeafNode"?$(c.value)&&(t=r(t,c.value.value,c.key)):n.push(c.children))}return t});var hm="effect/HashSet",Xs=Symbol.for(hm),eb={[Xs]:Xs,[Symbol.iterator](){return Ys(this._keyMap)},[O](){return _(d(this._keyMap))(d(hm))},[E](e){return Lc(e)?To(this._keyMap)===To(e._keyMap)&&y(this._keyMap,e._keyMap):!1},toString(){return q(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},ea=e=>{let t=Object.create(eb);return t._keyMap=e,t},Lc=e=>b(e,Xs),tb=ea(Eo()),yn=()=>tb,dm=e=>{let t=ta(yn());for(let r of e)Ao(t,r);return ra(t)},gm=(...e)=>{let t=ta(yn());for(let r of e)Ao(t,r);return ra(t)},xm=l(2,(e,t)=>Nc(e._keyMap,t));var ym=e=>To(e._keyMap),ta=e=>ea(Qs(e._keyMap)),ra=e=>(e._keyMap._editable=!1,e),qc=l(2,(e,t)=>{let r=ta(e);return t(r),ra(r)}),Ao=l(2,(e,t)=>e._keyMap._editable?(vr(t,!0)(e._keyMap),e):ea(vr(t,!0)(e._keyMap))),Hc=l(2,(e,t)=>e._keyMap._editable?(Zs(t)(e._keyMap),e):ea(Zs(t)(e._keyMap))),Sm=l(2,(e,t)=>qc(e,r=>{for(let o of t)Hc(r,o)}));var bm=l(2,(e,t)=>qc(yn(),r=>{Om(e,o=>Ao(r,o));for(let o of t)Ao(r,o)}));var Om=l(2,(e,t)=>Fc(e._keyMap,(r,o)=>t(o))),_m=l(3,(e,t,r)=>Ro(e._keyMap,t,(o,n,s)=>r(o,s)));var Em=Lc,me=yn,Xt=dm,dt=gm,Tm=xm;var wr=ym;var Pr=Ao,Dc=Hc,Bc=Sm;var Ae=bm;var Nr=_m;var Rm=Symbol.for("effect/MutableRef"),ob={[Rm]:Rm,toString(){return q(this.toJSON())},toJSON(){return{_id:"MutableRef",current:F(this.current)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},er=e=>{let t=Object.create(ob);return t.current=e,t};var Be=e=>e.current;var Am=e=>sb(e,t=>t+1),xt=l(2,(e,t)=>(e.current=t,e)),nb=l(2,(e,t)=>(e.current=t,e.current)),Im=l(2,(e,t)=>xt(e,t(Be(e)))),sb=l(2,(e,t)=>nb(e,t(Be(e))));var na="effect/FiberId",tr=Symbol.for(na),Uc="None",Kc="Runtime",jc="Composite",Wc=class{[tr]=tr;_tag=Uc;[O](){return u(d(na),_(d(this._tag)))}[E](t){return sa(t)&&t._tag===Uc}toString(){return q(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[M](){return this.toJSON()}},zc=class{id;startTimeMillis;[tr]=tr;_tag=Kc;constructor(t,r){this.id=t,this.startTimeMillis=r}[O](){return u(d(na),_(d(this._tag)),_(d(this.id)),_(d(this.startTimeMillis)))}[E](t){return sa(t)&&t._tag===Kc&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return q(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[M](){return this.toJSON()}},km=class{left;right;[tr]=tr;_tag=jc;constructor(t,r){this.left=t,this.right=r}[O](){return u(d(na),_(d(this._tag)),_(d(this.left)),_(d(this.right)))}[E](t){return sa(t)&&t._tag===jc&&y(this.left,t.left)&&y(this.right,t.right)}toString(){return q(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:F(this.left),right:F(this.right)}}[M](){return this.toJSON()}},vm=new Wc;var sa=e=>b(e,tr);var oa=e=>{switch(e._tag){case Uc:return me();case Kc:return dt(e.id);case jc:return u(oa(e.left),Ae(oa(e.right)))}},Cm=P(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>er(0));var aa=e=>Array.from(oa(e)).map(r=>`#${r}`).join(",");var wm=()=>{let e=Be(Cm);return u(Cm,xt(e+1)),new zc(e,new Date().getTime())};var wt=vm;var Nm=aa;var Mm=wm;var rr=Eo,Fm=am,bn=Pc,Lm=cm,On=pm;var Io=vr,$c=Ys;var Gc=To;var ca=fm;var Vc=Ro;var _n=Symbol.for("effect/List"),pa=e=>Array.from(e),ab=e=>$i(Us(e),pa),ib=ab(y),cb={[_n]:_n,_tag:"Cons",toString(){return q(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:pa(this).map(F)}},[M](){return this.toJSON()},[E](e){return Hm(e)&&this._tag===e._tag&&ib(this,e)},[O](){return Or(pa(this))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},pipe(){return x(this,arguments)}},la=(e,t)=>{let r=Object.create(cb);return r.head=e,r.tail=t,r},pb={[_n]:_n,_tag:"Nil",toString(){return q(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[M](){return this.toJSON()},[O](){return Or(pa(this))},[E](e){return Hm(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return x(this,arguments)}},qm=Object.create(pb),Hm=e=>b(e,_n),yt=e=>e._tag==="Nil",En=e=>e._tag==="Cons";var lb=()=>qm,Pt=(e,t)=>la(e,t),or=lb,Tn=e=>la(e,qm);var Dm=l(2,(e,t)=>fb(t,e)),ub=l(2,(e,t)=>Pt(t,e)),fb=l(2,(e,t)=>{if(yt(e))return t;if(yt(t))return e;{let r=la(t.head,e),o=r,n=t.tail;for(;!yt(n);){let s=la(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var Bm=l(3,(e,t,r)=>{let o=t,n=e;for(;!yt(n);)o=r(o,n.head),n=n.tail;return o});var Um=e=>{let t=or(),r=e;for(;!yt(r);)t=ub(t,r.head),r=r.tail;return t};var mk=Object.assign(Object.create(Array.prototype),{[O](){return Or(this)},[E](e){return Array.isArray(e)&&this.length===e.length?this.every((t,r)=>y(t,e[r])):!1}}),fa=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=pn,e}();var mb=Symbol.for("effect/DifferContextPatch");function Km(e){return e}var An={...fa.prototype,[mb]:{_Value:Km,_Patch:Km}},hb=Object.assign(Object.create(An),{_tag:"Empty"}),db=Object.create(hb),Jc=()=>db,gb=Object.assign(Object.create(An),{_tag:"AndThen"}),xb=(e,t)=>{let r=Object.create(gb);return r.first=e,r.second=t,r},yb=Object.assign(Object.create(An),{_tag:"AddService"}),Sb=(e,t)=>{let r=Object.create(yb);return r.tag=e,r.service=t,r},bb=Object.assign(Object.create(An),{_tag:"RemoveService"}),Ob=e=>{let t=Object.create(bb);return t.tag=e,t},_b=Object.assign(Object.create(An),{_tag:"UpdateService"}),Eb=(e,t)=>{let r=Object.create(_b);return r.tag=e,r.update=t,r},jm=(e,t)=>{let r=new Map(e.unsafeMap),o=Jc();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let a=r.get(n);r.delete(n),y(a,s)||(o=Rn(Eb(n,()=>s))(o))}else r.delete(n),o=Rn(Sb(n,s))(o);for(let[n]of r.entries())o=Rn(Ob(n))(o);return o},Rn=l(2,(e,t)=>xb(e,t)),Wm=l(2,(e,t)=>{let r=!1,o=ie(e),n=new Map(t.unsafeMap);for(;nt(o);){let a=st(o),i=at(o);switch(a._tag){case"Empty":{o=i;break}case"AddService":{n.set(a.tag,a.service),o=i;break}case"AndThen":{o=ge(ge(i,a.second),a.first);break}case"RemoveService":{n.delete(a.tag),o=i;break}case"UpdateService":{n.set(a.tag,a.update(n.get(a.tag))),r=!0,o=i;break}}}if(!r)return Jt(n);let s=new Map;for(let[a]of t.unsafeMap)n.has(a)&&(s.set(a,n.get(a)),n.delete(a));for(let[a,i]of n)s.set(a,i);return Jt(s)});var Rb=Symbol.for("effect/DifferHashSetPatch");function Yc(e){return e}var ha={...fa.prototype,[Rb]:{_Value:Yc,_Key:Yc,_Patch:Yc}},Ab=Object.assign(Object.create(ha),{_tag:"Empty"}),Ib=Object.create(Ab),Qc=()=>Ib,kb=Object.assign(Object.create(ha),{_tag:"AndThen"}),Cb=(e,t)=>{let r=Object.create(kb);return r.first=e,r.second=t,r},vb=Object.assign(Object.create(ha),{_tag:"Add"}),wb=e=>{let t=Object.create(vb);return t.value=e,t},Pb=Object.assign(Object.create(ha),{_tag:"Remove"}),Nb=e=>{let t=Object.create(Pb);return t.value=e,t},zm=(e,t)=>{let[r,o]=Nr([e,Qc()],([n,s],a)=>Tm(a)(n)?[Dc(a)(n),s]:[n,ma(wb(a))(s)])(t);return Nr(o,(n,s)=>ma(Nb(s))(n))(r)},ma=l(2,(e,t)=>Cb(e,t)),$m=l(2,(e,t)=>{let r=t,o=ie(e);for(;nt(o);){let n=st(o),s=at(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=ge(n.first)(ge(n.second)(s));break}case"Add":{r=Pr(n.value)(r),o=s;break}case"Remove":r=Dc(n.value)(r),o=s}}return r});var Gm=Symbol.for("effect/Differ"),Fb={[Gm]:{_P:B,_V:B}},Fr=e=>{let t=Object.create(Fb);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},Zc=()=>Fr({empty:Jc(),combine:(e,t)=>Rn(t)(e),diff:(e,t)=>jm(e,t),patch:(e,t)=>Wm(t)(e)});var Xc=()=>Fr({empty:Qc(),combine:(e,t)=>ma(t)(e),diff:(e,t)=>zm(e,t),patch:(e,t)=>$m(t)(e)});var ep=()=>Vm((e,t)=>t),Vm=e=>Fr({empty:B,combine:(t,r)=>t===B?r:r===B?t:o=>r(t(o)),diff:(t,r)=>y(t,r)?B:nn(r),patch:(t,r)=>e(r,t(r))});var In=255,Jm=8,da=e=>e&In,ga=e=>e>>Jm&In,Lr=(e,t)=>(e&In)+((t&e&In)<<Jm),rp=Lr(0,0),Ym=e=>Lr(e,e),Qm=e=>Lr(e,0);var Zm=l(2,(e,t)=>Lr(da(e)&~t,ga(e)));var op=l(2,(e,t)=>e|t);var Xm=e=>~e>>>0&In;var Lb=0,qr=1,th=2,qb=4,xa=16,Hb=32;var rh=e=>ya(e,Hb);var oh=l(2,(e,t)=>e|t);var Nt=e=>np(e)&&!Bb(e),np=e=>ya(e,qr);var ya=l(2,(e,t)=>(e&t)!==0),Db=(...e)=>e.reduce((t,r)=>t|r,0),nh=Db(Lb);var Sa=e=>ya(e,qb);var Bb=e=>ya(e,xa);var kn=l(2,(e,t)=>Lr(e^t,t)),Cn=l(2,(e,t)=>e&(Xm(da(t))|ga(t))|da(t)&ga(t));var sp=Fr({empty:rp,diff:(e,t)=>kn(e,t),combine:(e,t)=>op(t)(e),patch:(e,t)=>Cn(t,e)});var ah=Ym,ap=Qm;var ip=Zm;var pp=(e,t)=>({_tag:"Par",left:e,right:t}),ba=(e,t)=>({_tag:"Seq",left:e,right:t});var ph=e=>{let t=Tn(e),r=or();for(;;){let[o,n]=Bm(t,[lh(),or()],([s,a],i)=>{let[c,p]=Ub(i);return[uh(s,c),Dm(a,p)]});if(r=Kb(r,o),yt(n))return Um(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},Ub=e=>{let t=e,r=lh(),o=or(),n=or();for(;;)switch(t._tag){case"Empty":{if(yt(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=Pt(t.right,o),t=t.left;break}case"Seq":{let s=t.left,a=t.right;switch(s._tag){case"Empty":{t=a;break}case"Par":{let i=s.left,c=s.right;t=pp(ba(i,a),ba(c,a));break}case"Seq":{let i=s.left,c=s.right;t=ba(i,ba(c,a));break}case"Single":{t=s,n=Pt(a,n);break}}break}case"Single":{if(r=uh(r,Gb(t.dataSource,t.blockedRequest)),yt(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},Kb=(e,t)=>{if(yt(e))return Tn(cp(t));if(Vb(t))return e;let r=eO(e.head),o=Jb(t);return r.length===1&&o.length===1&&y(r[0],o[0])?Pt(Xb(e.head,cp(t)),e.tail):Pt(cp(t),e)},jb=Symbol.for("effect/RequestBlock/Entry"),ch=class{request;result;listeners;ownerId;state;[jb]=Wb;constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s}},Wb={_R:e=>e};var zb=Symbol.for("effect/RequestBlock/RequestBlockParallel"),$b={_R:e=>e},vn=class{map;[zb]=$b;constructor(t){this.map=t}},lh=()=>new vn(rr()),Gb=(e,t)=>new vn(Fm([e,Array.of(t)])),uh=(e,t)=>new vn(Vc(e.map,t.map,(r,o,n)=>Io(r,n,se(On(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),Vb=e=>Lm(e.map),Jb=e=>Array.from($c(e.map)),cp=e=>Zb(ca(e.map,t=>Array.of(t))),Yb=Symbol.for("effect/RequestBlock/RequestBlockSequential"),Qb={_R:e=>e},Oa=class{map;[Yb]=Qb;constructor(t){this.map=t}},Zb=e=>new Oa(e),Xb=(e,t)=>new Oa(Vc(t.map,e.map,(r,o,n)=>Io(r,n,se(On(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var eO=e=>Array.from($c(e.map)),fh=e=>Array.from(e.map);var ko="Die",Hr="Empty",Dr="Fail",Co="Interrupt",Br="Parallel",Ur="Sequential";var yh="effect/Cause",Sh=Symbol.for(yh),oO={_E:e=>e},Po={[Sh]:oO,[O](){return u(d(yh),_(d(aO(this))))},[E](e){return nO(e)&&sO(this,e)},pipe(){return x(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:F(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:F(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:F(this.left),right:F(this.right)}}},toString(){return Pn(this)},[M](){return this.toJSON()}},vo=(()=>{let e=Object.create(Po);return e._tag=Hr,e})(),up=e=>{let t=Object.create(Po);return t._tag=Dr,t.error=e,t},St=e=>{let t=Object.create(Po);return t._tag=ko,t.defect=e,t},Mt=e=>{let t=Object.create(Po);return t._tag=Co,t.fiberId=e,t},Kr=(e,t)=>{let r=Object.create(Po);return r._tag=Br,r.left=e,r.right=t,r},Ue=(e,t)=>{let r=Object.create(Po);return r._tag=Ur,r.left=e,r.right=t,r},nO=e=>b(e,Sh);var bh=e=>e._tag===Hr?!0:wo(e,!0,(t,r)=>{switch(r._tag){case Hr:return C(t);case ko:case Dr:case Co:return C(!1);default:return R()}});var wn=e=>hp(void 0,pO)(e),Oh=e=>Gt(wo(e,He(),(t,r)=>r._tag===Dr?C(u(t,ge(r.error))):R())),_h=e=>Gt(wo(e,He(),(t,r)=>r._tag===ko?C(u(t,ge(r.defect))):R())),Eh=e=>wo(e,me(),(t,r)=>r._tag===Co?C(u(t,Pr(r.fiberId))):R()),Th=e=>cO(e,t=>t._tag===Dr?C(t.error):R()),fp=e=>{let t=Th(e);switch(t._tag){case"None":return ae(e);case"Some":return ce(t.value)}};var mp=e=>Ah(e,{onEmpty:vo,onFail:()=>vo,onDie:t=>St(t),onInterrupt:t=>Mt(t),onSequential:Ue,onParallel:Kr}),Rh=e=>Ah(e,{onEmpty:vo,onFail:t=>St(t),onDie:t=>St(t),onInterrupt:t=>Mt(t),onSequential:(t,r)=>Ue(t,r),onParallel:(t,r)=>Kr(t,r)});var sO=(e,t)=>{let r=ie(e),o=ie(t);for(;nt(r)&&nt(o);){let[n,s]=u(st(r),wo([me(),He()],([c,p],f)=>{let[m,h]=lp(f);return C([u(c,Ae(m)),u(p,Ge(h))])})),[a,i]=u(st(o),wo([me(),He()],([c,p],f)=>{let[m,h]=lp(f);return C([u(c,Ae(m)),u(p,Ge(h))])}));if(!y(n,a))return!1;r=s,o=i}return!0},aO=e=>iO(ie(e),He()),iO=(e,t)=>{for(;;){let[r,o]=u(e,It([me(),He()],([s,a],i)=>{let[c,p]=lp(i);return[u(s,Ae(c)),u(a,Ge(p))]})),n=wr(r)>0?u(t,ge(r)):t;if(hn(o))return Gt(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/effect/issues")},cO=l(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case Ur:case Br:{r.push(o.right),r.push(o.left);break}}break}case"Some":return n}}return R()});var lp=e=>{let t=e,r=[],o=me(),n=He();for(;t!==void 0;)switch(t._tag){case Hr:{if(r.length===0)return[o,n];t=r.pop();break}case Dr:{if(o=Pr(o,t.error),r.length===0)return[o,n];t=r.pop();break}case ko:{if(o=Pr(o,t.defect),r.length===0)return[o,n];t=r.pop();break}case Co:{if(o=Pr(o,t.fiberId),r.length===0)return[o,n];t=r.pop();break}case Ur:{switch(t.left._tag){case Hr:{t=t.right;break}case Ur:{t=Ue(t.left.left,Ue(t.left.right,t.right));break}case Br:{t=Kr(Ue(t.left.left,t.right),Ue(t.left.right,t.right));break}default:{n=ge(n,t.right),t=t.left;break}}break}case Br:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/effect/issues")};var pO={emptyCase:Es,failCase:no,dieCase:no,interruptCase:Es,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var mh="SequentialCase",hh="ParallelCase",Ah=l(2,(e,{onDie:t,onEmpty:r,onFail:o,onInterrupt:n,onParallel:s,onSequential:a})=>hp(e,void 0,{emptyCase:()=>r,failCase:(i,c)=>o(c),dieCase:(i,c)=>t(c),interruptCase:(i,c)=>n(c),sequentialCase:(i,c,p)=>a(c,p),parallelCase:(i,c,p)=>s(c,p)})),wo=l(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let a=r(o,n);switch(o=$(a)?a.value:o,n._tag){case Ur:{s.push(n.right),n=n.left;break}case Br:{s.push(n.right),n=n.left;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),hp=l(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let a=o.pop();switch(a._tag){case Hr:{n.push(ae(r.emptyCase(t)));break}case Dr:{n.push(ae(r.failCase(t,a.error)));break}case ko:{n.push(ae(r.dieCase(t,a.defect)));break}case Co:{n.push(ae(r.interruptCase(t,a.fiberId)));break}case Ur:{o.push(a.right),o.push(a.left),n.push(ce({_tag:mh}));break}case Br:{o.push(a.right),o.push(a.left),n.push(ce({_tag:hh}));break}}}let s=[];for(;n.length>0;){let a=n.pop();switch(a._tag){case"Left":{switch(a.left._tag){case mh:{let i=s.pop(),c=s.pop(),p=r.sequentialCase(t,i,c);s.push(p);break}case hh:{let i=s.pop(),c=s.pop(),p=r.parallelCase(t,i,c);s.push(p);break}}break}case"Right":{s.push(a.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),lO=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},Pn=e=>wn(e)?"All fibers interrupted without errors.":uO(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${lO(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=At(n.parent),s++}return o}).join(`\r
`),_a=class{message;stack;span;constructor(t,r,o){this.message=t,this.stack=r,this.span=o}toJSON(){let t={message:this.message};return this.stack&&(t.stack=this.stack),this.span&&(t.span=this.span),t}},dh=e=>typeof e=="string"?`Error: ${e}`:b(e,"toString")&&Tt(e.toString)&&e.toString!==Object.prototype.toString?e.toString():`Error: ${JSON.stringify(e)}`,gh=Symbol.for("effect/SpanAnnotation"),xh=e=>{let t=b(e,gh)&&e[gh];return e instanceof Error?new _a(dh(e),e.stack?.split(`
`).filter(r=>r.match(/at (.*)/)).join(`
`),t):new _a(dh(e),void 0,t)},uO=e=>hp(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[xh(r)],failCase:(t,r)=>[xh(r)],interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o]});var No="Pending",Ea="Done";var fO="effect/Deferred",kh=Symbol.for(fO),Ch={_E:e=>e,_A:e=>e},Ta=e=>({_tag:No,joiners:e}),vh=e=>({_tag:Ea,effect:e});var wh=Symbol.for("effect/Tracer"),hO=e=>({[wh]:wh,...e}),Nn=De(Symbol.for("effect/Tracer")),Ra=De(Symbol.for("effect/ParentSpan")),dO=P("effect/Tracer/SpanId.ids",()=>er(0)),gp=class{name;parent;context;links;startTime;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${Am(dO)}`}end=(t,r)=>{this.status={_tag:"Ended",endTime:t,exit:r,startTime:this.status.startTime}};attribute=(t,r)=>{this.attributes.set(t,r)};event=(t,r,o)=>{this.events.push([t,r,o??{}])}},Ph=hO({span:(e,t,r,o,n)=>new gp(e,t,r,o,n),context:e=>e()});var xO="effect/EffectError",yO=Symbol.for(xO),Bh=e=>b(e,yO);var va=(e,t)=>{let r=new xe("Blocked");return r.i0=e,r.i1=t,r},_p=e=>{let t=new xe("RunBlocked");return t.i0=e,t},Mn=Symbol.for("effect/Effect"),Aa=class{patch;op;_op=cn;constructor(t,r){this.patch=t,this.op=r}},xe=class{_op;i0=void 0;i1=void 0;i2=void 0;trace=void 0;[Mn]=Wt;constructor(t){this._op=t}[E](t){return this===t}[O](){return jt(this)}pipe(){return x(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,i0:F(this.i0),i1:F(this.i1),i2:F(this.i2)}}toString(){return q(this.toJSON())}[M](){return this.toJSON()}},Ia=class{_op;i0=void 0;i1=void 0;i2=void 0;trace=void 0;[Mn]=Wt;constructor(t){this._op=t,this._tag=t}[E](t){return this===t}[O](){return jt(this)}get cause(){return this.i0}pipe(){return x(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return q(this.toJSON())}[M](){return this.toJSON()}},ka=class{_op;i0=void 0;i1=void 0;i2=void 0;trace=void 0;[Mn]=Wt;constructor(t){this._op=t,this._tag=t}[E](t){return this===t}[O](){return jt(this)}get value(){return this.i0}pipe(){return x(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:F(this.value)}}toString(){return q(this.toJSON())}[M](){return this.toJSON()}},Fn=e=>b(e,Mn),it=e=>{let t=new xe(Ns);return t.i0=e,t},Ep=l(3,(e,t,r)=>Fo(o=>w(e,n=>w(qn(te(()=>o(t(n)))),s=>te(()=>r(n,s)).pipe(Ft({onFailure:a=>{switch(s._tag){case Me:return Je(Kr(s.i0,a));case Fe:return Je(a)}},onSuccess:()=>s})))))),nr=l(2,(e,t)=>w(e,()=>H(t))),sr=e=>nr(e,void 0),jr=(e,t=wt)=>te(()=>{let r,o;function n(c){r?r(c):o===void 0&&(o=c)}let s=new xe(uo);s.i0=c=>{r=c,o&&c(o)},s.i1=t;let a,i;return e.length!==1?(i=new AbortController,a=e(n,i.signal)):a=e(n),a||i?Ma(s,c=>(i&&i.abort(),a??Ke)):s}),Ln=(e,t=wt)=>jr(r=>{let o=e(r);if(tt(o))r(o.right);else return o.left},t);var wa=l(2,(e,t)=>Mo(e,{onFailure:t,onSuccess:H}));var Sp=Symbol.for("effect/SpanAnnotation"),Nh=Symbol.for("effect/OriginalAnnotation");var SO=(e,t)=>$(t)?new Proxy(e,{has(r,o){return o===Sp||o===Nh||o in r},get(r,o){return o===Sp?t.value:o===Nh?e:r[o]}}):e;var Tp=e=>Uh(()=>St(new AO(e)));var Wr=e=>Mo(e,{onFailure:t=>H(ce(t)),onSuccess:t=>H(ae(t))}),qn=e=>Kh(e,{onFailure:V,onSuccess:Ie}),ye=e=>io(e)&&!(Sp in e)?it(t=>Je(up(SO(e,MO(t))))):Je(up(e)),Rp=e=>w(k(e),ye),Je=e=>{let t=new Ia(Me);return t.i0=e,t},Uh=e=>w(k(e),Je),Ap=it(e=>H(e.id())),Ip=e=>it(t=>e(t.id())),w=l(2,(e,t)=>{let r=new xe(fo);return r.i0=e,r.i1=t,r});var kp=e=>{let t=new xe("OnStep");return t.i0=e,t},Hn=e=>w(e,B);var Kh=l(2,(e,{onFailure:t,onSuccess:r})=>Ft(e,{onFailure:o=>H(t(o)),onSuccess:o=>H(r(o))})),Ft=l(2,(e,{onFailure:t,onSuccess:r})=>{let o=new xe(mo);return o.i0=e,o.i1=t,o.i2=r,o}),Mo=l(2,(e,{onFailure:t,onSuccess:r})=>Ft(e,{onFailure:o=>{let n=Oh(o);return _h(o).length>0?Je(Rh(o)):n.length>0?t(Ar(n)):Je(o)},onSuccess:r})),ct=l(2,(e,t)=>te(()=>{let r=Te(e),o=new Array(r.length),n=0;return nr(Un({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),zr=l(2,(e,t)=>te(()=>{let r=Te(e),o=0;return Un({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})}));var Pa=e=>{let t=new xe(_r);return t.i0=ah(qr),t.i1=()=>e,t};var Z=l(2,(e,t)=>w(e,r=>k(()=>t(r)))),Na=l(2,(e,{onFailure:t,onSuccess:r})=>Mo(e,{onFailure:o=>Rp(()=>t(o)),onSuccess:o=>k(()=>r(o))})),Dn=l(2,(e,t)=>Ft(e,{onFailure:r=>{let o=fp(r);switch(o._tag){case"Left":return Rp(()=>t(o.left));case"Right":return Je(o.right)}},onSuccess:H}));var Cp=l(2,(e,t)=>Fo(r=>Ft(r(e),{onFailure:o=>{let n=V(o);return Ft(t(n),{onFailure:s=>V(Ue(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=Ie(o);return jn(t(n),n)}}))),Ma=l(2,(e,t)=>Cp(e,CO({onFailure:r=>wn(r)?sr(t(Eh(r))):Ke,onSuccess:()=>Ke})));var H=e=>{let t=new ka(Fe);return t.i0=e,t},te=e=>w(k(e),B),k=e=>{let t=new xe(Ps);return t.i0=e,t},Bn=l(2,(e,t)=>w(e,r=>{let o=typeof t=="function"?t(r):t;return Fn(o)?nr(o,r):Xu(o)?jr(n=>{o.then(s=>n(H(r))).catch(s=>n(ye(new kO(s))))}):H(r)})),vp=e=>it(t=>{let r=t.getFiberRef(Ca),o=u(r,G(()=>t.scope()));return e(ar(Ca,C(o)))});var Fa=e=>{let t=new xe(_r);return t.i0=ap(qr),t.i1=()=>e,t},Fo=e=>{let t=new xe(_r);return t.i0=ap(qr),t.i1=r=>np(r)?e(Pa):e(Fa),t},Ke=H(void 0),wp=e=>{let t=new xe(_r);return t.i0=e,t.i1=void 0,t};var Un=e=>{let t=new xe(ho);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t};var Kn=e=>{let t=new xe(go);return typeof e?.priority<"u"?rd(t,e.priority):t},La=l(2,(e,t)=>w(e,r=>Z(t,o=>[r,o])));var qa=l(2,(e,t)=>w(e,r=>nr(t,r))),jn=l(2,(e,t)=>w(e,()=>t));var Wn=Ln(()=>{let e=setInterval(()=>{},2147483647);return ce(k(()=>clearInterval(e)))}),jh=e=>w(Ap,t=>u(e,Pp(t))),Pp=l(2,(e,t)=>w(e.interruptAsFork(t),()=>e.await)),Wh={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return x(this,arguments)}},zh={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return x(this,arguments)}},$h={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return x(this,arguments)}},Gh={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return x(this,arguments)}},Np={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return x(this,arguments)}},Mp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return x(this,arguments)}},Vh={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return x(this,arguments)}},Jh={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return x(this,arguments)}};var bO="effect/FiberRef",OO=Symbol.for(bO),_O={_A:e=>e},zn=e=>Yh(e,t=>[t,t]);var $r=l(2,(e,t)=>w(zn(e),t)),bp=l(2,(e,t)=>Yh(e,()=>[void 0,t]));var Yh=l(2,(e,t)=>it(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),H(o)}));var EO="effect/RequestResolver",Qh=Symbol.for(EO),TO={_A:e=>e,_R:e=>e},Mh=class e{runAll;target;[Qh]=TO;constructor(t,r){this.runAll=t,this.target=r,this.runAll=t}[O](){return this.target?d(this.target):jt(this)}[E](t){return this.target?RO(t)&&y(this.target,t.target):this===t}identified(...t){return new e(this.runAll,mn(t))}pipe(){return x(this,arguments)}},RO=e=>b(e,Qh);var ar=l(3,(e,t,r)=>Ep(qa(zn(t),bp(t,r)),()=>e,o=>bp(t,o)));var Se=(e,t)=>Lo(e,{differ:ep(),fork:t?.fork??B,join:t?.join}),Fp=e=>{let t=Xc();return Lo(e,{differ:t,fork:t.empty})},Ha=e=>{let t=Zc();return Lo(e,{differ:t,fork:t.empty})},Lo=(e,t)=>({[OO]:_O,initial:e,diff:(r,o)=>t.differ.diff(r,o),combine:(r,o)=>t.differ.combine(r,o),patch:r=>o=>t.differ.patch(r,o),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return x(this,arguments)}}),Zh=e=>Lo(e,{differ:sp,fork:sp.empty}),Gr=P(Symbol.for("effect/FiberRef/currentContext"),()=>Ha(gn())),$n=P(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Se(0)),Xh=P(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Se(2048)),ed=P(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Se(rr())),Lp=P(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Se(Np)),td=P(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Se(or())),rd=l(2,(e,t)=>ar(e,$n,t));var od=P(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Se("unbounded")),nd=P(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Se(!0)),sd=P(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Se(C(Mp)));var Gn=P(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>Fp(me()));var Ca=P(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Se(R(),{fork:()=>R(),join:(e,t)=>e})),Vn=P(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Se(vo,{fork:()=>vo,join:(e,t)=>e}));var ad=Symbol.for("effect/Scope");var Da=(e,t)=>e.fork(t);var id=function(){class e extends globalThis.Error{commit(){return ye(this)}toString(){return this.message?`${this.name}: ${this.message}`:this.name}toJSON(){return{...this}}[M](){let r=this.stack;return r?`${this.toString()}
${r.split(`
`).slice(1).join(`
`)}`:this.toString()}}return Object.assign(e.prototype,Ji),e}(),Jn=(e,t)=>{class r extends id{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},Fh=Symbol.for("effect/Cause/errors/RuntimeException"),AO=Jn({[Fh]:Fh},"RuntimeException");var Op=Symbol.for("effect/Cause/errors/InterruptedException"),Vk=Jn({[Op]:Op},"InterruptedException"),cd=e=>b(e,Op),Lh=Symbol.for("effect/Cause/errors/IllegalArgument"),IO=Jn({[Lh]:Lh},"IllegalArgumentException");var qh=Symbol.for("effect/Cause/errors/NoSuchElement"),pd=Jn({[qh]:qh},"NoSuchElementException");var Hh=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),Jk=Jn({[Hh]:Hh},"InvalidPubSubCapacityException");var Dh=Symbol.for("effect/Cause/errors/UnknownException"),kO=function(){class e extends id{error;_tag="UnknownException";constructor(r,o){super(o??(b(r,"message")&&yr(r.message)?r.message:void 0)),this.error=r}}return Object.assign(e.prototype,{[Dh]:Dh,name:"UnknownException"}),e}();var qp=(e,t)=>vO(e,t?.parallel?Kr:Ue);var V=e=>{let t=new Ia(Me);return t.i0=e,t};var ld=e=>V(Mt(e)),yp=l(2,(e,t)=>{switch(e._tag){case Me:return V(e.i0);case Fe:return Ie(t(e.i0))}});var CO=l(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case Me:return t(e.i0);case Fe:return r(e.i0)}});var Ie=e=>{let t=new ka(Fe);return t.i0=e,t},ir=Ie(void 0);var ud=l(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case Me:switch(t._tag){case Fe:return V(e.i0);case Me:return V(r(e.i0,t.i0))}case Fe:switch(t._tag){case Fe:return Ie(o(e.i0,t.i0));case Me:return V(t.i0)}}}),vO=(e,t)=>{let r=mn(e);return nt(r)?u(at(r),It(u(st(r),yp(ie)),(o,n)=>u(o,ud(n,{onSuccess:(s,a)=>u(s,ge(a)),onFailure:t}))),yp(Gt),yp(o=>Array.from(o)),C):R()},fd=e=>({[kh]:Ch,state:er(Ta([])),blockingOn:e,pipe(){return x(this,arguments)}});var md=e=>Ln(t=>{let r=Be(e.state);switch(r._tag){case Ea:return ae(r.effect);case No:return u(e.state,xt(Ta([t,...r.joiners]))),ce(wO(e,t))}},e.blockingOn);var Ba=(e,t)=>{let r=Be(e.state);if(r._tag===No){u(e.state,xt(vh(t)));for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},wO=(e,t)=>k(()=>{let r=Be(e.state);r._tag===No&&u(e.state,xt(Ta(r.joiners.filter(o=>o!==t))))}),PO=zn(Gr),hd=()=>PO;var Vr=e=>w(hd(),e),NO=l(2,(e,t)=>ar(Gr,t)(e));var Hp=l(2,(e,t)=>Vr(r=>NO(e,t(r)))),MO=e=>{let t=e.getFiberRef(Gr).unsafeMap.get(Ra);return t!==void 0&&t._tag==="Span"?C(t):R()};var Dp=Symbol.for("effect/Duration"),FO=BigInt(1e3),Bp=BigInt(1e9),dd=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,Lt=e=>{if(Ka(e))return e;if(Y(e))return qo(e);if(et(e))return Yn(e);if(Array.isArray(e)){if(e.length===2&&Y(e[0])&&Y(e[1]))return Yn(BigInt(e[0])*Bp+BigInt(e[1]))}else{dd.lastIndex=0;let t=dd.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Yn(BigInt(o));case"micros":return Up(BigInt(o));case"millis":return qo(s);case"seconds":return Kp(s);case"minutes":return jp(s);case"hours":return Wp(s);case"days":return zp(s);case"weeks":return $p(s)}}}throw new Error("Invalid duration input")},gd={_tag:"Millis",millis:0},LO={_tag:"Infinity"},qO={[Dp]:Dp,[O](){return Cs(this.value)},[E](e){return Ka(e)&&DO(this,e)},toString(){return`Duration(${BO(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:yd(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},qt=e=>{let t=Object.create(qO);return Y(e)?isNaN(e)||e<0?t.value=gd:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=LO:e<BigInt(0)?t.value=gd:t.value={_tag:"Nanos",nanos:e},t},Ka=e=>b(e,Dp),xd=qt(0);var Yn=e=>qt(e),Up=e=>qt(e*FO),qo=e=>qt(e),Kp=e=>qt(e*1e3),jp=e=>qt(e*6e4),Wp=e=>qt(e*36e5),zp=e=>qt(e*864e5),$p=e=>qt(e*6048e5),Ua=e=>{let t=Lt(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var HO=e=>{let t=Lt(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},yd=e=>{let t=Lt(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/Bp),Number(t.value.nanos%Bp)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},Sd=l(2,(e,t)=>{let r=Lt(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),bd=l(3,(e,t,r)=>{let o=Lt(e),n=Lt(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Ua(o),Ua(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),a=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,a)}return r.onMillis(o.value.millis,n.value.millis)});var Gp=(e,t)=>bd(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var Od=l(2,(e,t)=>bd(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),DO=l(2,(e,t)=>Gp(Lt(e),Lt(t))),BO=e=>{let t=Lt(e),r=[];if(t.value._tag==="Infinity")return"Infinity";let o=HO(t);o%1000000n&&r.push(`${o%1000000n}ns`);let n=o/1000000n;n%1000n!==0n&&r.push(`${n%1000n}ms`);let s=n/1000n;s%60n!==0n&&r.push(`${s%60n}s`);let a=s/60n;a%60n!==0n&&r.push(`${a%60n}m`);let i=a/60n;i%24n!==0n&&r.push(`${i%24n}h`);let c=i/24n;return c!==0n&&r.push(`${c}d`),r.reverse().join(" ")};var je=Sf;var _d=Symbol.for("effect/MutableHashMap"),WO={[_d]:_d,[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()},toString(){return q(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},zO=e=>{let t=Object.create(WO);return t.backingMap=er(e),t},Ed=()=>zO(rr());var cr=l(2,(e,t)=>On(e.backingMap.current,t)),Ho=l(2,(e,t)=>$(cr(e,t)));var Do=l(3,(e,t,r)=>(Im(e.backingMap,Io(t,r)),e));var Td=typeof process>"u"?!1:!!process?.isBun,Rd=Td?e=>clearInterval(e):e=>clearTimeout(e),Wa=Td?(e,t)=>{let r=setInterval(()=>{e(),clearInterval(r)},t);return r}:(e,t)=>setTimeout(e,t);var GO="effect/Clock",Jp=Symbol.for(GO),Qn=De(Jp),VO=2**31-1,Id={unsafeSchedule(e,t){let r=Ua(t);if(r>VO)return no;let o=!1,n=Wa(()=>{o=!0,e()},r);return()=>(Rd(n),!o)}},kd=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6));return()=>t+BigInt(Math.round(performance.now()*1e6))}(),JO=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return kd;let t=kd()-e.bigint();return()=>t+e.bigint()}(),Yp=class{[Jp]=Jp;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return JO()}currentTimeMillis=k(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=k(()=>this.unsafeCurrentTimeNanos());scheduler(){return H(Id)}sleep(t){return Ln(r=>{let o=Id.unsafeSchedule(()=>r(Ke),t);return ce(sr(k(o)))})}},Cd=()=>new Yp;var Qp="And",Zp="Or",Xp="InvalidData",el="MissingData",tl="SourceUnavailable",rl="Unsupported";var QO="effect/ConfigError",wd=Symbol.for(QO),Bo={[wd]:wd},ol=(e,t)=>{let r=Object.create(Bo);return r._tag=Qp,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},nl=(e,t)=>{let r=Object.create(Bo);return r._tag=Zp,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},ZO=(e,t,r={pathDelim:"."})=>{let o=Object.create(Bo);return o._tag=Xp,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${u(this.path,ht(r.pathDelim))}: "${this.message}")`}}),o},Ht=(e,t,r={pathDelim:"."})=>{let o=Object.create(Bo);return o._tag=el,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${u(this.path,ht(r.pathDelim))}: "${this.message}")`}}),o},XO=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(Bo);return n._tag=tl,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${u(this.path,ht(o.pathDelim))}: "${this.message}")`}}),n},e_=(e,t,r={pathDelim:"."})=>{let o=Object.create(Bo);return o._tag=rl,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${u(this.path,ht(r.pathDelim))}: "${this.message}")`}}),o};var pr=l(2,(e,t)=>{switch(e._tag){case Qp:return ol(pr(e.left,t),pr(e.right,t));case Zp:return nl(pr(e.left,t),pr(e.right,t));case Xp:return ZO([...t,...e.path],e.message);case el:return Ht([...t,...e.path],e.message);case tl:return XO([...t,...e.path],e.message,e.cause);case rl:return e_([...t,...e.path],e.message)}});var Nd={_tag:"Empty"};var za=l(2,(e,t)=>{let r=Tn(t),o=e;for(;En(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=Pt(n.first,Pt(n.second,r.tail));break}case"MapName":{o=Re(o,n.f),r=r.tail;break}case"Nested":{o=rt(o,n.name),r=r.tail;break}case"Unnested":{if(u(Ds(o),Rf(n.name)))o=mt(o),r=r.tail;else return ce(Ht(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return ae(o)});var Md="Constant",Fd="Fail",Ld="Fallback",qd="Described",Hd="Lazy",Dd="MapOrFail",Bd="Nested",Ud="Primitive",Kd="Sequence",jd="HashMap",Wd="ZipWith";var $a=(e,t)=>[...e,...t],o_="effect/ConfigProvider",sl=Symbol.for(o_),$d=De(sl),n_="effect/ConfigProviderFlat",zd=Symbol.for(n_),s_=e=>({[sl]:sl,pipe(){return x(this,arguments)},...e}),a_=e=>({[zd]:zd,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),i_=e=>s_({load:t=>w(Ye(e,Rr(),t,!1),r=>se(Ds(r),{onNone:()=>ye(Ht(Rr(),`Expected a single value having structure: ${t}`)),onSome:H})),flattened:e}),Gd=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=c=>u(c,ht(t)),n=c=>c.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return i_(a_({load:(c,p,f=!0)=>{let m=o(c),h=s(),g=m in h?C(h[m]):R();return u(g,Dn(()=>Ht(c,`Expected ${m} to exist in the process context`)),w(S=>f_(S,c,p,r,f)))},enumerateChildren:c=>k(()=>{let p=s(),f=Object.keys(p),h=Array.from(f).map(g=>n(g.toUpperCase())).filter(g=>{for(let S=0;S<c.length;S++){let I=u(c,hc(S)),T=g[S];if(T===void 0||I!==T)return!1}return!0}).flatMap(g=>g.slice(c.length,c.length+1));return Xt(h)}),patch:Nd}))};var c_=(e,t,r,o)=>{let n=yc(r.length,c=>c>=o.length?R():C([e(c),c+1])),s=yc(o.length,c=>c>=r.length?R():C([t(c),c+1])),a=$a(r,n),i=$a(o,s);return[a,i]},p_=(e,t)=>{let r=t;if(r._tag==="Nested"){let o=e.slice();for(;r._tag==="Nested";)o.push(r.name),r=r.config;return o}return e},Ye=(e,t,r,o)=>{let n=r;switch(n._tag){case Md:return H(qe(n.value));case qd:return te(()=>Ye(e,t,n.config,o));case Fd:return ye(Ht(t,n.message));case Ld:return u(te(()=>Ye(e,t,n.first,o)),wa(s=>n.condition(s)?u(Ye(e,t,n.second,o),wa(a=>ye(nl(s,a)))):ye(s)));case Hd:return te(()=>Ye(e,t,n.config(),o));case Dd:return te(()=>u(Ye(e,t,n.original,o),w(ct(s=>u(n.mapOrFail(s),Dn(pr(p_(t,n.original))))))));case Bd:return te(()=>Ye(e,$a(t,qe(n.name)),n.config,o));case Ud:return u(za(t,e.patch),w(s=>u(e.load(s,n,o),w(a=>{if(a.length===0){let i=u(Bs(s),G(()=>"<n/a>"));return ye(Ht([],`Expected ${n.description} with name ${i}`))}return H(a)}))));case Kd:return u(za(t,e.patch),w(s=>u(e.enumerateChildren(s),w(d_),w(a=>a.length===0?te(()=>Z(Ye(e,s,n.config,!0),qe)):u(ct(a,i=>Ye(e,vf(t,`[${i}]`),n.config,!0)),Z(i=>{let c=xc(i);return c.length===0?qe(Rr()):qe(c)}))))));case jd:return te(()=>u(za(t,e.patch),w(s=>u(e.enumerateChildren(s),w(a=>u(a,ct(i=>Ye(e,$a(s,qe(i)),n.valueConfig,o)),Z(i=>{if(i.length===0)return qe(rr());let c=i.map(p=>Array.from(p));return u(m_(c),Re(p=>bn(gc(Te(a),p))))})))))));case Wd:return te(()=>u(Ye(e,t,n.left,o),Wr,w(s=>u(Ye(e,t,n.right,o),Wr,w(a=>{if(pe(s)&&pe(a))return ye(ol(s.left,a.left));if(pe(s)&&tt(a))return ye(s.left);if(tt(s)&&pe(a))return ye(a.left);if(tt(s)&&tt(a)){let i=u(t,ht(".")),c=l_(t,i),[p,f]=c_(c,c,u(s.right,Re(ae)),u(a.right,Re(ae)));return u(p,gc(f),ct(([m,h])=>u(La(m,h),Z(([g,S])=>n.zip(g,S)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},l_=(e,t)=>r=>ce(Ht(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var u_=(e,t)=>e.split(new RegExp(`\\s*${h_(t)}\\s*`)),f_=(e,t,r,o,n)=>n?u(u_(e,o),ct(s=>r.parse(s.trim())),Dn(pr(t))):u(r.parse(e),Na({onFailure:pr(t),onSuccess:qe})),m_=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),h_=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),d_=e=>u(ct(e,x_),Na({onFailure:()=>Rr(),onSuccess:Tr(je)}),Wr,Z(kf));var g_=/^(\[(\d+)\])$/,x_=e=>{let t=e.match(g_);if(t!==null){let r=t[2];return u(r!==void 0&&r.length>0?C(r):R(),un(y_))}return R()};var y_=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?R():C(t)};var al=Symbol.for("effect/Console"),Ga=De(al),Vd={[al]:al,assert(e,...t){return k(()=>{console.assert(e,...t)})},clear:k(()=>{console.clear()}),count(e){return k(()=>{console.count(e)})},countReset(e){return k(()=>{console.countReset(e)})},debug(...e){return k(()=>{console.debug(...e)})},dir(e,t){return k(()=>{console.dir(e,t)})},dirxml(...e){return k(()=>{console.dirxml(...e)})},error(...e){return k(()=>{console.error(...e)})},group(e){return e?.collapsed?k(()=>console.groupCollapsed(e?.label)):k(()=>console.group(e?.label))},groupEnd:k(()=>{console.groupEnd()}),info(...e){return k(()=>{console.info(...e)})},log(...e){return k(()=>{console.log(...e)})},table(e,t){return k(()=>{console.table(e,t)})},time(e){return k(()=>console.time(e))},timeEnd(e){return k(()=>console.timeEnd(e))},timeLog(e,...t){return k(()=>{console.timeLog(e,...t)})},trace(...e){return k(()=>{console.trace(...e)})},warn(...e){return k(()=>{console.warn(...e)})},unsafe:console};var O_="effect/Random",il=Symbol.for(O_),Jd=De(il),cl=class{seed;[il]=il;PRNG;constructor(t){this.seed=t,this.PRNG=new co(t)}get next(){return k(()=>this.PRNG.number())}get nextBoolean(){return Z(this.next,t=>t>.5)}get nextInt(){return k(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return Z(this.next,o=>(r-t)*o+t)}nextIntBetween(t,r){return k(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return __(t,r=>this.nextIntBetween(0,r))}},__=(e,t)=>te(()=>u(k(()=>Array.from(e)),w(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return u(o,zr(n=>u(t(n),Z(s=>E_(r,n-1,s)))),nr(mn(r)))}))),E_=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},Yd=e=>new cl(e);var I_=u(gn(),Ir(Qn,Cd()),Ir(Ga,Vd),Ir(Jd,Yd(Math.random()*4294967296>>>0)),Ir($d,Gd()),Ir(Nn,Ph)),Uo=P(Symbol.for("effect/DefaultServices/currentServices"),()=>Ha(I_));var pl=Symbol.for("effect/FiberRefs"),Ko=class{locals;[pl]=pl;constructor(t){this.locals=t}pipe(){return x(this,arguments)}},C_=(e,t,r,o=!1)=>{let n=e,s=t,a=r,i=o,c;for(;c===void 0;)if(Le(s)&&Le(a)){let p=le(s)[0],f=mt(s),m=le(a)[0],h=le(a)[1],g=mt(a);p.startTimeMillis<m.startTimeMillis?(a=g,i=!0):p.startTimeMillis>m.startTimeMillis?s=f:p.id<m.id?(a=g,i=!0):p.id>m.id?s=f:c=[h,i]}else c=[n.initial,!0];return c},ll=l(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let a=le(s)[1];if(!y(le(s)[0],t)){if(!o.has(n)){if(y(a,n.initial))continue;o.set(n,[[t,n.join(n.initial,a)]]);continue}let i=o.get(n),[c,p]=C_(n,i,s);if(p){let f=n.diff(c,a),m=le(i)[1],h=n.join(m,n.patch(f)(m));if(!y(m,h)){let g,S=le(i)[0];y(S,t)?g=rt([S,h])(mt(i)):g=rt([t,h])(i),o.set(n,g)}}}}return new Ko(new Map(o))}),ul=l(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=le(n)[1],a=o.patch(o.fork)(s);y(s,a)?r.set(o,n):r.set(o,rt([t,a])(n))}return new Ko(r)});var Zn=l(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Ko(r)}),Xn=l(2,(e,t)=>e.locals.has(t)?C(le(e.locals.get(t))[1]):R()),jo=l(2,(e,t)=>u(Xn(e,t),G(()=>t.initial))),Wo=l(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):Rr(),s;if(mc(n))s=qe([t,o]);else{let[i,c]=le(n);if(y(i,t)){if(y(c,o))return e;s=rt([t,o])(mt(n))}else s=rt([t,o])(n)}let a=new Map(e.locals);return new Ko(a.set(r,s))});var Qd=jo;var w_=Wh,P_=zh,N_=$h,M_=Gh,F_=Np,L_=Mp,q_=Vh,H_=Jh;var D_=u(je,ln(e=>e.ordinal));var Zd=rc(D_);var Xd=e=>{switch(e){case"All":return w_;case"Debug":return L_;case"Error":return N_;case"Fatal":return P_;case"Info":return F_;case"Trace":return q_;case"None":return H_;case"Warning":return M_}};var eg=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var tg=eg;var rg="Empty",og="Add",ng="Remove",sg="Update",ag="AndThen",ig={_tag:rg},cg=(e,t)=>{let r=new Map(e.locals),o=ig;for(let[n,s]of t.locals.entries()){let a=le(s)[1],i=r.get(n);if(i!==void 0){let c=le(i)[1];y(c,a)||(o=Va({_tag:sg,fiberRef:n,patch:n.diff(c,a)})(o))}else o=Va({_tag:og,fiberRef:n,value:a})(o);r.delete(n)}for(let[n]of r.entries())o=Va({_tag:ng,fiberRef:n})(o);return o},Va=l(2,(e,t)=>({_tag:ag,first:e,second:t})),pg=l(3,(e,t,r)=>{let o=r,n=qe(e);for(;Le(n);){let s=le(n),a=mt(n);switch(s._tag){case rg:{n=a;break}case og:{o=Wo(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=a;break}case ng:{o=Zn(o,s.fiberRef),n=a;break}case sg:{let i=jo(o,s.fiberRef);o=Wo(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(i)}),n=a;break}case ag:{n=rt(s.first)(rt(s.second)(a));break}}}return o});var lg="effect/MetricLabel",ml=Symbol.for(lg),hl=class{key;value;[ml]=ml;constructor(t,r){this.key=t,this.value=r}[O](){return u(d(lg),_(d(this.key)),_(d(this.value)))}[E](t){return W_(t)&&this.key===t.key&&this.value===t.value}pipe(){return x(this,arguments)}},ug=(e,t)=>new hl(e,t),W_=e=>b(e,ml);var dl=Vi;var $_="Sequential",G_="Parallel",V_="ParallelN",fg={_tag:$_},mg={_tag:G_},hg=e=>({_tag:V_,parallelism:e});var Ja=fg,Ya=mg,Qa=hg;var dg=cg;var gg=pg;var Za="effect/FiberStatus",lr=Symbol.for(Za),gl="Done",xg="Running",yg="Suspended",xl=class{[lr]=lr;_tag=gl;[O](){return u(d(Za),_(d(this._tag)))}[E](t){return Xa(t)&&t._tag===gl}},yl=class{runtimeFlags;[lr]=lr;_tag=xg;constructor(t){this.runtimeFlags=t}[O](){return u(d(Za),_(d(this._tag)),_(d(this.runtimeFlags)))}[E](t){return Xa(t)&&t._tag===xg&&this.runtimeFlags===t.runtimeFlags}},Sl=class{runtimeFlags;blockingOn;[lr]=lr;_tag=yg;constructor(t,r){this.runtimeFlags=t,this.blockingOn=r}[O](){return u(d(Za),_(d(this._tag)),_(d(this.runtimeFlags)),_(d(this.blockingOn)))}[E](t){return Xa(t)&&t._tag===yg&&this.runtimeFlags===t.runtimeFlags&&y(this.blockingOn,t.blockingOn)}},Sg=new xl,bg=e=>new yl(e),Og=(e,t)=>new Sl(e,t),Xa=e=>b(e,lr),_g=e=>e._tag===gl;var Eg=Sg,bl=bg,Tg=Og;var Rg=_g;var Ol=class{buckets=[];scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let a=0;a<n;a++)s.push(this.buckets[a]);s.push([r,[t]]);for(let a=n;a<this.buckets.length;a++)s.push(this.buckets[a]);this.buckets=s}}},_l=class{maxNextTickBeforeTimer;running=!1;tasks=new Ol;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?Wa(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(Xh)?t.getFiberRef($n):!1}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},eE=P(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new _l(2048));var El=P(Symbol.for("effect/FiberRef/currentScheduler"),()=>Se(eE));var ei=P(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Se(new Map));var Tl=(e,t,r,o)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return $r(od,n=>n==="unbounded"?r():n>1?o(n):t());default:return e>1?o(e):t()}};var ti="InterruptSignal",ri="Stateful",oi="Resume",ni="YieldNow",si=e=>({_tag:ti,cause:e}),zo=e=>({_tag:ri,onFiber:e}),Jr=e=>({_tag:oi,effect:e}),Ag=()=>({_tag:ni});var oE="effect/FiberScope",ai=Symbol.for(oE),Rl=class{[ai]=ai;fiberId=wt;roots=new Set;add(t,r){this.roots.add(r),r.addObserver(()=>{this.roots.delete(r)})}},Al=class{fiberId;parent;[ai]=ai;constructor(t,r){this.fiberId=t,this.parent=r}add(t,r){this.parent.tell(zo(o=>{o.addChild(r),r.addObserver(()=>{o.removeChild(r)})}))}},kg=e=>new Al(e.id(),e),Il=P(Symbol.for("effect/FiberScope/Global"),()=>new Rl);var aE="effect/Fiber",kl=Symbol.for(aE),Cl={_E:e=>e,_A:e=>e},iE={[kl]:Cl,pipe(){return x(this,arguments)}},cE="effect/Fiber",Cg=Symbol.for(cE);var vg=e=>e.await;var wg=e=>qa(Hn(e.await),e.inheritAll);var ZC={...iE,id:()=>wt,await:Wn,children:H([]),inheritAll:Wn,poll:H(R()),interruptAsFork:()=>Wn};var ur="effect/FiberCurrent";var lE="effect/Logger",Pg=Symbol.for(lE),Ng={_Message:e=>e,_Output:e=>e},ci=e=>({[Pg]:Ng,log:e,pipe(){return x(this,arguments)}});var tv={[Pg]:Ng,log:Hi,pipe(){return x(this,arguments)}};var Mg=ci(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:a})=>{let i=r.getTime(),p=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${aa(o)}`].join(" "),f=ii(s);if(f.length>0&&(p=p+" message=",p=vl(f,p)),t!=null&&t._tag!=="Empty"&&(p=p+" cause=",p=vl(Pn(t),p)),En(a)){p=p+" ";let m=!0;for(let h of a)m?m=!1:p=p+" ",p=p+u(h,tg(i))}if(u(e,Gc)>0){p=p+" ";let m=!0;for(let[h,g]of e)m?m=!1:p=p+" ",p=p+mE(h),p=p+"=",p=vl(ii(g),p)}return p}),ii=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},uE=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,fE=/^[^\s"=]+$/,vl=(e,t)=>t+(e.match(fE)?e:uE(e));var mE=e=>e.replace(/[\s="]/g,"_");var Fg="effect/MetricBoundaries",wl=Symbol.for(Fg),Pl=class{values;[wl]=wl;constructor(t){this.values=t}[O](){return u(d(Fg),_(d(this.values)))}[E](t){return dE(t)&&y(this.values,t.values)}pipe(){return x(this,arguments)}},dE=e=>b(e,wl),gE=e=>{let t=u(e,Ge(ie(Number.POSITIVE_INFINITY)),Uf);return new Pl(t)};var Lg=e=>u(fc(e.count-1,t=>e.start*Math.pow(e.factor,t)),Ct,gE);var yE="effect/MetricKeyType",es=Symbol.for(yE),Bg="effect/MetricKeyType/Counter",Nl=Symbol.for(Bg),Ug="effect/MetricKeyType/Frequency",Ml=Symbol.for(Ug),Kg="effect/MetricKeyType/Gauge",Fl=Symbol.for(Kg),jg="effect/MetricKeyType/Histogram",Ll=Symbol.for(jg),Wg="effect/MetricKeyType/Summary",ql=Symbol.for(Wg),ts={_In:e=>e,_Out:e=>e},Hl=class{incremental;bigint;[es]=ts;[Nl]=Nl;constructor(t,r){this.incremental=t,this.bigint=r}[O](){return d(Bg)}[E](t){return Bl(t)}pipe(){return x(this,arguments)}},qg=class{[es]=ts;[Ml]=Ml;[O](){return d(Ug)}[E](t){return Ul(t)}pipe(){return x(this,arguments)}},Hg=class{bigint;[es]=ts;[Fl]=Fl;constructor(t){this.bigint=t}[O](){return d(Kg)}[E](t){return Kl(t)}pipe(){return x(this,arguments)}},Dl=class{boundaries;[es]=ts;[Ll]=Ll;constructor(t){this.boundaries=t}[O](){return u(d(jg),_(d(this.boundaries)))}[E](t){return jl(t)&&y(this.boundaries,t.boundaries)}pipe(){return x(this,arguments)}},Dg=class{maxAge;maxSize;error;quantiles;[es]=ts;[ql]=ql;constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n}[O](){return u(d(Wg),_(d(this.maxAge)),_(d(this.maxSize)),_(d(this.error)),_(d(this.quantiles)))}[E](t){return Wl(t)&&y(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&y(this.quantiles,t.quantiles)}pipe(){return x(this,arguments)}},zg=e=>new Hl(e?.incremental??!1,e?.bigint??!1);var $g=e=>new Dl(e);var Bl=e=>b(e,Nl),Ul=e=>b(e,Ml),Kl=e=>b(e,Fl),jl=e=>b(e,Ll),Wl=e=>b(e,ql);var SE="effect/MetricKey",Vg=Symbol.for(SE),bE={_Type:e=>e},rs=class{name;keyType;description;tags;[Vg]=bE;constructor(t,r,o,n=me()){this.name=t,this.keyType=r,this.description=o,this.tags=n}[O](){return u(d(this.name),_(d(this.keyType)),_(d(this.description)),_(d(this.tags)))}[E](t){return OE(t)&&this.name===t.name&&y(this.keyType,t.keyType)&&y(this.description,t.description)&&y(this.tags,t.tags)}pipe(){return x(this,arguments)}},OE=e=>b(e,Vg),Jg=(e,t)=>new rs(e,zg(t),ft(t?.description));var Yg=(e,t,r)=>new rs(e,$g(t),ft(r));var Qg=l(2,(e,t)=>wr(t)===0?e:new rs(e.name,e.keyType,e.description,u(e.tags,Ae(t))));var EE="effect/MetricState",os=Symbol.for(EE),Zg="effect/MetricState/Counter",zl=Symbol.for(Zg),Xg="effect/MetricState/Frequency",$l=Symbol.for(Xg),ex="effect/MetricState/Gauge",Gl=Symbol.for(ex),tx="effect/MetricState/Histogram",Vl=Symbol.for(tx),rx="effect/MetricState/Summary",Jl=Symbol.for(rx),ns={_A:e=>e},Yl=class{count;[os]=ns;[zl]=zl;constructor(t){this.count=t}[O](){return u(d(Zg),_(d(this.count)))}[E](t){return TE(t)&&this.count===t.count}pipe(){return x(this,arguments)}},Ql=class{occurrences;[os]=ns;[$l]=$l;constructor(t){this.occurrences=t}[O](){return u(d(Xg),_(d(this.occurrences)))}[E](t){return RE(t)&&y(this.occurrences,t.occurrences)}pipe(){return x(this,arguments)}},Zl=class{value;[os]=ns;[Gl]=Gl;constructor(t){this.value=t}[O](){return u(d(ex),_(d(this.value)))}[E](t){return AE(t)&&this.value===t.value}pipe(){return x(this,arguments)}},Xl=class{buckets;count;min;max;sum;[os]=ns;[Vl]=Vl;constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s}[O](){return u(d(tx),_(d(this.buckets)),_(d(this.count)),_(d(this.min)),_(d(this.max)),_(d(this.sum)))}[E](t){return IE(t)&&y(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return x(this,arguments)}},eu=class{error;quantiles;count;min;max;sum;[os]=ns;[Jl]=Jl;constructor(t,r,o,n,s,a){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=a}[O](){return u(d(rx),_(d(this.error)),_(d(this.quantiles)),_(d(this.count)),_(d(this.min)),_(d(this.max)),_(d(this.sum)))}[E](t){return kE(t)&&this.error===t.error&&y(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return x(this,arguments)}},ox=e=>new Yl(e),nx=e=>new Ql(e),sx=e=>new Zl(e),ax=e=>new Xl(e.buckets,e.count,e.min,e.max,e.sum),ix=e=>new eu(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var TE=e=>b(e,zl),RE=e=>b(e,$l),AE=e=>b(e,Gl),IE=e=>b(e,Vl),kE=e=>b(e,Jl);var vE="effect/MetricHook",wE=Symbol.for(vE),PE={_In:e=>e,_Out:e=>e},ss=e=>({[wE]:PE,pipe(){return x(this,arguments)},...e});var cx=BigInt(0),lx=e=>{let t=e.keyType.bigint?cx:0,r=e.keyType.incremental?e.keyType.bigint?o=>o>=cx:o=>o>=0:o=>!0;return ss({get:()=>ox(t),update:o=>{r(o)&&(t=t+o)}})},ux=e=>{let t=0,r=new Map,o=s=>{t=t+1;let a=r.get(s)??0;r.set(s,a+1)},n=()=>bn(r.entries());return ss({get:()=>nx(n()),update:o})},fx=(e,t)=>{let r=t;return ss({get:()=>sx(r),update:o=>{r=o}})},mx=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,a=0,i=Number.MAX_VALUE,c=Number.MIN_VALUE;u(t,Ks(je),Oc((m,h)=>{n[h]=m}));let p=m=>{let h=0,g=r;for(;h!==g;){let S=Math.floor(h+(g-h)/2),I=n[S];m<=I?g=S:h=S,g===h+1&&(m<=n[h]?g=h:h=g)}o[h]=o[h]+1,s=s+1,a=a+m,m<i&&(i=m),m>c&&(c=m)},f=()=>{let m=Array(r),h=0;for(let g=0;g<r;g++){let S=n[g],I=o[g];h=h+I,m[g]=[S,h]}return Ct(m)};return ss({get:()=>ax({buckets:f(),count:s,min:i,max:c,sum:a}),update:p})},hx=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=u(n,Ks(je)),a=Array(o),i=0,c=0,p=0,f=Number.MAX_VALUE,m=Number.MIN_VALUE,h=S=>{let I=[],T=0;for(;T!==o-1;){let v=a[T];if(v!=null){let[N,L]=v,W=qo(S-N);Od(W,xd)&&W<=r&&I.push(L)}T=T+1}return NE(t,s,u(Ct(I),Ks(je)))},g=(S,I)=>{if(o>0){i=i+1;let T=i%o;a[T]=[I,S]}c=c+1,p=p+S,S<f&&(f=S),S>m&&(m=S)};return ss({get:()=>ix({error:t,quantiles:h(Date.now()),count:c,min:f,max:m,sum:p}),update:([S,I])=>g(S,I)})},NE=(e,t,r)=>{let o=r.length;if(hn(t))return He();let n=Ar(t),s=u(t,So(1)),a=u(s,It(ie(px(e,o,R(),0,n,r)),(i,c)=>{let p=Ar(i);return u(i,Hf(px(e,o,p.value,p.consumed,c,p.rest)))}));return u(a,Oc(i=>[i.quantile,i.value]))},px=(e,t,r,o,n,s)=>{let a=e,i=t,c=r,p=o,f=n,m=s,h=e,g=t,S=r,I=o,T=n,v=s;for(;;){if(hn(m))return{quantile:f,value:R(),consumed:p,rest:He()};if(f===1)return{quantile:f,value:C(Df(m)),consumed:p+m.length,rest:He()};let N=u(m,Bf(ne=>ne>Ar(m))),L=f*i,W=a/2*L,D=p+N[0].length,oe=Math.abs(D-L);if(D<L-W){h=a,g=i,S=dn(m),I=D,T=f,v=N[1],a=h,i=g,c=S,p=I,f=T,m=v;continue}if(D>L+W)return{quantile:f,value:c,consumed:p,rest:m};switch(c._tag){case"None":{h=a,g=i,S=dn(m),I=D,T=f,v=N[1],a=h,i=g,c=S,p=I,f=T,m=v;continue}case"Some":{let ne=Math.abs(L-c.value);if(oe<ne){h=a,g=i,S=dn(m),I=D,T=f,v=N[1],a=h,i=g,c=S,p=I,f=T,m=v;continue}return{quantile:f,value:C(c.value),consumed:p,rest:m}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var FE="effect/MetricPair",LE=Symbol.for(FE),qE={_Type:e=>e};var dx=(e,t)=>({[LE]:qE,metricKey:e,metricState:t,pipe(){return x(this,arguments)}});var DE="effect/MetricRegistry",gx=Symbol.for(DE),tu=class{[gx]=gx;map=Ed();snapshot(){let t=[];for(let[r,o]of this.map)t.push(dx(r,o.get()));return Xt(t)}get(t){let r=u(this.map,cr(t),At);if(r==null){if(Bl(t.keyType))return this.getCounter(t);if(Kl(t.keyType))return this.getGauge(t);if(Ul(t.keyType))return this.getFrequency(t);if(jl(t.keyType))return this.getHistogram(t);if(Wl(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return r}getCounter(t){let r=u(this.map,cr(t),At);if(r==null){let o=lx(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getFrequency(t){let r=u(this.map,cr(t),At);if(r==null){let o=ux(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getGauge(t){let r=u(this.map,cr(t),At);if(r==null){let o=fx(t,t.keyType.bigint?BigInt(0):0);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getHistogram(t){let r=u(this.map,cr(t),At);if(r==null){let o=mx(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}getSummary(t){let r=u(this.map,cr(t),At);if(r==null){let o=hx(t);u(this.map,Ho(t))||u(this.map,Do(t,o)),r=o}return r}},xx=()=>new tu;var UE="effect/Metric",KE=Symbol.for(UE),jE={_Type:e=>e,_In:e=>e,_Out:e=>e},WE=P(Symbol.for("effect/Metric/globalMetricRegistry"),()=>xx()),yx=function(e,t,r){return Object.assign(n=>Bn(n,s=>k(()=>t(s,me()))),{[KE]:jE,keyType:e,unsafeUpdate:t,unsafeValue:r,register(){return this.unsafeValue(me()),this},pipe(){return x(this,arguments)}})};var as=(e,t)=>Sx(Jg(e,t));var Sx=e=>{let t=r=>{let o=u(e,Qg(r));return WE.get(o)};return yx(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var bx=(e,t,r)=>Sx(Yg(e,t,r));var Ox=l(3,(e,t,r)=>zE(e,dt(ug(t,r))));var zE=l(2,(e,t)=>{let r=Em(t)?t:Xt(t);return yx(e.keyType,(o,n)=>e.unsafeUpdate(o,u(r,Ae(n))),o=>e.unsafeValue(u(r,Ae(o))))});var GE="effect/Request",VE=Symbol.for(GE),JE={_E:e=>e,_A:e=>e},vv={...pn,[VE]:JE};var _x=l(2,(e,t)=>$r(ei,r=>k(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,Ba(o.result,t))}})));var fr={Forward:0,Backward:1},pi=class e{self;stack;direction;count=0;constructor(t,r,o){this.self=t,this.stack=r,this.direction=o}clone(){return new e(this.self,this.stack.slice(),this.direction)}reversed(){return new e(this.self,this.stack.slice(),this.direction===fr.Forward?fr.Backward:fr.Forward)}next(){let t=this.entry;switch(this.count++,this.direction===fr.Forward?this.moveNext():this.movePrev(),t._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:t.value}}}get key(){return this.stack.length>0?C(this.stack[this.stack.length-1].key):R()}get value(){return this.stack.length>0?C(this.stack[this.stack.length-1].value):R()}get entry(){return ue(Bs(this.stack),t=>[t.key,t.value])}get index(){let t=0,r=this.stack;if(r.length===0){let o=this.self._root;return o!=null?o.count:0}else r[r.length-1].left!=null&&(t=r[r.length-1].left.count);for(let o=r.length-2;o>=0;--o)r[o+1]===r[o].right&&(++t,r[o].left!=null&&(t+=r[o].left.count));return t}moveNext(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r.right!=null)for(r=r.right;r!=null;)t.push(r),r=r.left;else for(t.pop();t.length>0&&t[t.length-1].right===r;)r=t[t.length-1],t.pop()}get hasNext(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].right!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].left===t[r])return!0;return!1}movePrev(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r!=null&&r.left!=null)for(r=r.left;r!=null;)t.push(r),r=r.right;else for(t.pop();t.length>0&&t[t.length-1].left===r;)r=t[t.length-1],t.pop()}get hasPrev(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].left!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].right===t[r])return!0;return!1}};var A={Red:0,Black:1},We=class{color;key;value;left;right;count;constructor(t,r,o,n,s,a){this.color=t,this.key=r,this.value=o,this.left=n,this.right=s,this.count=a}};function pt(e){return new We(e.color,e.key,e.value,e.left,e.right,e.count)}function ru(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}function Dt(e,t){return new We(t,e.key,e.value,e.left,e.right,e.count)}function J(e){e.count=1+(e.left?.count??0)+(e.right?.count??0)}var Ex="effect/RedBlackTree",ou=Symbol.for(Ex),QE={_Key:e=>e,_Value:e=>e},ZE={[ou]:QE,[O](){let e=d(Ex);for(let t of this)e^=u(d(t[0]),_(d(t[1])));return e},[E](e){if(Tx(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((r,o)=>{let n=t[o];return y(r[0],n[0])&&y(r[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;t!=null;)e.push(t),t=t.left;return new pi(this,e,fr.Forward)},toString(){return q(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},is=(e,t)=>{let r=Object.create(ZE);return r._ord=e,r._root=t,r},Tx=e=>b(e,ou);var Rx=l(2,(e,t)=>{let r=e._ord,o=e._root;for(;o!==void 0;){let n=r(t,o.key);if(y(t,o.key))return C(o.value);n<=0?o=o.left:o=o.right}return R()});var nu=l(2,(e,t)=>$(Rx(e,t))),Ax=l(3,(e,t,r)=>{let o=e._ord,n=e._root,s=[],a=[];for(;n!=null;){let i=o(t,n.key);s.push(n),a.push(i),i<=0?n=n.left:n=n.right}s.push(new We(A.Red,t,r,void 0,void 0,1));for(let i=s.length-2;i>=0;--i){let c=s[i];a[i]<=0?s[i]=new We(c.color,c.key,c.value,s[i+1],c.right,c.count+1):s[i]=new We(c.color,c.key,c.value,c.left,s[i+1],c.count+1)}for(let i=s.length-1;i>1;--i){let c=s[i-1],p=s[i];if(c.color===A.Black||p.color===A.Black)break;let f=s[i-2];if(f.left===c)if(c.left===p){let m=f.right;if(m&&m.color===A.Red)c.color=A.Black,f.right=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(f.color=A.Red,f.left=c.right,c.color=A.Black,c.right=f,s[i-2]=c,s[i-1]=p,J(f),J(c),i>=3){let h=s[i-3];h.left===f?h.left=c:h.right=c}break}}else{let m=f.right;if(m&&m.color===A.Red)c.color=A.Black,f.right=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(c.right=p.left,f.color=A.Red,f.left=p.right,p.color=A.Black,p.left=c,p.right=f,s[i-2]=p,s[i-1]=c,J(f),J(c),J(p),i>=3){let h=s[i-3];h.left===f?h.left=p:h.right=p}break}}else if(c.right===p){let m=f.left;if(m&&m.color===A.Red)c.color=A.Black,f.left=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(f.color=A.Red,f.right=c.left,c.color=A.Black,c.left=f,s[i-2]=c,s[i-1]=p,J(f),J(c),i>=3){let h=s[i-3];h.right===f?h.right=c:h.left=c}break}}else{let m=f.left;if(m&&m.color===A.Red)c.color=A.Black,f.left=Dt(m,A.Black),f.color=A.Red,i-=1;else{if(c.left=p.right,f.color=A.Red,f.right=p.left,p.color=A.Black,p.right=c,p.left=f,s[i-2]=p,s[i-1]=c,J(f),J(c),J(p),i>=3){let h=s[i-3];h.right===f?h.right=p:h.left=p}break}}}return s[0].color=A.Black,is(e._ord,s[0])}),Ix=e=>kx(e,fr.Forward);var kx=(e,t)=>{let r=e[Symbol.iterator](),o=0;return{[Symbol.iterator]:()=>kx(e,t),next:()=>{o++;let n=r.key;switch(t===fr.Forward?r.moveNext():r.movePrev(),n._tag){case"None":return{done:!0,value:o};case"Some":return{done:!1,value:n.value}}}}};var Cx=l(2,(e,t)=>{if(!nu(e,t))return e;let r=e._ord,o=r,n=e._root,s=[];for(;n!==void 0;){let c=o(t,n.key);s.push(n),y(t,n.key)?n=void 0:c<=0?n=n.left:n=n.right}if(s.length===0)return e;let a=new Array(s.length),i=s[s.length-1];a[a.length-1]=new We(i.color,i.key,i.value,i.left,i.right,i.count);for(let c=s.length-2;c>=0;--c)i=s[c],i.left===s[c+1]?a[c]=new We(i.color,i.key,i.value,a[c+1],i.right,i.count):a[c]=new We(i.color,i.key,i.value,i.left,a[c+1],i.count);if(i=a[a.length-1],i.left!==void 0&&i.right!==void 0){let c=a.length;for(i=i.left;i.right!=null;)a.push(i),i=i.right;let p=a[c-1];a.push(new We(i.color,p.key,p.value,i.left,i.right,i.count)),a[c-1].key=i.key,a[c-1].value=i.value;for(let f=a.length-2;f>=c;--f)i=a[f],a[f]=new We(i.color,i.key,i.value,i.left,a[f+1],i.count);a[c-1].left=a[c]}if(i=a[a.length-1],i.color===A.Red){let c=a[a.length-2];c.left===i?c.left=void 0:c.right===i&&(c.right=void 0),a.pop();for(let p=0;p<a.length;++p)a[p].count--;return is(r,a[0])}else if(i.left!==void 0||i.right!==void 0){i.left!==void 0?ru(i,i.left):i.right!==void 0&&ru(i,i.right),i.color=A.Black;for(let c=0;c<a.length-1;++c)a[c].count--;return is(r,a[0])}else{if(a.length===1)return is(r,void 0);{for(let p=0;p<a.length;++p)a[p].count--;let c=a[a.length-2];XE(a),c.left===i?c.left=void 0:c.right=void 0}}return is(r,a[0])});var XE=e=>{let t,r,o,n;for(let s=e.length-1;s>=0;--s){if(t=e[s],s===0){t.color=A.Black;return}if(r=e[s-1],r.left===t){if(o=r.right,o!==void 0&&o.right!==void 0&&o.right.color===A.Red){if(o=r.right=pt(o),n=o.right=pt(o.right),r.right=o.left,o.left=r,o.right=n,o.color=r.color,t.color=A.Black,r.color=A.Black,n.color=A.Black,J(r),J(o),s>1){let a=e[s-2];a.left===r?a.left=o:a.right=o}e[s-1]=o;return}else if(o!==void 0&&o.left!==void 0&&o.left.color===A.Red){if(o=r.right=pt(o),n=o.left=pt(o.left),r.right=n.left,o.left=n.right,n.left=r,n.right=o,n.color=r.color,r.color=A.Black,o.color=A.Black,t.color=A.Black,J(r),J(o),J(n),s>1){let a=e[s-2];a.left===r?a.left=n:a.right=n}e[s-1]=n;return}if(o!==void 0&&o.color===A.Black)if(r.color===A.Red){r.color=A.Black,r.right=Dt(o,A.Red);return}else{r.right=Dt(o,A.Red);continue}else if(o!==void 0){if(o=pt(o),r.right=o.left,o.left=r,o.color=r.color,r.color=A.Red,J(r),J(o),s>1){let a=e[s-2];a.left===r?a.left=o:a.right=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}else{if(o=r.left,o!==void 0&&o.left!==void 0&&o.left.color===A.Red){if(o=r.left=pt(o),n=o.left=pt(o.left),r.left=o.right,o.right=r,o.left=n,o.color=r.color,t.color=A.Black,r.color=A.Black,n.color=A.Black,J(r),J(o),s>1){let a=e[s-2];a.right===r?a.right=o:a.left=o}e[s-1]=o;return}else if(o!==void 0&&o.right!==void 0&&o.right.color===A.Red){if(o=r.left=pt(o),n=o.right=pt(o.right),r.left=n.right,o.right=n.left,n.right=r,n.left=o,n.color=r.color,r.color=A.Black,o.color=A.Black,t.color=A.Black,J(r),J(o),J(n),s>1){let a=e[s-2];a.right===r?a.right=n:a.left=n}e[s-1]=n;return}if(o!==void 0&&o.color===A.Black)if(r.color===A.Red){r.color=A.Black,r.left=Dt(o,A.Red);return}else{r.left=Dt(o,A.Red);continue}else if(o!==void 0){if(o=pt(o),r.left=o.right,o.right=r,o.color=r.color,r.color=A.Red,J(r),J(o),s>1){let a=e[s-2];a.right===r?a.right=o:a.left=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}}};var vx=nu,wx=Ax,Px=Ix;var Nx=Cx;var su=Symbol.for("effect/SortedSet"),rT={[su]:{_A:e=>e},[O](){return u(d(this.keyTree),_(d(su)))},[E](e){return oT(e)&&y(this.keyTree,e.keyTree)},[Symbol.iterator](){return Px(this.keyTree)},toString(){return q(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(F)}},[M](){return this.toJSON()},pipe(){return x(this,arguments)}},Mx=e=>{let t=Object.create(rT);return t.keyTree=e,t},oT=e=>b(e,su);var Fx=l(2,(e,t)=>vx(e.keyTree,t)?e:Mx(wx(e.keyTree,t,!0)));var Lx=l(2,(e,t)=>Mx(Nx(e.keyTree,t)));var sT="effect/Supervisor",Vo=Symbol.for(sT),cs={_T:e=>e},$o=class e{underlying;value0;[Vo]=cs;constructor(t,r){this.underlying=t,this.value0=r}get value(){return this.value0}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}},Go=class e{left;right;_tag="Zip";[Vo]=cs;constructor(t,r){this.left=t,this.right=r}get value(){return La(this.left.value,this.right.value)}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new e(this,t)}},iu=e=>b(e,Vo)&&As(e,"Zip"),qx=class{[Vo]=cs;fibers=new Set;get value(){return k(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}onRun(t,r){return t()}},au=class{effect;[Vo]=cs;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}onRun(t,r){return t()}},Hx=class{ref;[Vo]=cs;constructor(t){this.ref=t}get value(){return k(()=>Be(this.ref))}onStart(t,r,o,n){u(this.ref,xt(u(Be(this.ref),Fx(n))))}onEnd(t,r){u(this.ref,xt(u(Be(this.ref),Lx(r))))}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $o(this,u(this.value,Z(t)))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};var aT=e=>new au(e),ps=P("effect/Supervisor/none",()=>aT(Ke));var Bx=Fr;var Ux="Empty",Kx="AddSupervisor",jx="RemoveSupervisor",Wx="AndThen",Jo={_tag:Ux},li=(e,t)=>({_tag:Wx,first:e,second:t}),cT=(e,t)=>pT(t,ie(e)),pT=(e,t)=>{let r=e,o=t;for(;nt(o);){let n=st(o);switch(n._tag){case Ux:{o=at(o);break}case Kx:{r=r.zip(n.supervisor),o=at(o);break}case jx:{r=cu(r,n.supervisor),o=at(o);break}case Wx:{o=ge(n.first)(ge(n.second)(at(o)));break}}}return r},cu=(e,t)=>y(e,t)?ps:iu(e)?cu(e.left,t).zip(cu(e.right,t)):e,ui=e=>y(e,ps)?me():iu(e)?u(ui(e.left),Ae(ui(e.right))):dt(e),lT=(e,t)=>{if(y(e,t))return Jo;let r=ui(e),o=ui(t),n=u(o,Bc(r),Nr(Jo,(a,i)=>li(a,{_tag:Kx,supervisor:i}))),s=u(r,Bc(o),Nr(Jo,(a,i)=>li(a,{_tag:jx,supervisor:i})));return li(n,s)},zx=Bx({empty:Jo,patch:cT,combine:li,diff:lT});var yT=as("effect_fiber_started"),$x=as("effect_fiber_active"),ST=as("effect_fiber_successes"),bT=as("effect_fiber_failures"),OT=Ox(bx("effect_fiber_lifetimes",Lg({start:1,factor:1.3,count:100})),"time_unit","milliseconds"),ls="Continue",_T="Done",Gx="Yield",ET={_E:e=>e,_A:e=>e},us=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},fi={[fo]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>Ie(Ie(r)),[mo]:(e,t,r)=>t.i2(r),[cn]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Nt(e._runtimeFlags)&&e.isInterrupted()?V(e.getInterruptedCause()):Ie(r)),[ho]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):Ke)},TT={[ti]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),Nt(t)?V(o.cause):r),[oi]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[ri]:(e,t,r,o)=>(o.onFiber(e,bl(t)),r),[ni]:(e,t,r,o)=>w(Kn(),()=>r)},RT=e=>zr(ph(e),t=>Qr(fh(t),([r,o])=>{let n=new Map;for(let s of o)for(let a of s)n.set(a.request,a);return ar(LT(r.runAll(o),o.flat()),ei,n)},!1,!1)),pu=class{[kl]=Cl;[Cg]=ET;pipe(){return x(this,arguments)}_fiberRefs;_fiberId;_runtimeFlags;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_supervisor;_scheduler;_tracer;currentOpCount=0;isYielding=!1;constructor(t,r,o){if(this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(Qx),this._scheduler=this.getFiberRef(El),Sa(o)){let n=this.getFiberRef(Gn);yT.unsafeUpdate(1,n),$x.unsafeUpdate(1,n)}this._tracer=kr(this.getFiberRef(Uo),Nn)}id(){return this._fiberId}resume(t){this.tell(Jr(t))}get status(){return this.ask((t,r)=>r)}get runtimeFlags(){return this.ask((t,r)=>Rg(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return kg(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Vn)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return te(()=>{let r=fd(this._fiberId);return this.tell(zo((o,n)=>{Ba(r,k(()=>t(o,n)))})),md(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return jr(t=>{let r=o=>t(H(o));return this.tell(zo((o,n)=>{o._exitValue!==null?r(this._exitValue):o.addObserver(r)})),k(()=>this.tell(zo((o,n)=>{o.removeObserver(r)})))},this.id())}get inheritAll(){return it((t,r)=>{let o=t.id(),n=t.getFiberRefs(),s=r.runtimeFlags,a=this.getFiberRefs(),i=ll(n,o,a);t.setFiberRefs(i);let c=t.getFiberRef(Yx),p=u(kn(s,c),ip(qr),ip(xa));return wp(p)})}get poll(){return k(()=>ft(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return k(()=>this.tell(si(Mt(t))))}unsafeInterruptAsFork(t){this.tell(si(Mt(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(r=>r!==t)}getFiberRefs(){return this.setFiberRef(Yx,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=Zn(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Wo(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),this.refreshRefCache()}refreshRefCache(){this._tracer=kr(this.getFiberRef(Uo),Nn),this._supervisor=this.getFiberRef(Qx),this._scheduler=this.getFiberRef(El)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=ls,o=globalThis[ur];globalThis[ur]=this;try{for(;r===ls;)r=this._queue.length===0?_T:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[ur]=o}this._queue.length>0&&!this._running?(this._running=!0,r===Gx?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this._scheduler.scheduleTask(this.run,this.getFiberRef($n))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=TT[n._tag](this,t,o,n)}return o}isInterrupted(){return!bh(this.getFiberRef(Vn))}addInterruptedCause(t){let r=this.getFiberRef(Vn);this.setFiberRef(Vn,Ue(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(si(Mt(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Un({while:()=>!r,body:()=>{let n=t.next();return n.done?k(()=>{r=!0}):sr(n.value.await)},step:()=>{}})}return null}reportExitValue(t){if(Sa(this._runtimeFlags)){let r=this.getFiberRef(Gn);switch($x.unsafeUpdate(-1,r),t._tag){case Fe:{ST.unsafeUpdate(1,r);break}case Me:{bT.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(sd);!wn(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,Sa(this._runtimeFlags)){let r=this.getFiberRef(Gn),o=this.id().startTimeMillis,n=new Date().getTime();OT.unsafeUpdate(n-o,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(vT)}log(t,r,o){let n=$(o)?o.value:this.getFiberRef(Lp),s=this.getFiberRef(AT);if(Zd(s,n))return;let a=this.getFiberRef(td),i=this.getFiberRef(ed),c=this.getLoggers(),p=this.getFiberRefs();if(wr(c)>0){let f=kr(this.getFiberRef(Uo),Qn),m=new Date(f.unsafeCurrentTimeMillis());for(let h of c)h.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:p,spans:a,annotations:i,date:m})}}evaluateMessageWhileSuspended(t){switch(t._tag){case ni:return Gx;case ti:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(V(t.cause)),this._asyncInterruptor=null),ls;case oi:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),ls;case ri:return t.onFiber(this,this._exitValue!==null?Eg:Tg(this._runtimeFlags,this._asyncBlockingOn)),ls;default:return us(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=Nt(this._runtimeFlags)&&this.isInterrupted()?V(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=u(this._runtimeFlags,oh(xa));let s=this.interruptAllChildren();s!==null?r=w(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Jr(n)),r=null)}catch(o){if(Fn(o))o._op===go?rh(this._runtimeFlags)?(this.tell(Ag()),this.tell(Jr(ir)),r=null):r=ir:o._op===uo&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Jr(t));else{this._running=!0;let r=globalThis[ur];globalThis[ur]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[ur]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Jr(t))}patchRuntimeFlags(t,r){let o=Cn(t,r);return globalThis[ur]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Jr(s)))};Nt(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(Je(St(s)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this._runtimeFlags})}popStack(){let t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==an)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==fo&&t._op!==ho)return t;t=this.popStack()}}[cf](t){return Z(zn(Gr),r=>Qf(r,t))}Left(t){return ye(t.left)}None(t){return ye(new pd)}Right(t){return Ie(t.right)}Some(t){return Ie(t.value)}[Ps](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._op in fi||us(o),fi[o._op](this,o,r);throw Ie(r)}[Fe](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._op in fi||us(o),fi[o._op](this,o,r.i0);throw r}[Me](t){let r=t.i0,o=this.getNextFailCont();if(o!==void 0)switch(o._op){case an:case mo:return Nt(this._runtimeFlags)&&this.isInterrupted()?V(mp(r)):o.i1(r);case"OnStep":return Nt(this._runtimeFlags)&&this.isInterrupted()?V(mp(r)):Ie(V(r));case cn:return this.patchRuntimeFlags(this._runtimeFlags,o.patch),Nt(this._runtimeFlags)&&this.isInterrupted()?V(Ue(r,this.getInterruptedCause())):V(r);default:us(o)}else throw V(r)}[Ns](t){return t.i0(this,bl(this._runtimeFlags))}Blocked(t){let r=this.getFiberRefs(),o=this._runtimeFlags;if(this._steps.length>0){let n=[],s=this._steps[this._steps.length-1],a=this.popStack();for(;a&&a._op!=="OnStep";)n.push(a),a=this.popStack();this.setFiberRefs(s.refs),this._runtimeFlags=s.flags;let i=dg(s.refs,r),c=kn(s.flags,o);return Ie(va(t.i0,it(p=>{for(;n.length>0;)p.pushStack(n.pop());return p.setFiberRefs(gg(p.id(),p.getFiberRefs())(i)),p._runtimeFlags=Cn(c)(p._runtimeFlags),t.i1})))}return Fo(n=>w(fu(_p(t.i0)),()=>n(t.i1)))}RunBlocked(t){return RT(t.i0)}[_r](t){let r=t.i0,o=this._runtimeFlags,n=Cn(o,r);if(Nt(n)&&this.isInterrupted())return V(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=kn(n,o);return this.pushStack(new Aa(s,t)),t.i1(o)}else return ir}[fo](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[an](t){return this.pushStack(t),t.i0}[mo](t){return this.pushStack(t),t.i0}[uo](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[go](t){throw this.isYielding=!1,t}[ho](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):ir}[ws](t){return t.commit()}runLoop(t){let r=t;for(this.currentOpCount=0;;){if(this._runtimeFlags&th&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),!this.isYielding){this.currentOpCount+=1;let o=this._scheduler.shouldYield(this);if(o!==!1){this.isYielding=!0,this.currentOpCount=0;let n=r;r=w(Kn({priority:o}),()=>n)}}try{(!("_op"in r)||!(r._op in this))&&us(r),r=this._tracer.context(()=>xr!==r[dl]._V?Tp(`Cannot execute an Effect versioned ${r[dl]._V} with a Runtime of version ${xr}`):this[r._op](r),this)}catch(o){if(Fn(o)){if(o._op===go||o._op===uo)throw o;if(o._op===Fe||o._op===Me)return o;r=V(St(o))}else Bh(o)?r=V(o.cause):cd(o)?r=V(Ue(St(o),Mt(wt))):r=V(St(o))}}}run=()=>{this.drainQueueOnCurrentThread()}},AT=P("effect/FiberRef/currentMinimumLogLevel",()=>Se(Xd("Info"))),IT=e=>{let t=Qd(e,Uo);return kr(t,Ga).unsafe},kT=P(Symbol.for("effect/Logger/defaultLogger"),()=>ci(e=>{let t=Mg.log(e);IT(e.context).log(t)}));var CT=P(Symbol.for("effect/Logger/tracerLogger"),()=>ci(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let a=un(Xn(r,Gr),bo(Ra)),i=ue(Xn(r,Uo),p=>kr(p,Qn));if(a._tag==="None"||a.value._tag==="ExternalSpan"||i._tag==="None")return;let c=Object.fromEntries(ca(e,p=>ii(p)));c["effect.fiberId"]=Nm(o),c["effect.logLevel"]=n.label,t!==null&&t._tag!=="Empty"&&(c["effect.cause"]=Pn(t)),a.value.event(String(s),i.value.unsafeCurrentTimeNanos(),c)}));var vT=P(Symbol.for("effect/FiberRef/currentLoggers"),()=>Fp(dt(kT,CT)));var Zx=l(e=>Zu(e[0]),(e,t,r)=>it(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(nd);return r?.discard?Tl(r.concurrency,()=>Yr(Ja)(s=>n?Qr(e,(a,i)=>s(t(a,i)),!0,!1,1):zr(e,(a,i)=>s(t(a,i)))),()=>Yr(Ya)(s=>Qr(e,(a,i)=>s(t(a,i)),n,!1)),s=>Yr(Qa(s))(a=>Qr(e,(i,c)=>a(t(i,c)),n,!1,s))):Tl(r?.concurrency,()=>Yr(Ja)(s=>n?Vx(e,1,(a,i)=>s(t(a,i)),!0):ct(e,(a,i)=>s(t(a,i)))),()=>Yr(Ya)(s=>wT(e,(a,i)=>s(t(a,i)),n)),s=>Yr(Qa(s))(a=>Vx(e,s,(i,c)=>a(t(i,c)),n)))})),wT=(e,t,r)=>te(()=>{let o=Te(e),n=new Array(o.length);return jn(Qr(o,(a,i)=>w(t(a,i),c=>k(()=>n[i]=c)),r,!1),H(n))}),Qr=(e,t,r,o,n)=>Fo(s=>vp(a=>it(i=>{let c=Array.from(e).reverse(),p=c.length;if(p===0)return Ke;let f=0,m=!1,h=n?Math.min(c.length,n):c.length,g=new Set,S=new Array,I=()=>g.forEach(j=>{j._scheduler.scheduleTask(()=>{j.unsafeInterruptAsFork(i.id())},0)}),T=new Array,v=new Array,N=new Array,L=()=>{let j=S.filter(({exit:re})=>re._tag==="Failure").sort((re,Ce)=>re.index<Ce.index?-1:re.index===Ce.index?0:1).map(({exit:re})=>re);return j.length===0&&j.push(ir),j},W=j=>{let re=Fa(a(j)),Ce=NT(re,i,i._runtimeFlags,Il);return i._scheduler.scheduleTask(()=>{Ce.resume(re)},0),Ce},D=()=>{o||(p-=c.length,c=[]),m=!0,I()},oe=r?kp:qn,ne=W(jr(j=>{let re=(Ee,Et)=>{Ee._op==="Blocked"?N.push(Ee):(S.push({index:Et,exit:Ee}),Ee._op==="Failure"&&!m&&D())},Ce=()=>{if(c.length>0){let Ee=c.pop(),Et=f++,tn=()=>{let Kt=c.pop();return Et=f++,w(Kn(),()=>w(oe(s(t(Kt,Et))),rn))},rn=Kt=>c.length>0&&(re(Kt,Et),c.length>0)?tn():H(Kt),$y=w(oe(s(t(Ee,Et))),rn),gr=W($y);T.push(gr),g.add(gr),m&&gr._scheduler.scheduleTask(()=>{gr.unsafeInterruptAsFork(i.id())},0),gr.addObserver(Kt=>{let Li;if(Kt._op==="Failure"?Li=Kt:Li=Kt.i0,v.push(gr),g.delete(gr),re(Li,Et),S.length===p)j(H(G(qp(L(),{parallel:!0}),()=>ir)));else if(N.length+S.length===p){let Gy=N.map(on=>on.i0).reduce(pp);j(H(va(Gy,Qr([G(qp(L(),{parallel:!0}),()=>ir),...N.map(on=>on.i1)],on=>on,r,!0,n))))}else Ce()})}};for(let Ee=0;Ee<h;Ee++)Ce()}));return sr(Bn(Hn(Ma(s(wg(ne)),()=>(D(),vg(ne)))),()=>ct(v,j=>j.inheritAll)))}))),Vx=(e,t,r,o)=>te(()=>{let n=Te(e),s=new Array(n.length);return jn(Qr(n,(i,c)=>Z(r(i,c),p=>s[c]=p),o,!1,t),H(s))});var fu=e=>MT(e,Il);var PT=(e,t,r,o=null)=>{let n=Xx(e,t,r,o);return n.resume(e),n},NT=(e,t,r,o=null)=>Xx(e,t,r,o),Xx=(e,t,r,o=null)=>{let n=Mm(),s=t.getFiberRefs(),a=ul(s,n),i=new pu(n,a,r),c=jo(a,Gr),p=i._supervisor;return p.onStart(c,e,C(t),i),i.addObserver(m=>p.onEnd(m,i)),(o!==null?o:u(t.getFiberRef(Ca),G(()=>t.scope()))).add(r,i),i},MT=(e,t)=>it((r,o)=>H(PT(e,r,o.runtimeFlags,t)));var lu=e=>Vr(t=>se(bo(t,fs),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return w(Da(r,Ya),o=>mu(e,o))}}})),Jx=e=>t=>Vr(r=>se(bo(r,fs),{onNone:()=>t,onSome:o=>o.strategy._tag==="ParallelN"&&o.strategy.parallelism===e?t:w(Da(o,Qa(e)),n=>mu(t,n))})),Yr=e=>t=>Vr(r=>se(bo(r,fs),{onNone:()=>t(B),onSome:o=>{let n=e._tag==="Parallel"?lu:e._tag==="Sequential"?uu:Jx(e.parallelism);switch(o.strategy._tag){case"Parallel":return n(t(lu));case"Sequential":return n(t(uu));case"ParallelN":return n(t(Jx(o.strategy.parallelism)))}}}));var uu=e=>Vr(t=>se(bo(t,fs),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return w(Da(r,Ja),o=>mu(e,o))}}}));var fs=De(ad);var mu=l(2,(e,t)=>Hp(e,Ac(Yf(fs,t))));var FT=e=>Lo(e,{differ:zx,fork:Jo});var Yx=Zh(nh),Qx=FT(ps);var LT=(e,t)=>Ip(r=>w(w(fu(Pa(e)),o=>jr(n=>{let s=t.map(c=>c.listeners.count),a=()=>{s.every(c=>c===0)&&(i.forEach(c=>c()),n(jh(o)))};o.addObserver(c=>{i.forEach(p=>p()),n(c)});let i=t.map((c,p)=>{let f=m=>{s[p]=m,a()};return c.listeners.addObserver(f),()=>c.listeners.removeObserver(f)});return a(),k(()=>{i.forEach(c=>c())})})),()=>te(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return zr(o,n=>_x(n.request,ld(r)))})));var hu=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return hu(e,t.from)}},Zr=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Yo=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var hs=Symbol.for("@effect/schema/annotation/Type"),gu=Symbol.for("@effect/schema/annotation/Message"),mr=Symbol.for("@effect/schema/annotation/Identifier"),de=Symbol.for("@effect/schema/annotation/Title"),Qe=Symbol.for("@effect/schema/annotation/Description"),ry=Symbol.for("@effect/schema/annotation/Examples"),oy=Symbol.for("@effect/schema/annotation/Default"),di=Symbol.for("@effect/schema/annotation/JSONSchema"),ny=Symbol.for("@effect/schema/annotation/Documentation"),Qo=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?C(t.annotations[e]):R(),sy=Qo(gu),ay=Qo(de),iy=Qo(mr),cy=Qo(Qe);var gi=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var xi=(e,t={})=>({_tag:"Literal",literal:e,annotations:t}),Xr=e=>e._tag==="Literal";var xu=(e,t={})=>({_tag:"UniqueSymbol",symbol:e,annotations:t}),HT=e=>e._tag==="UniqueSymbol",DT={_tag:"UndefinedKeyword",annotations:{[de]:"undefined"}};var BT={_tag:"VoidKeyword",annotations:{[de]:"void"}};var ds={_tag:"NeverKeyword",annotations:{[de]:"never"}};var py={_tag:"UnknownKeyword",annotations:{[de]:"unknown"}},UT=e=>e._tag==="UnknownKeyword",yu={_tag:"AnyKeyword",annotations:{[de]:"any"}},KT=e=>e._tag==="AnyKeyword",ly={_tag:"StringKeyword",annotations:{[de]:"string",[Qe]:"a string"}},eo=e=>e._tag==="StringKeyword",uy={_tag:"NumberKeyword",annotations:{[de]:"number",[Qe]:"a number"}},hi=e=>e._tag==="NumberKeyword",jT={_tag:"BooleanKeyword",annotations:{[de]:"boolean",[Qe]:"a boolean"}},ey=e=>e._tag==="BooleanKeyword",WT={_tag:"BigIntKeyword",annotations:{[de]:"bigint",[Qe]:"a bigint"}},ty=e=>e._tag==="BigIntKeyword",zT={_tag:"SymbolKeyword",annotations:{[de]:"symbol",[Qe]:"a symbol"}},du=e=>e._tag==="SymbolKeyword",$T={_tag:"ObjectKeyword",annotations:{[de]:"object",[Qe]:"an object"}};var yi=(e,t)=>({type:e,isOptional:t}),Si=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var be=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),fy=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return fy(e.from);default:return!1}},my=(e,t,r)=>{if(fy(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},Zo=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let a=e[s].name;if(Object.prototype.hasOwnProperty.call(o,a))throw new Error(`Duplicate property signature ${String(a)}`);o[a]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let a=Ey(t[s].parameter);if(eo(a)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(du(a)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:VT(e),indexSignatures:t,annotations:r}};var GT=e=>e.length>1,hr=(e,t={})=>{let r=ZT(e);return GT(r)?{_tag:"Union",types:QT(r),annotations:t}:Le(r)?r[0]:ds};var bi=(e,t={})=>({_tag:"Lazy",f:Yo(e),annotations:t});var Oi=(e,t,r={})=>dy(e)?Su(e.from,Oi(e.to,t,r),e.transformation,e.annotations):{_tag:"Refinement",from:e,filter:t,annotations:r},hy=e=>e._tag==="Refinement",Su=(e,t,r,o={})=>({_tag:"Transform",from:e,to:t,transformation:r,annotations:o}),dy=e=>e._tag==="Transform";var bu=(e,t)=>({_tag:"FinalPropertySignatureTransformation",decode:e,encode:t});var Ou=(e,t,r)=>({from:e,to:t,propertySignatureTransformation:r}),gy=e=>{let t={};for(let r of e){let o=r.from;if(t[o])throw new Error(`Duplicate property signature transformation ${String(o)}`);t[o]=!0}return{_tag:"TypeLiteralTransformation",propertySignatureTransformations:e}};var xy=(e,t)=>({...e,annotations:{...e.annotations,...t}});var yy=e=>e.map(t=>be(t.name,he(t.type),t.isOptional,t.isReadonly,t.annotations)),Sy=e=>e.map(t=>my(t.parameter,he(t.type),t.isReadonly)),he=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(he),he(e.type),e.decode,e.annotations);case"Tuple":return Si(e.elements.map(t=>yi(he(t.type),t.isOptional)),ue(e.rest,Re(he)),e.isReadonly,e.annotations);case"TypeLiteral":return Zo(yy(e.propertySignatures),Sy(e.indexSignatures),e.annotations);case"Union":return hr(e.types.map(he),e.annotations);case"Lazy":return bi(()=>he(e.f()),e.annotations);case"Refinement":return Oi(he(e.from),e.filter,e.annotations);case"Transform":return he(e.to)}return e},ze=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(ze),ze(e.type),e.decode,e.annotations);case"Tuple":return Si(e.elements.map(t=>yi(ze(t.type),t.isOptional)),ue(e.rest,Re(ze)),e.isReadonly);case"TypeLiteral":return Zo(e.propertySignatures.map(t=>be(t.name,ze(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>my(t.parameter,ze(t.type),t.isReadonly)));case"Union":return hr(e.types.map(ze));case"Lazy":return bi(()=>ze(e.f()));case"Refinement":case"Transform":return ze(e.from)}return e},by=e=>{switch(e._tag){case"Declaration":return by(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},VT=Tr(u(je,ln(e=>by(e.type)))),Oy=Of(je,je,je),JT=oc(Oy),_y=[0,0,0],YT=e=>e.reduce(JT,_y),ms=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=$(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=ms(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return YT(e.types.map(ms));case"Refinement":{let[t,r,o]=ms(e.from);return[t+1,r,o]}case"Transform":return ms(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return _y}},QT=Tr(bf(ln(Oy,ms))),ZT=e=>{let t=u(e,fn(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some(KT))return[yu];if(t.some(UT))return[py];let r;return(r=t.findIndex(eo))!==-1&&(t=t.filter((o,n)=>n===r||!eo(o)&&!(Xr(o)&&typeof o.literal=="string"))),(r=t.findIndex(hi))!==-1&&(t=t.filter((o,n)=>n===r||!hi(o)&&!(Xr(o)&&typeof o.literal=="number"))),(r=t.findIndex(ey))!==-1&&(t=t.filter((o,n)=>n===r||!ey(o)&&!(Xr(o)&&typeof o.literal=="boolean"))),(r=t.findIndex(ty))!==-1&&(t=t.filter((o,n)=>n===r||!ty(o)&&!(Xr(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(du))!==-1&&(t=t.filter((o,n)=>n===r||!du(o)&&!HT(o))),t},Ey=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Ey(e.from)}};var _u=Symbol.for("@effect/schema/TypeId/GreaterThan"),Ei=Symbol.for("@effect/schema/TypeId/GreaterThanOrEqualTo"),Eu=Symbol.for("@effect/schema/TypeId/LessThan"),Tu=Symbol.for("@effect/schema/TypeId/LessThanOrEqualTo"),Ru=Symbol.for("@effect/schema/TypeId/Int"),Au=Symbol.for("@effect/schema/TypeId/Between"),Iu=Symbol.for("@effect/schema/TypeId/GreaterThanBigint"),ku=Symbol.for("@effect/schema/TypeId/GreaterThanOrEqualToBigint"),Cu=Symbol.for("@effect/schema/TypeId/LessThanBigint"),vu=Symbol.for("@effect/schema/TypeId/LessThanOrEqualToBigint"),wu=Symbol.for("@effect/schema/TypeId/BetweenBigint"),Pu=Symbol.for("@effect/schema/TypeId/MinLength"),Nu=Symbol.for("@effect/schema/TypeId/MaxLength"),Mu=Symbol.for("@effect/schema/TypeId/Length"),Fu=Symbol.for("@effect/schema/TypeId/MinItems"),Lu=Symbol.for("@effect/schema/TypeId/MaxItems"),qu=Symbol.for("@effect/schema/TypeId/ItemsCount");var bt=Symbol.for("@effect/schema/ArbitraryHookId"),to=Symbol.for("@effect/schema/PrettyHookId"),ro=Symbol.for("@effect/schema/EquivalenceHookId");var Ti=Zx;var gs=te;var $e=Ke;var Ay=Z;var oo=Wr;var Ze=w;var Ot=(e,t=[])=>({value:e,forest:t}),Cy=e=>XT(Ot("error(s) found",e.map(Ri))),XT=e=>e.value+vy(`
`,e.forest),vy=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let a=s===o-1;r+=e+(a?"\u2514":"\u251C")+"\u2500 "+n.value,r+=vy(e+(o>1&&!a?"\u2502  ":"   "),n.forest)}return r},ys=e=>{if(yr(e))return JSON.stringify(e);if(Y(e)||e==null||Rs(e)||ao(e)||Is(e))return String(e);if(et(e))return String(e)+"n";if(!Array.isArray(e)&&b(e,"toString")&&Tt(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();try{return JSON.stringify(e)}catch{return String(e)}},eR=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},tR=e=>e.head+e.spans.map(t=>eR(t)+t.literal).join(""),lt=e=>iy(e).pipe(xo(()=>ay(e)),xo(()=>cy(e))),xs=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return G(lt(e),()=>e._tag);case"Literal":return G(lt(e),()=>ys(e.literal));case"UniqueSymbol":return G(lt(e),()=>ys(e.symbol));case"Union":return[...new Set(e.types.map(xs))].join(" or ");case"TemplateLiteral":return G(lt(e),()=>tR(e));case"Tuple":return G(lt(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return G(lt(e),()=>"<anonymous type literal schema>");case"Enums":return G(lt(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return G(lt(e),()=>"<anonymous lazy schema>");case"Declaration":return G(lt(e),()=>"<anonymous declaration schema>");case"Refinement":return G(lt(e),()=>"<anonymous refinement schema>");case"Transform":return G(lt(e),()=>`${xs(e.from)} <-> ${xs(e.to)}`)}},ky=(e,t)=>e.length===1&&e[0].forest.length!==0&&t[0]._tag!=="UnionMember",rR=e=>sy(e.expected).pipe(ue(t=>t(e.actual)),xo(()=>e.message),G(()=>`Expected ${xs(e.expected)}, actual ${ys(e.actual)}`)),Ri=e=>{switch(e._tag){case"Type":return Ot(rR(e));case"Forbidden":return Ot("is forbidden");case"Index":{let t=e.errors.map(Ri);return ky(t,e.errors)?Ot(`[${e.index}]${t[0].value}`,t[0].forest):Ot(`[${e.index}]`,t)}case"Unexpected":return Ot("is unexpected"+($(e.ast)?`, expected ${xs(e.ast.value)}`:""));case"Key":{let t=e.errors.map(Ri);return ky(t,e.errors)?Ot(`[${ys(e.key)}]${t[0].value}`,t[0].forest):Ot(`[${ys(e.key)}]`,t)}case"Missing":return Ot("is missing");case"UnionMember":return Ot("union member",e.errors.map(Ri))}};var Hu=class{errors;_tag="ParseError";constructor(t){this.errors=t}toString(){return Cy(this.errors)}toJSON(){return{_id:"ParseError",message:this.toString()}}[M](){return this.toJSON()}},Ai=e=>new Hu(e),we=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:ft(r)}),wy={_tag:"Forbidden"},Bt=(e,t)=>({_tag:"Index",index:e,errors:t}),Ut=(e,t)=>({_tag:"Key",key:e,errors:t}),Ii={_tag:"Missing"},Du=e=>({_tag:"Unexpected",ast:e}),Bu=e=>({_tag:"UnionMember",errors:e}),ke=ae;var U=e=>{let t=e;return"_tag"in t?t._tag==="ParseError"?ce(t):ce(Ai([t])):ce(Ai(t))},_t=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},Ss=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):Ze(e,t)},ki=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?ae(t(r.right)):Ay(e,t)};var Ny=(e,t)=>{let r=_e(e,t);return(o,n)=>r(o,{...n,isEffectAllowed:!0})};var Os=e=>Ny(e.ast,!0);var Uu=e=>Ny(e.ast,!1),bs={},nR=P(Symbol.for("@effect/schema/Parser/decodeMemoMap"),()=>new WeakMap),sR=P(Symbol.for("@effect/schema/Parser/encodeMemoMap"),()=>new WeakMap),_e=(e,t)=>{let r=t?nR:sR,o=r.get(e);if(o)return o;let n=aR(e,t);return r.set(e,n),n},aR=(e,t)=>{switch(e._tag){case"Refinement":if(t){let r=_e(e.from,!0);return(o,n)=>Ci(Ss(r(o,n),s=>se(e.filter(s,n??bs,e),{onNone:()=>ke(s),onSome:U})),n)}else{let r=_e(he(e),!0),o=_e(My(e.from),!1);return(n,s)=>Ci(Ss(r(n,s),a=>o(a,s)),s)}case"Transform":{let r=lR(e.transformation,t),o=t?_e(e.from,!0):_e(e.to,!1),n=t?_e(e.to,!0):_e(e.from,!1);return(s,a)=>Ci(Ss(o(s,a),i=>Ss(r(i,a??bs,e),c=>n(c,a))),a)}case"Declaration":{let r=e.decode(t,...e.typeParameters);return(o,n)=>Ci(r(o,n??bs,e),n)}case"Literal":return Pe(e,r=>r===e.literal);case"UniqueSymbol":return Pe(e,r=>r===e.symbol);case"UndefinedKeyword":return Pe(e,Ui);case"VoidKeyword":return Pe(e,Ui);case"NeverKeyword":return Pe(e,Vu);case"UnknownKeyword":case"AnyKeyword":return ke;case"StringKeyword":return Pe(e,yr);case"NumberKeyword":return Pe(e,Y);case"BooleanKeyword":return Pe(e,Rs);case"BigIntKeyword":return Pe(e,et);case"SymbolKeyword":return Pe(e,ao);case"ObjectKeyword":return Pe(e,io);case"Enums":return Pe(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=cR(e);return Pe(e,o=>yr(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>_e(s.type,t)),o=ue(e.rest,Re(s=>_e(s,t))),n=e.elements.filter(s=>!s.isOptional).length;return $(e.rest)&&(n+=e.rest.value.length-1),(s,a)=>{if(!Array.isArray(s))return U(we(e,s));let i=a?.errors==="all",c=[],p=0,f=s.length;for(let I=f;I<=n-1;I++){let T=Bt(I,[Ii]);if(i){c.push([p++,T]);continue}else return U(T)}if(z(e.rest))for(let I=e.elements.length;I<=f-1;I++){let T=Bt(I,[Du(R())]);if(i){c.push([p++,T]);continue}else return U(Xe(Oe(c),T))}let m=[],h=0,g;for(;h<r.length;h++)if(f<h+1){if(e.elements[h].isOptional)continue}else{let I=r[h],T=I(s[h],a),v=_t(T);if(v){if(pe(v)){let N=Bt(h,v.left.errors);if(i){c.push([p++,N]);continue}else return U(Xe(Oe(c),N))}m.push([p++,v.right])}else{let N=p++,L=h;g||(g=[]),g.push(({es:W,output:D})=>Ze(oo(T),oe=>{if(pe(oe)){let ne=Bt(L,oe.left.errors);return i?(W.push([N,ne]),$e):U(Xe(Oe(W),ne))}return D.push([N,oe.right]),$e}))}}if($(o)){let[I,...T]=o.value;for(;h<f-T.length;h++){let v=I(s[h],a),N=_t(v);if(N)if(pe(N)){let L=Bt(h,N.left.errors);if(i){c.push([p++,L]);continue}else return U(Xe(Oe(c),L))}else m.push([p++,N.right]);else{let L=p++,W=h;g||(g=[]),g.push(({es:D,output:oe})=>Ze(oo(v),ne=>{if(pe(ne)){let j=Bt(W,ne.left.errors);return i?(D.push([L,j]),$e):U(Xe(Oe(D),j))}else return oe.push([L,ne.right]),$e}))}}for(let v=0;v<T.length;v++)if(h+=v,!(f<h+1)){let N=T[v](s[h],a),L=_t(N);if(L){if(pe(L)){let W=Bt(h,L.left.errors);if(i){c.push([p++,W]);continue}else return U(Xe(Oe(c),W))}m.push([p++,L.right])}else{let W=p++,D=h;g||(g=[]),g.push(({es:oe,output:ne})=>Ze(oo(N),j=>{if(pe(j)){let re=Bt(D,j.left.errors);return i?(oe.push([W,re]),$e):U(Xe(Oe(oe),re))}return ne.push([W,j.right]),$e}))}}}let S=({es:I,output:T})=>Hs(I)?U(Oe(I)):ke(Oe(T));if(g&&g.length>0){let I=g;return gs(()=>{let T={es:Array.from(c),output:Array.from(m)};return Ze(Ti(I,v=>v(T),{concurrency:"unbounded",discard:!0}),()=>S(T))})}return S({output:m,es:c})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Pe(e,Yu);let r=[],o={};for(let i of e.propertySignatures)r.push(_e(i.type,t)),o[i.name]=null;let n=e.indexSignatures.map(i=>[_e(i.parameter,t),_e(i.type,t)]),s=hr(e.indexSignatures.map(i=>i.parameter).concat(Zr(o).map(i=>ao(i)?xu(i):xi(i)))),a=_e(s,t);return(i,c)=>{if(!Ki(i))return U(we(e,i));let p=c?.errors==="all",f=[],m=0;if(c?.onExcessProperty==="error")for(let T of Zr(i)){let v=_t(a(T,c));if(v&&pe(v)){let N=Ut(T,[Du(C(s))]);if(p){f.push([m++,N]);continue}else return U(Xe(Oe(f),N))}}let g={},S;for(let T=0;T<r.length;T++){let v=e.propertySignatures[T],N=r[T],L=v.name;if(Object.prototype.hasOwnProperty.call(i,L)){let W=N(i[L],c),D=_t(W);if(D){if(pe(D)){let oe=Ut(L,D.left.errors);if(p){f.push([m++,oe]);continue}else return U(Xe(Oe(f),oe))}g[L]=D.right}else{let oe=m++,ne=L;S||(S=[]),S.push(({es:j,output:re})=>Ze(oo(W),Ce=>{if(pe(Ce)){let Ee=Ut(ne,Ce.left.errors);return p?(j.push([oe,Ee]),$e):U(Xe(Oe(j),Ee))}return re[ne]=Ce.right,$e}))}}else if(!v.isOptional){let W=Ut(L,[Ii]);if(p){f.push([m++,W]);continue}else return U(W)}}for(let T=0;T<n.length;T++){let v=n[T],N=v[0],L=v[1],W=hu(i,e.indexSignatures[T].parameter);for(let D of W){let oe=_t(N(D,c));if(oe&&tt(oe)){let ne=L(i[D],c),j=_t(ne);if(j)if(pe(j)){let re=Ut(D,j.left.errors);if(p){f.push([m++,re]);continue}else return U(Xe(Oe(f),re))}else Object.prototype.hasOwnProperty.call(o,D)||(g[D]=j.right);else{let re=m++,Ce=D;S||(S=[]),S.push(({es:Ee,output:Et})=>Ze(oo(ne),tn=>{if(pe(tn)){let rn=Ut(Ce,tn.left.errors);return p?(Ee.push([re,rn]),$e):U(Xe(Oe(Ee),rn))}else return Object.prototype.hasOwnProperty.call(o,D)||(Et[D]=tn.right),$e}))}}}}let I=({es:T,output:v})=>Hs(T)?U(Oe(T)):ke(v);if(S&&S.length>0){let T=S;return gs(()=>{let v={es:Array.from(f),output:Object.assign({},g)};return Ze(Ti(T,N=>N(v),{concurrency:"unbounded",discard:!0}),()=>I(v))})}return I({es:f,output:g})}}case"Union":{let r=iR(e.types,t),o=Zr(r.keys),n=o.length,s=new Map;for(let a=0;a<e.types.length;a++)s.set(e.types[a],_e(e.types[a],t));return(a,i)=>{let c=[],p=0,f=[];if(n>0)if(Ki(a))for(let g=0;g<n;g++){let S=o[g],I=r.keys[S].buckets;if(Object.prototype.hasOwnProperty.call(a,S)){let T=String(a[S]);Object.prototype.hasOwnProperty.call(I,T)?f=f.concat(I[T]):c.push([p++,Ut(S,[we(r.keys[S].ast,a[S])])])}else c.push([p++,Ut(S,[Ii])])}else c.push([p++,we(e,a)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let m;for(let g=0;g<f.length;g++){let S=s.get(f[g])(a,i),I=!m||m.length===0?_t(S):void 0;if(I){if(tt(I))return ke(I.right);c.push([p++,Bu(I.left.errors)])}else{let T=p++;m||(m=[]),m.push(v=>gs(()=>"finalResult"in v?$e:Ze(oo(S),N=>(tt(N)?v.finalResult=ke(N.right):v.es.push([T,Bu(N.left.errors)]),$e))))}}let h=g=>Hs(g)?U(Oe(g)):U(we(ds,a));if(m&&m.length>0){let g=m;return gs(()=>{let S={es:Array.from(c)};return Ze(Ti(g,I=>I(S),{concurrency:1,discard:!0}),()=>"finalResult"in S?S.finalResult:h(S.es))})}return h(c)}}case"Lazy":{let r=Yo(()=>_e(e.f(),t));return(o,n)=>r()(o,n)}}},Pe=(e,t)=>r=>t(r)?ke(r):U(we(e,r)),vi=(e,t)=>{switch(e._tag){case"Declaration":return vi(e.type,t);case"TypeLiteral":{let r=[];for(let o=0;o<e.propertySignatures.length;o++){let n=e.propertySignatures[o],s=t?ze(n.type):he(n.type);Xr(s)&&!n.isOptional&&r.push([n.name,s])}return r}case"Refinement":return vi(e.from,t);case"Transform":return vi(t?e.from:e.to,t)}return[]},iR=(e,t)=>{let r={},o=[];for(let n=0;n<e.length;n++){let s=e[n],a=vi(s,t);if(a.length>0)for(let i=0;i<a.length;i++){let[c,p]=a[i],f=String(p.literal);r[c]=r[c]||{buckets:{},ast:ds};let m=r[c].buckets;if(Object.prototype.hasOwnProperty.call(m,f)){if(i<a.length-1)continue;m[f].push(s),r[c].ast=hr([r[c].ast,p])}else{m[f]=[s],r[c].ast=hr([r[c].ast,p]);break}}else o.push(s)}return{keys:r,otherwise:o}},My=e=>hy(e)?My(e.from):e,Ci=(e,t)=>{let r=_t(e);return r||(t?.isEffectAllowed===!0?e:U(wy))},Xe=(e,t)=>(e.push(t),e),cR=e=>{let t=`^${e.head}`;for(let r of e.spans)eo(r.type)?t+=".*":hi(r.type)&&(t+="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function Oe(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var pR=(e,t)=>{switch(e._tag){case"FinalPropertySignatureTransformation":return t?e.decode:e.encode}},lR=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return ke;case"TypeLiteralTransformation":return r=>{let o=ae(r);for(let n of e.propertySignatureTransformations){let[s,a]=t?[n.from,n.to]:[n.to,n.from],i=pR(n.propertySignatureTransformation,t);o=ki(o,p=>{let f=i(Object.prototype.hasOwnProperty.call(p,s)?C(p[s]):R());return delete p[s],$(f)&&(p[a]=f.value),p})}return o}}};var uR=bt,Ly=e=>ut(e.ast,{});var ju=1,fR=(e,t,r,o)=>(o.isLazy?e.oneof({depthSize:ju},e.constant([]),e.array(e.tuple(t,r),{minLength:1,maxLength:2})):e.array(e.tuple(t,r))).map(n=>{let s={};for(let[a,i]of n)s[a]=i;return s}),Ku=Qo(uR),ut=(e,t)=>{switch(e._tag){case"Declaration":return u(Ku(e),se({onNone:()=>ut(e.type,t),onSome:r=>r(...e.typeParameters.map(o=>ut(o,t)))}));case"Literal":return r=>r.constant(e.literal);case"UniqueSymbol":return r=>r.constant(e.symbol);case"UndefinedKeyword":return r=>r.constant(void 0);case"VoidKeyword":return r=>r.constant(void 0);case"NeverKeyword":return()=>{throw new Error("cannot build an Arbitrary for `never`")};case"UnknownKeyword":case"AnyKeyword":return r=>r.anything();case"StringKeyword":return r=>{if(t.constraints)switch(t.constraints._tag){case"StringConstraints":return r.string(t.constraints.constraints)}return r.string()};case"NumberKeyword":return r=>{if(t.constraints)switch(t.constraints._tag){case"NumberConstraints":return r.float(t.constraints.constraints);case"IntegerConstraints":return r.integer(t.constraints.constraints)}return r.float()};case"BooleanKeyword":return r=>r.boolean();case"BigIntKeyword":return r=>{if(t.constraints)switch(t.constraints._tag){case"BigIntConstraints":return r.bigInt(t.constraints.constraints)}return r.bigInt()};case"SymbolKeyword":return r=>r.string().map(o=>Symbol.for(o));case"ObjectKeyword":return r=>r.oneof(r.object(),r.array(r.anything()));case"TemplateLiteral":return r=>{let o=r.string({maxLength:5}),n=r.float({noDefaultInfinity:!0}).filter(a=>!Number.isNaN(a)),s=[r.constant(e.head)];for(let a of e.spans)eo(a.type)?s.push(o):s.push(n),s.push(r.constant(a.literal));return r.tuple(...s).map(a=>a.join(""))};case"Tuple":{let r=[],o=!1;for(let s of e.elements)r.push(ut(s.type,t)),s.isOptional&&(o=!0);let n=ue(e.rest,Re(s=>ut(s,t)));return s=>{let a=s.tuple(...r.map(i=>i(s)));if(o){let i=s.tuple(...e.elements.map(c=>c.isOptional?s.boolean():s.constant(!0)));a=a.chain(c=>i.map(p=>{for(let[f,m]of p.reverse().entries())m||c.splice(p.length-f,1);return c}))}if($(n)){let[i,...c]=n.value,p=i(s),f=t.constraints;a=a.chain(m=>{let h=s.array(p);return t.isLazy?h=s.oneof({depthSize:ju},s.constant([]),s.array(p,{minLength:1,maxLength:2})):f&&f._tag==="ArrayConstraints"&&(h=s.array(p,f.constraints)),h.map(g=>[...m,...g])});for(let m=0;m<c.length;m++)a=a.chain(h=>c[m](s).map(g=>[...h,g]))}return a}}case"TypeLiteral":{let r=e.propertySignatures.map(n=>ut(n.type,t)),o=e.indexSignatures.map(n=>[ut(n.parameter,t),ut(n.type,t)]);return n=>{let s={},a=[];for(let c=0;c<r.length;c++){let p=e.propertySignatures[c],f=p.name;p.isOptional||a.push(f),s[f]=r[c](n)}let i=n.record(s,{requiredKeys:a});for(let c=0;c<o.length;c++){let p=o[c][0](n),f=o[c][1](n);i=i.chain(m=>fR(n,p,f,t).map(h=>({...h,...m})))}return i}}case"Union":{let r=e.types.map(o=>ut(o,t));return o=>o.oneof({depthSize:ju},...r.map(n=>n(o)))}case"Enums":{if(e.enums.length===0)throw new Error("cannot build an Arbitrary for an empty enum");return r=>r.oneof(...e.enums.map(([o,n])=>r.constant(n)))}case"Refinement":{let r=hR(t.constraints,mR(e)),o=ut(e.from,r?{...t,constraints:r}:t);return u(Ku(e),se({onNone:()=>n=>o(n).filter(s=>z(e.filter(s,bs,e))),onSome:n=>n(o)}))}case"Lazy":return u(Ku(e),se({onNone:()=>{let r=Yo(()=>ut(e.f(),{...t,isLazy:!0}));return o=>o.constant(null).chain(()=>r()(o))},onSome:r=>r()}));case"Transform":throw new Error("cannot build an Arbitrary for transformations")}},wi=e=>(Y(e.min)&&(e.min=Math.fround(e.min)),Y(e.max)&&(e.max=Math.fround(e.max)),{_tag:"NumberConstraints",constraints:e}),Pi=e=>({_tag:"StringConstraints",constraints:e}),Wu=e=>({_tag:"IntegerConstraints",constraints:e}),Ni=e=>({_tag:"ArrayConstraints",constraints:e}),Mi=e=>({_tag:"BigIntConstraints",constraints:e}),mR=e=>{let t=e.annotations[hs],r=e.annotations[di];switch(t){case _u:case Ei:return wi({min:r.exclusiveMinimum??r.minimum});case Eu:case Tu:return wi({max:r.exclusiveMaximum??r.maximum});case Ru:return Wu({});case Au:{let o=r.minimum,n=r.maximum,s={};return Y(o)&&(s.min=o),Y(n)&&(s.max=n),wi(s)}case Iu:case ku:{let o=e.annotations[t];return Mi({min:o.min})}case Cu:case vu:{let o=e.annotations[t];return Mi({max:o.max})}case wu:{let o=e.annotations[t],n=o.min,s=o.max,a={};return et(n)&&(a.min=n),et(s)&&(a.max=s),Mi(a)}case Pu:return Pi({minLength:r.minLength});case Nu:return Pi({maxLength:r.maxLength});case Mu:return Pi({minLength:r.minLength,maxLength:r.maxLength});case Fu:return Ni({minLength:r.minItems});case Lu:return Ni({maxLength:r.maxItems});case qu:return Ni({minLength:r.minItems,maxLength:r.maxItems})}},hR=(e,t)=>{if(e===void 0)return t;if(t===void 0)return e;switch(e._tag){case"ArrayConstraints":{switch(t._tag){case"ArrayConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.minLength,t.constraints.minLength);Y(o)&&(r.minLength=o);let n=en(e.constraints.maxLength,t.constraints.maxLength);return Y(n)&&(r.maxLength=n),Ni(r)}}break}case"NumberConstraints":{switch(t._tag){case"NumberConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.min,t.constraints.min);Y(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return Y(n)&&(r.max=n),wi(r)}case"IntegerConstraints":{let r={...t.constraints},o=Xo(e.constraints.min,t.constraints.min);Y(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return Y(n)&&(r.max=n),Wu(r)}}break}case"BigIntConstraints":{switch(t._tag){case"BigIntConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.min,t.constraints.min);et(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return et(n)&&(r.max=n),Mi(r)}}break}case"StringConstraints":{switch(t._tag){case"StringConstraints":{let r={...e.constraints,...t.constraints},o=Xo(e.constraints.minLength,t.constraints.minLength);Y(o)&&(r.minLength=o);let n=en(e.constraints.maxLength,t.constraints.maxLength);return Y(n)&&(r.maxLength=n),Pi(r)}}break}case"IntegerConstraints":{switch(t._tag){case"NumberConstraints":case"IntegerConstraints":{let r={...e.constraints},o=Xo(e.constraints.min,t.constraints.min);Y(o)&&(r.min=o);let n=en(e.constraints.max,t.constraints.max);return Y(n)&&(r.max=n),Wu(r)}}break}}};function Xo(e,t){return e===void 0?t:t===void 0?e:e<=t?t:e}function en(e,t){return e===void 0?t:t===void 0||e<=t?e:t}var zu=Symbol.for("@effect/schema/Schema");var gR={From:e=>e,To:e=>e},qy=class{ast;[zu]=gR;constructor(t){this.ast=t}pipe(){return x(this,arguments)}};var Uy=zu;var Ky={From:e=>e,To:e=>e},$u=class{ast;[Uy]=Ky;constructor(t){this.ast=t}pipe(){return x(this,arguments)}},Ne=e=>new $u(e),_R=e=>Ne(xi(e)),Hy=(...e)=>Wy(...e.map(t=>_R(t)));var _s=(e,t,r,o)=>Ne(gi(e.map(n=>n.ast),t.ast,(n,...s)=>r(n,...s.map(Ne)),o));var ER=Ne(yu),jy=Ne(ly),Gu=Ne(uy);var Wy=(...e)=>Ne(hr(e.map(t=>t.ast)));var TR=(...e)=>Ne(Si(e.map(t=>yi(t.ast,!1)),R(),!0));var Dy=class e{config;[Uy]=Ky;FromIsOptional;ToIsOptional;constructor(t){this.config=t}withDefault(t){return new e({_tag:"Default",ast:this.config.ast,value:t,annotations:this.config.annotations})}toOption(){return new e({_tag:"Option",ast:this.config.ast,annotations:this.config.annotations})}};var dr=e=>{let t=Zr(e),r=[],o=[],n=[],s=[];for(let a=0;a<t.length;a++){let i=t[a],c=e[i];if("config"in c){let p=c.config,f=p.ast,m=he(f),h=p.annotations;switch(p._tag){case"PropertySignature":r.push(be(i,f,!1,!0,h)),o.push(be(i,f,!1,!0)),n.push(be(i,m,!1,!0,h));break;case"Optional":r.push(be(i,f,!0,!0,h)),o.push(be(i,f,!0,!0)),n.push(be(i,m,!0,!0,h));break;case"Default":o.push(be(i,f,!0,!0)),n.push(be(i,m,!1,!0,h)),s.push(Ou(i,i,bu(xo(()=>C(p.value())),B)));break;case"Option":o.push(be(i,f,!0,!0)),n.push(be(i,LR(Ne(m)).ast,!1,!0,h)),s.push(Ou(i,i,bu(C,Ef)));break}}else r.push(be(i,c.ast,!1,!0)),o.push(be(i,c.ast,!1,!0)),n.push(be(i,he(c.ast),!1,!0))}return Le(s)?Ne(Su(Zo(o,[]),Zo(n,[]),gy(s))):Ne(Zo(r,[]))};var RR=(e,t)=>Ne(bi(()=>e().ast,t));function AR(e,t){return r=>Ne(Oi(r.ast,(o,n,s)=>e(o)?R():C(Ai([we(s,o)])),IR(t)))}var IR=e=>{if(!e)return{};let t={},r=Object.getOwnPropertySymbols(e);for(let n of r)t[n]=e[n];if(e.typeId!==void 0){let n=e.typeId;typeof n=="object"?(t[hs]=n.id,t[n.id]=n.params):t[hs]=n}let o=(n,s)=>{e[n]!==void 0&&(t[s]=e[n])};return o("message",gu),o("identifier",mr),o("title",de),o("description",Qe),o("examples",ry),o("default",oy),o("documentation",ny),o("jsonSchema",di),o("arbitrary",bt),o("pretty",to),o("equivalence",ro),t},Fi=e=>t=>Ne(xy(t.ast,e));var kR=Ei,CR=(e,t)=>r=>r.pipe(AR(o=>o>=e,{typeId:kR,description:e===0?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t}));var vR=e=>CR(0,e);var By=Gu.pipe(vR());var v0=_s([],dr({}),()=>(e,t,r)=>Ka(e)?ke(e):U(we(r,e)),{[mr]:"Duration",[to]:()=>Sd({onMillis:e=>`Duration.millis(${e})`,onNanos:e=>`Duration.nanos(${e})`}),[bt]:()=>e=>e.oneof(e.bigUint().map(t=>Yn(t)),e.bigUint().map(t=>Up(t)),e.maxSafeNat().map(t=>qo(t)),e.maxSafeNat().map(t=>Kp(t)),e.maxSafeNat().map(t=>jp(t)),e.maxSafeNat().map(t=>Wp(t)),e.maxSafeNat().map(t=>zp(t)),e.maxSafeNat().map(t=>$p(t))),[ro]:()=>Gp});var w0=TR(By.pipe(Fi({[de]:"seconds",[Qe]:"seconds"})),By.pipe(Fi({[de]:"nanos",[Qe]:"nanos"}))).pipe(Fi({[de]:"a high resolution time tuple",[Qe]:"a high resolution time tuple"}));var P0=_s([],dr({}),()=>(e,t,r)=>Qu(e)?ke(e):U(we(r,e)),{[mr]:"Uint8Array",[to]:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,[bt]:()=>e=>e.uint8Array(),[ro]:()=>Us(zi())});var wR=()=>e=>e.date({noInvalidDate:!1}),PR=()=>e=>`new Date(${JSON.stringify(e)})`,N0=_s([],dr({}),()=>(e,t,r)=>Is(e)?ke(e):U(we(r,e)),{[mr]:"Date",[to]:PR,[bt]:wR,[ro]:()=>sf});var zy=e=>Wy(dr({_tag:Hy("None")}),dr({_tag:Hy("Some"),value:e})),NR=e=>e._tag==="None"?R():C(e.value),MR=e=>{let t=RR(()=>ER).pipe(Fi({[bt]:()=>e})),r=Ly(zy(t));return o=>r(o).map(NR)},FR=e=>se({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),LR=e=>_s([e],zy(e),(t,r)=>{let o=t?Os(r):Uu(r);return(n,s,a)=>_f(n)?z(n)?ke(R()):ki(o(n.value,s),C):U(we(a,n))},{[mr]:"Option",[to]:FR,[bt]:MR,[ro]:Tf});var qR=()=>e=>`BigDecimal(${lc(cc(e))})`,HR=()=>e=>e.tuple(e.bigInt(),e.integer()).map(([t,r])=>yo(t,r)),M0=_s([],dr({}),()=>(e,t,r)=>ac(e)?ke(e):U(we(r,e)),{[mr]:"BigDecimal",[to]:qR,[bt]:HR,[ro]:()=>pc});var DR=dr({name:jy,age:Gu}),BR=Os(DR),UR={name:"Alice",age:30},KR=BR(UR);console.log(KR);
